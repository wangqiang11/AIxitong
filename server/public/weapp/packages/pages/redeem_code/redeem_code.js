"use strict";const e=require("../../../common/vendor.js"),u=require("../../../hooks/useCopy.js"),s=require("../../../stores/app.js"),r=require("../../../hooks/useLockFn.js"),o=require("../../../api/user.js");if(require("../../../api/app.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-input")+e.resolveComponent("u-empty")+e.resolveComponent("u-popup")+e.resolveComponent("tabbar"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js")+(()=>"../../../components/tabbar/tabbar.js"))();const t=e.defineComponent({__name:"redeem_code",setup(t){const n=s.useAppStore(),i=e.ref(""),a=e.ref(!1),l=e.ref({content:"",failure_time:"",id:"",sn:"",type:"",type_desc:"",valid_time:""}),p=e.computed((()=>n.getCardCodeConfig)),{isLock:c,lockFn:m}=r.useLockFn((async()=>{try{const e=await o.checkRedeemCode({sn:i.value});a.value=!0,l.value=e}catch(e){i.value="",console.log("查询卡密失败=>",e)}})),{isLock:d,lockFn:v}=r.useLockFn((async()=>{try{await o.useRedeemCode({sn:i.value}),a.value=!1,e.index.$u.toast("兑换成功"),i.value=""}catch(u){console.log("兑换卡密失败=>",u)}}));return(s,r)=>e.e({a:s.$theme.navColor,b:s.$theme.navBgColor,c:s.$theme.pageStyle,d:e.unref(p).is_open},e.unref(p).is_open?e.e({e:e.unref(p).is_show},e.unref(p).is_show?{f:e.t(e.unref(p).buy_site),g:e.o((s=>(e=>{const{copy:s}=u.useCopy();s(e)})(e.unref(p).buy_site)))}:{},{h:e.o((e=>i.value=e)),i:e.p({placeholder:"请输入卡密编号",modelValue:i.value}),j:e.unref(c),k:e.o(((...u)=>e.unref(m)&&e.unref(m)(...u)))}):{l:e.p({text:"功能未开启"})},{m:e.t(l.value.type_desc),n:e.t(l.value.content),o:e.t(l.value.failure_time),p:l.value.valid_time},l.value.valid_time?{q:e.t(l.value.valid_time)}:{},{r:e.unref(d),s:e.o(((...u)=>e.unref(v)&&e.unref(v)(...u))),t:e.o((e=>a.value=e)),v:e.p({mode:"center","border-radius":"24",modelValue:a.value})})}}),n=e._export_sfc(t,[["__scopeId","data-v-ed90bddd"]]);wx.createPage(n);
