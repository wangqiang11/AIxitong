"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../api/square.js"),i=require("../../../../api/task_reward.js"),s=require("../../../../stores/user.js"),t=require("../../../../config/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),require("../../../../api/user.js"),require("../../../../utils/auth.js"),require("../../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js"))();const u=e.defineComponent({__name:"video",props:{keyword:null},setup(u){const a=u,o=t.config.baseUrl,n=e.useRouter(),l=s.useUserStore(),c=e.ref([]),d=e.shallowRef(),p=e.reactive({lists:[],current:""});e.ref(""),e.ref(!1);const g=()=>{var e;null==(e=d.value)||e.refresh()},m=async(e,i)=>{var s,t;try{const{lists:t=[]}=await r.getVideoSquare({keyword:a.keyword,category_id:p.current,page_size:i,page_no:e});null==(s=d.value)||s.complete(t)}catch(u){null==(t=d.value)||t.complete(!1)}};return e.watch((()=>p.current),(()=>{g()})),e.watchDebounced((()=>a.keyword),(e=>{g()}),{debounce:500,immediate:!1}),(async()=>{p.lists=await i.getSquareCategory({type:3}),p.lists.unshift({name:"全部",id:""})})(),(i,s)=>({a:e.f(p.lists,((r,i,s)=>({a:e.t(r.name),b:r.id===p.current?1:"",c:r.id,d:e.o((e=>p.current=r.id),r.id)}))),b:e.f(c.value,((i,s,t)=>{var u,a;return e.e({a:i.video_url,b:e.n(i.is_collect?"praise-entry":"praise-leave"),c:e.o((s=>(async i=>{if(l.isLogin)try{await r.videoSquareCollect({records_id:i.id,status:i.is_collect?0:1}),0===p.current?g():i.is_collect=i.is_collect?0:1}catch(s){console.error(s),e.index.$u.toast(JSON.stringify(s))}else n.navigateTo("/pages/login/login")})(i)),s),d:e.t(i.prompt),e:null==(u=null==i?void 0:i.user_info)?void 0:u.name},(null==(a=null==i?void 0:i.user_info)?void 0:a.name)?{f:"15dbf44e-1-"+t+",15dbf44e-0",g:e.p({src:i.user_info.image,width:"40",height:"40","border-radius":"50"}),h:e.t(i.user_info.name)}:{},{i:s,j:e.o((e=>(async e=>{n.navigateTo({path:"/packages/pages/video_detail/video_detail",query:{id:e.id,collectId:e.id}})})(i)),s)})})),c:`url(${e.unref(o)}resource/image/api/default/praise.png)`,d:e.sr(d,"15dbf44e-0",{k:"pagingRef"}),e:e.o(m),f:e.o((e=>c.value=e)),g:e.p({"auto-show-back-to-top":!0,fixed:!1,"auto-clean-list-when-reload":!0,"auto-scroll-to-top-when-reload":!1,modelValue:c.value})})}}),a=e._export_sfc(u,[["__scopeId","data-v-15dbf44e"]]);wx.createComponent(a);
