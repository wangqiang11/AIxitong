"use strict";const e=require("../../../../common/vendor.js"),r=require("../../../../common/assets.js"),i=require("../../../../api/square.js"),s=require("../../../../api/task_reward.js"),a=require("../../../../stores/user.js"),u=require("../../../../config/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),require("../../../../api/user.js"),require("../../../../utils/auth.js"),require("../../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js"))();const t=e.defineComponent({__name:"music",props:{keyword:null},setup(t){const o=t,n=u.config.baseUrl,l=e.useRouter(),c=a.useUserStore(),d=e.ref([]),p=e.shallowRef(),g=e.reactive({lists:[],current:""}),m=async(e,r)=>{var s,a;try{const{lists:a=[]}=await i.getMusicSquare({keyword:o.keyword,category_id:g.current,page_size:r,page_no:e});null==(s=p.value)||s.complete(a)}catch(u){null==(a=p.value)||a.complete(!1)}},q=()=>{var e;null==(e=p.value)||e.refresh()};return e.watch((()=>g.current),(()=>{q()})),e.watchDebounced((()=>o.keyword),(e=>{q()}),{debounce:500,immediate:!1}),(async()=>{g.lists=await s.getSquareCategory({type:2}),g.lists.unshift({name:"全部",id:""})})(),(s,a)=>({a:e.f(g.lists,((r,i,s)=>({a:e.t(r.name),b:r.id===g.current?1:"",c:r.id,d:e.o((e=>g.current=r.id),r.id)}))),b:e.f(d.value,((r,s,a)=>{var u,t;return e.e({a:"4a2fba04-1-"+a+",4a2fba04-0",b:e.p({src:r.image_url,width:"100%",height:"340",mode:"aspectFill","border-radius":"15"}),c:e.t(r.duration),d:e.n(r.is_collect?"praise-entry":"praise-leave"),e:e.o((e=>(async e=>{c.isLogin?(await i.musicSquareCollect({records_id:e.id,status:e.is_collect?0:1}),0===g.current?q():e.is_collect=e.is_collect?0:1):l.navigateTo("/pages/login/login")})(r)),r.id),f:e.t(null==r?void 0:r.title),g:null==(u=null==r?void 0:r.user_info)?void 0:u.name},(null==(t=null==r?void 0:r.user_info)?void 0:t.name)?{h:"4a2fba04-2-"+a+",4a2fba04-0",i:e.p({src:r.user_info.image,width:"40",height:"40","border-radius":"50"}),j:e.t(r.user_info.name)}:{},{k:r.id,l:e.o((e=>(async e=>{c.isLogin||l.navigateTo("/pages/login/login"),l.navigateTo({path:"/packages/pages/music_player/music_player",query:{id:e.id,mode:"square"}})})(r)),r.id)})})),c:r._imports_0$4,d:`url(${e.unref(n)}resource/image/api/default/praise.png)`,e:e.sr(p,"4a2fba04-0",{k:"pagingRef"}),f:e.o(m),g:e.o((e=>d.value=e)),h:e.p({"auto-show-back-to-top":!0,fixed:!1,"auto-clean-list-when-reload":!0,"auto-scroll-to-top-when-reload":!1,modelValue:d.value})})}}),o=e._export_sfc(t,[["__scopeId","data-v-4a2fba04"]]);wx.createComponent(o);
