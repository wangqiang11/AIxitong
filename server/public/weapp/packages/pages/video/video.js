"use strict";const e=require("../../../common/vendor.js"),n=require("../../../api/video.js"),o=require("../../../stores/app.js"),t=require("../../../hooks/useLockFn.js"),u=require("./helper.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/app.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("router-navigate")+e.resolveComponent("u-navbar")+e.resolveComponent("uv-picker")+e.resolveComponent("uv-button")+e.resolveComponent("uv-subsection")+e.resolveComponent("u-form")+e.resolveComponent("u-button")+e.resolveComponent("u-empty")+e.resolveComponent("tabbar"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../uni_modules/uv-picker/components/uv-picker/uv-picker.js")+(()=>"../../../uni_modules/uv-button/components/uv-button/uv-button.js")+i+(()=>"../../../uni_modules/uv-subsection/components/uv-subsection/uv-subsection.js")+l+a+r+s+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js")+(()=>"../../../components/tabbar/tabbar.js"))();const a=()=>"./components/prompt.js",r=()=>"./components/video-size.js",s=()=>"./components/video-style.js",l=()=>"./components/uploader-picture.js",i=()=>"./components/form-item-wrap.js",p=e.defineComponent({__name:"video",setup(a){const r=e.useRouter(),s=e.useRoute(),l=e.shallowRef(),i=e.shallowRef(),p=e.shallowRef(),m=e.shallowRef(),c=o.useAppStore(),d=e.ref([{mode:1,name:"文生视频"},{mode:2,name:"图生视频"}]),v=e.reactive({type:1,prompt:"",scale:"1:1",image:"",style_id:[],channel:"",model_name:"",negative_prompt:"",duration:u.defaultDurationValue,camera_control:{type:u.defaultCameraValue},mode:u.defaultModel}),f=e.ref({model:{},style:[],example:{}}),h=e.computed((()=>{var e;const n=(null==(e=f.value.model[v.channel])?void 0:e.models)||[v.channel];return v.model_name=n[0],n})),_=e.computed((()=>f.value.model[v.channel]||{})),{lockFn:b,isLock:j}=t.useLockFn((async()=>{try{if(!v.prompt)return e.index.$u.toast("请输入"+(1===v.type?"视频场景":"描述词"));if(2===v.type&&!v.image)return e.index.$u.toast("请上传参考图");await n.postVideoGenerate({...v}),v.prompt="",v.style_id=[],v.image="",r.navigateTo("/packages/pages/video_list/video_list")}catch(o){}}));return(async()=>{f.value=await n.getVideoConfig(),v.channel=f.value.channel})(),e.onLoad((()=>{e.index.$on("videoRegenerate",(e=>{Object.assign(v,e)}));const n=s.query;try{const e=JSON.parse(n.data);Object.assign(v,e)}catch(o){}})),(n,o)=>{var t,a,r,s;return e.e({a:n.$theme.navColor,b:n.$theme.navBgColor,c:n.$theme.pageStyle,d:(null==(t=e.unref(c).config.switch)?void 0:t.video_status)>0},(null==(a=e.unref(c).config.switch)?void 0:a.video_status)>0?e.e({e:e.p({name:"clock",size:32}),f:e.p({to:"/packages/pages/video_list/video_list"}),g:e.p({"back-text":"视频"}),h:e.f(d.value,((n,o,t)=>({a:e.t(n.name),b:n.mode,c:Number(v.type)===n.mode?1:"",d:e.o((e=>v.type=n.mode),n.mode)}))),i:e.unref(u.ChannelToken).K_LING===v.channel},e.unref(u.ChannelToken).K_LING===v.channel?{j:e.sr(i,"72107fad-5,72107fad-4",{k:"modelRef"}),k:e.o((e=>v.model_name=e.value[0])),l:e.p({columns:[e.unref(h)]}),m:e.t(v.model_name),n:e.o((()=>e.unref(i).open())),o:e.p({label:"模型",required:!0})}:{},{p:e.unref(u.ChannelToken).K_LING===v.channel},e.unref(u.ChannelToken).K_LING===v.channel?{q:e.o((n=>v.mode=e.unref(u.ModeOptions)[n].value)),r:e.p({list:e.unref(u.ModeOptions),"key-name":"label",mode:"button",current:e.unref(u.ModeOptions).findIndex((e=>v.mode===e.value))}),s:e.p({label:"模式",required:!0})}:{},{t:2===v.type},2===v.type?{v:e.o((e=>v.image=e)),w:e.p({modelValue:v.image})}:{},{x:e.o((e=>v.prompt=e)),y:e.p({type:v.type,config:f.value.example,showTranslate:!!f.value.translate_switch,modelValue:v.prompt}),z:e.unref(u.ChannelToken).K_LING===v.channel},e.unref(u.ChannelToken).K_LING===v.channel?{A:e.o((e=>v.negative_prompt=e)),B:e.p({type:2,label:"负面描述",placeholder:"当需要表达负面情绪时，我们可以使用一些负面提示词用来描述低质量的绘画、畸形的形象等",showTranslate:!!f.value.translate_switch,modelValue:v.negative_prompt})}:{},{C:e.o((e=>v.scale=e)),D:e.p({filters:e.unref(u.ChannelToken).K_LING===v.channel?["1:1","9:16","16:9"]:["1:1","3:4","4:3","9:16","16:9"],modelValue:v.scale}),E:f.value.style.length},f.value.style.length?{F:e.o((e=>v.style_id=e)),G:e.p({"style-list":f.value.style,modelValue:v.style_id})}:{},{H:e.unref(u.ChannelToken).K_LING===v.channel},e.unref(u.ChannelToken).K_LING===v.channel?{I:e.sr(p,"72107fad-15,72107fad-14",{k:"cameraRef"}),J:e.o((({value:[e]})=>v.camera_control.type=e.value)),K:e.p({columns:[e.unref(u.CameraOptions)],"key-name":"label"}),L:e.t(null==(r=e.unref(u.CameraOptions).find((({value:e})=>e===v.camera_control.type)))?void 0:r.label),M:e.o((()=>e.unref(p).open())),N:e.p({label:"镜头",required:!0})}:{},{O:e.unref(u.ChannelToken).K_LING===v.channel},e.unref(u.ChannelToken).K_LING===v.channel?{P:e.sr(m,"72107fad-18,72107fad-17",{k:"durationRef"}),Q:e.o((({value:[e]})=>v.duration=e.value)),R:e.p({columns:[e.unref(u.DurationOptions)],"key-name":"label"}),S:e.t(null==(s=e.unref(u.DurationOptions).find((({value:e})=>e===v.duration)))?void 0:s.label),T:e.o((()=>e.unref(m).open())),U:e.p({label:"时长",required:!0})}:{},{V:e.sr(l,"72107fad-3",{k:"uFormRef"}),W:e.p({model:v,"label-position":"top","border-bottom":!1}),X:f.value.is_member},f.value.is_member?{}:e.unref(_).price>0?{Z:e.t(e.unref(_).price),aa:e.t(e.unref(c).getTokenUnit)}:{},{Y:e.unref(_).price>0,ab:e.o(e.unref(b)),ac:e.p({type:"primary",loading:e.unref(j)})}):{ad:e.p({text:"功能未开启",mode:"list"})})}}});wx.createPage(p);
