"use strict";const e=require("../../../common/vendor.js"),o=require("../../../stores/app.js"),a=require("../../../stores/user.js"),n=require("../../../hooks/useLockFn.js"),r=require("../../../api/draw.js"),u=require("./enum/index.js"),t=require("../../../utils/util.js");if(require("../../../api/app.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/shop.js"),require("../../../api/user.js"),require("../../../utils/auth.js"),require("../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-empty")+e.resolveComponent("tabbar")+e.resolveComponent("u-icon")+e.resolveComponent("router-navigate")+e.resolveComponent("u-navbar")+e.resolveComponent("u-form")+e.resolveComponent("u-button"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js")+(()=>"../../../components/tabbar/tabbar.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+s+i+m+p+l+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const s=()=>"./components/prompt.js",i=()=>"./components/uploader-picture.js",m=()=>"./components/doubao/doubao-size.js",p=()=>"./components/doubao/doubao-model.js",l=()=>"./components/doubao/doubao-options.js",d=e.defineComponent({__name:"doubao",setup(s){const i=e.useRouter(),m=e.useRoute(),p=e.shallowRef(),l=o.useAppStore(),d=a.useUserStore(),c=e.ref([{mode:u.DrawTypeEnum.TEXT,name:"文生图"},{mode:u.DrawTypeEnum.IMAGE,name:"图生图"}]),v=e.ref({draw_api:u.DrawModeEnum.DOUBAO,draw_type:u.DrawTypeEnum.TEXT,draw_model:u.DrawModeEnum.DOUBAO,size:"512x512",engine:"high_aes_general_v20_L",prompt:"",negative_prompt:"",action:"generate",image_mask:"",image_id:"",complex_params:{seed:"",ddim_steps:20}}),g=e.reactive({config:{engine:{anime:{},general:{}},is_member:!1,power:""}}),w=async()=>{g.config=await r.getSdConfig({draw_api:u.DrawModeEnum.DOUBAO}),e.index.setNavigationBarTitle({title:g.config.diy_name})},_=t.series(w),{lockFn:f,isLock:j}=n.useLockFn((async o=>{try{if(o&&(v.value.action=o),""===v.value.prompt)return e.index.$u.toast("请输入提示词");await r.drawing({...v.value}),v.value.prompt="",i.navigateTo({path:"/packages/pages/draw_list/draw_list",query:{model:u.DrawModeEnum.DOUBAO}})}catch(a){}}));return _(),e.onLoad((()=>{e.index.$on("drawRegenerate",(e=>{Object.assign(v.value,e),"generate"!==e.action&&f(e.action)}));const o=m.query;try{const e=JSON.parse(o.data);Object.assign(v.value,e),"generate"!==e.action&&f(e.action)}catch(a){}})),(o,a)=>e.e({a:o.$theme.navColor,b:o.$theme.navBgColor,c:o.$theme.pageStyle,d:!e.unref(l).config.switch.doubao_status},e.unref(l).config.switch.doubao_status?e.e({f:e.p({name:"clock",size:32}),g:e.p({to:{path:"/packages/pages/draw_list/draw_list",query:{model:e.unref(u.DrawModeEnum).DOUBAO}}}),h:e.p({"back-text":"绘画工作台"}),i:e.f(c.value,((o,a,n)=>({a:e.t(o.name),b:o.mode,c:v.value.draw_type===o.mode?1:"",d:e.o((e=>v.value.draw_type=o.mode),o.mode)}))),j:e.o((e=>v.value.prompt=e)),k:e.o((e=>v.value.negative_prompt=e)),l:e.p({"is-negative":!1,model:e.unref(u.DrawModeEnum).DOUBAO,example:g.example,typeEnum:e.unref(u.DrawTypeEnum),showTranslate:!!g.config.translate_switch,modelValue:v.value.prompt,negative:v.value.negative_prompt}),m:v.value.draw_type===e.unref(u.DrawTypeEnum).IMAGE},v.value.draw_type===e.unref(u.DrawTypeEnum).IMAGE?{n:e.o((e=>v.value.image_mask=e)),o:e.p({modelValue:v.value.image_mask})}:{},{p:e.o((e=>v.value.size=e)),q:e.p({modelValue:v.value.size}),r:e.o((e=>v.value.engine=e)),s:e.p({engine:g.config.engine,draw_type:v.value.draw_type,modelValue:v.value.engine}),t:e.o((e=>v.value.complex_params=e)),v:e.p({modelValue:v.value.complex_params}),w:e.sr(p,"eb0ac312-5",{k:"uFormRef"}),x:e.p({model:v.value,"label-position":"top","border-bottom":!1}),y:g.config.is_member},(g.config.is_member,{}),{z:0!=g.config.power&&!g.config.is_member&&e.unref(d).isLogin},0!=g.config.power&&!g.config.is_member&&e.unref(d).isLogin?{A:e.t(g.config.power||"--"),B:e.t(e.unref(l).getTokenUnit)}:{},{C:e.o((o=>e.unref(f)("generate"))),D:e.p({type:"primary",loading:e.unref(j)})}):{e:e.p({text:"绘画功能未开启",mode:"favor"})})}});wx.createPage(d);
