"use strict";const e=require("../../../common/vendor.js"),o=require("../../../stores/app.js"),r=require("../../../stores/user.js"),t=require("../../../hooks/useLockFn.js"),n=require("../../../api/draw.js"),s=require("./enum/index.js"),a=require("../../../utils/util.js");if(require("../../../api/app.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/shop.js"),require("../../../api/user.js"),require("../../../utils/auth.js"),require("../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-empty")+e.resolveComponent("tabbar")+e.resolveComponent("u-icon")+e.resolveComponent("router-navigate")+e.resolveComponent("u-navbar")+e.resolveComponent("u-form")+e.resolveComponent("u-button"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js")+(()=>"../../../components/tabbar/tabbar.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+u+i+l+m+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const u=()=>"./components/prompt.js",i=()=>"./components/dalle/dalle-size.js",l=()=>"./components/dalle/dalle-style.js",m=()=>"./components/dalle/dalle-quality.js",p=e.defineComponent({__name:"dalle",setup(u){const i=e.useRouter(),l=e.useRoute(),m=e.shallowRef(),p=o.useAppStore(),c=r.useUserStore(),d=e.ref({draw_api:s.DrawModeEnum.DALLE,draw_type:s.DrawTypeEnum.TEXT,draw_model:s.DrawModeEnum.DALLE,draw_loras:"",denoising_strength:.75,size:"512x512",prompt:"",negative_prompt:"",action:"generate",image_mask:"",image_id:"",complex_params:{step:20,sampler_name:"Euler a",seed:-1,cfg_scale:7},style:"",quality:""}),v=e.reactive({config:{}}),g=async()=>{v.config=await n.getSdConfig({draw_api:s.DrawModeEnum.DALLE}),e.index.setNavigationBarTitle({title:v.config.diy_name})},f=a.series(g),{lockFn:w,isLock:j}=t.useLockFn((async()=>{try{if(""===d.value.prompt)return e.index.$u.toast("请输入提示词");await n.drawing({...d.value}),d.value.prompt="",i.navigateTo({path:"/packages/pages/draw_list/draw_list",query:{model:s.DrawModeEnum.DALLE}})}catch(o){}}));return f(),e.onLoad((()=>{e.index.$on("drawRegenerate",(e=>{Object.assign(d.value,e)}));const o=l.query;try{const e=JSON.parse(o.data);Object.assign(d.value,e)}catch(r){}})),(o,r)=>e.e({a:o.$theme.navColor,b:o.$theme.navBgColor,c:o.$theme.pageStyle,d:!e.unref(p).config.switch.dalle3_status},e.unref(p).config.switch.dalle3_status?e.e({f:e.p({name:"clock",size:32}),g:e.p({to:{path:"/packages/pages/draw_list/draw_list",query:{model:e.unref(s.DrawModeEnum).DALLE}}}),h:e.p({"back-text":"绘画工作台"}),i:e.o((e=>d.value.prompt=e)),j:e.o((e=>d.value.negative_prompt=e)),k:e.p({"is-negative":!1,model:e.unref(s.DrawModeEnum).DALLE,example:v.example,typeEnum:e.unref(s.DrawTypeEnum),showTranslate:!!v.config.translate_switch,modelValue:d.value.prompt,negative:d.value.negative_prompt}),l:e.o((e=>d.value.size=e)),m:e.p({modelValue:d.value.size}),n:e.o((e=>d.value.style=e)),o:e.p({modelValue:d.value.style}),p:e.o((e=>d.value.quality=e)),q:e.p({modelValue:d.value.quality}),r:e.sr(m,"2357b732-5",{k:"uFormRef"}),s:e.p({model:d.value,"label-position":"top","border-bottom":!1}),t:v.config.is_member},(v.config.is_member,{}),{v:0!=v.config.power&&!v.config.is_member&&e.unref(c).isLogin},0!=v.config.power&&!v.config.is_member&&e.unref(c).isLogin?{w:e.t(v.config.power||"--"),x:e.t(e.unref(p).getTokenUnit)}:{},{y:e.o(e.unref(w)),z:e.p({type:"primary",loading:e.unref(j)})}):{e:e.p({text:"绘画功能未开启",mode:"favor"})})}});wx.createPage(p);
