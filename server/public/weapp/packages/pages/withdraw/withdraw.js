"use strict";const e=require("../../../common/vendor.js"),a=require("../../../api/promotion.js"),u=require("../../../stores/app.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/app.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("u-icon")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+t+o+(()=>"../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const o=()=>"./component/acount-full.js",t=()=>"../../components/uploader/uploader.js",r=e.defineComponent({__name:"withdraw",setup(o){const t=e.useRouter();u.useAppStore();const r=e.ref(!1),n=e.ref(!1),i=e.ref(0),l=e.ref([]),c=e.ref({open:1,explain:""}),s=e.reactive({money:"",account:"",real_name:"",type:"1",money_qr_code:""}),p=e.ref({account:"",real_name:""}),m=e.ref({account:"",real_name:""}),v=e.computed((()=>{var e;return(null==(e=y.value)?void 0:e.find((e=>e.id==s.type)))||{}})),d=async({detail:a})=>{let u=a.value.replace(/(^\s*)|(\s*$)/g,"");if(!u)return void(s.money="");u=u.replace(/[^\d.]/g,""),u=u.replace(/^\./g,""),u=u.replace(".","$#$").replace(/\./g,"").replace("$#$","."),u=u.replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3"),await e.nextTick$1(),s.money=u},y=e.ref(),_=async a=>{r.value=!1,s.type=a,await e.nextTick$1(),1!=a&&4!=a||Object.keys(p.value).map((e=>{s[e]=p.value[e]})),3==a&&Object.keys(m.value).map((e=>{s[e]=m.value[e]}))},w=()=>{var e,a,u,o;p.value.account=null==(e=c.value)?void 0:e.ali_acccount,p.value.real_name=null==(a=c.value)?void 0:a.ali_name,m.value.account=null==(u=c.value)?void 0:u.wechat_acccount,m.value.real_name=null==(o=c.value)?void 0:o.wechat_name},h=async e=>{console.log(e),s.money_qr_code=e[0]},g=async()=>{try{await a.withdrawApply(s),e.index.$u.toast("申请成功"),setTimeout(j,1e3)}catch(u){console.log("提现申请请求失败",u)}},j=()=>{t.navigateTo("/packages/pages/withdraw_record/withdraw_record")};return e.onShow((async()=>{await(async()=>{try{const{user:e,withdraw_config:u}=await a.getDistributionIndex();i.value=e.user_money,s.account=u.ali_acccount,s.real_name=u.ali_name,c.value=u,w()}catch(e){console.log("获取分销中心接口失败",e)}})(),await(async()=>{y.value=await a.withdrawWay(),await _(y.value[0].id)})()})),(a,u)=>{var o,t;return e.e({a:a.$theme.navColor,b:a.$theme.navBgColor,c:a.$theme.pageStyle,d:e.p({src:null==(o=e.unref(v))?void 0:o.image,width:"40",height:"40"}),e:e.t(null==(t=e.unref(v))?void 0:t.title),f:e.p({name:"arrow-right",size:"24"}),g:e.o((e=>r.value=!0)),h:e.t(i.value),i:e.p({name:"arrow-right",size:"24"}),j:e.o(j),k:e.o([e=>s.money=e.detail.value,d]),l:s.money,m:e.o((e=>s.money=i.value)),n:2!=s.type},2!=s.type?{o:`请输入${3==s.type?"微信":"支付宝"}账号`,p:s.account,q:e.o((e=>s.account=e.detail.value))}:{},{r:2!=s.type},2!=s.type?{s:s.real_name,t:e.o((e=>s.real_name=e.detail.value))}:{},{v:3==s.type||4==s.type},3==s.type||4==s.type?{w:e.o(h),x:e.o((e=>l.value=e)),y:e.p({maxUpload:1,"image-fit":"aspectFill",deletable:!0,modelValue:l.value})}:{},{z:e.o(g),A:c.value.open},c.value.open?{B:e.t(c.value.explain)}:{},{C:e.o((e=>n.value=e)),D:e.o((e=>s.account=e)),E:e.o((e=>s.real_name=e)),F:e.p({show:n.value,account:s.account,real_name:s.real_name}),G:e.p({name:"close",color:"#3D3D3D",size:"30"}),H:e.o((e=>r.value=!1)),I:e.f(y.value,((a,u,o)=>({a:"20063cfa-7-"+o+",20063cfa-5",b:e.p({width:"40",height:"40",src:a.image,alt:""}),c:e.t(a.title),d:s.type==a.id?1:"",e:a.id,f:e.o((e=>_(a.id)),a.id)}))),J:e.o((e=>r.value=e)),K:e.p({mode:"bottom",modelValue:r.value})})}}}),n=e._export_sfc(r,[["__scopeId","data-v-20063cfa"]]);wx.createPage(n);
