"use strict";const e=require("../../../common/vendor.js"),o=require("../../../api/app.js"),r=require("../../../api/user.js"),s=require("../../../enums/appEnums.js"),u=require("../../../api/account.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),!Array){(e.resolveComponent("u-input")+e.resolveComponent("u-form-item")+e.resolveComponent("u-verification-code")+e.resolveComponent("u-form")+e.resolveComponent("u-button"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form-item/u-form-item.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-verification-code/u-verification-code.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const t=e.defineComponent({__name:"forget_pwd",setup(t){e.ref(0);const i=e.shallowRef(),n=e.ref(""),a=e.reactive({email:"",mobile:"",password:"",scene:"2",code:"",password_confirm:""}),l=e.computed((()=>e.index.$u.test.mobile(a.mobile))),m=e.computed((()=>e.index.$u.test.email(a.email))),d=e.computed((()=>"1"==a.scene)),c=e.computed((()=>"2"==a.scene)),p=e=>{n.value=e},v=async()=>{var o,r;if(null==(o=i.value)?void 0:o.canGetCode)try{d.value?await b():await f(),e.index.$u.toast("发送成功"),null==(r=i.value)||r.start()}catch(s){console.log("发送验证码失败=>",s)}},f=async()=>(console.log(m.value),a.email?m.value?void(await u.sendEmailCode({scene:s.SMSEnum.FIND_PASSWORD,email:a.email})):(e.index.$u.toast("请输入正确的邮箱地址"),Promise.reject()):(e.index.$u.toast("请输入邮箱"),Promise.reject())),b=async()=>a.mobile?m.value?(e.index.$u.toast("请输入正确的手机号"),Promise.reject()):void(await o.smsSend({scene:s.SMSEnum.FIND_PASSWORD,mobile:a.mobile})):(e.index.$u.toast("请输入手机号"),Promise.reject()),w=e.useRouter(),j=async()=>!a.mobile&&d.value?e.index.$u.toast("请输入手机号码"):!a.email&&c.value?e.index.$u.toast("请输入邮箱"):a.password?a.password_confirm?a.password!=a.password_confirm?e.index.$u.toast("两次输入的密码不一致"):(await r.forgotPassword(a),void setTimeout((()=>{w.navigateBack()}),1500)):e.index.$u.toast("请输入确认密码"):e.index.$u.toast("请输入密码");return e.onLoad((({type:e})=>{a.scene=e})),(o,r)=>({a:o.$theme.navColor,b:o.$theme.navBgColor,c:o.$theme.pageStyle,d:e.o((e=>a.mobile=e)),e:e.p({border:!1,placeholder:"请输入手机号码",modelValue:a.mobile}),f:e.unref(d),g:e.p({label:"手机号",borderBottom:!0}),h:e.o((e=>a.email=e)),i:e.p({border:!1,placeholder:"请输入邮箱账号",modelValue:a.email}),j:e.unref(c),k:e.p({label:"邮箱",borderBottom:!0}),l:e.o((e=>a.code=e)),m:e.p({placeholder:"请输入验证码",border:!1,modelValue:a.code}),n:e.sr(i,"742504d5-7,742504d5-5",{k:"uCodeRef"}),o:e.o(p),p:e.p({seconds:60,"change-text":"x秒"}),q:e.t(n.value),r:e.unref(l)&&e.unref(d)||e.unref(m)&&e.unref(c)?1:"",s:e.o(v),t:e.p({label:"验证码",borderBottom:!0}),v:e.o((e=>a.password=e)),w:e.p({type:"password",placeholder:"6-20位数字+字母或符号组合",border:!1,modelValue:a.password}),x:e.p({label:"新密码",borderBottom:!0}),y:e.o((e=>a.password_confirm=e)),z:e.p({type:"password",placeholder:"再次输入新密码",border:!1,modelValue:a.password_confirm}),A:e.p({label:"确认密码",borderBottom:!0}),B:e.p({borderBottom:!0,"label-width":150}),C:e.o(j),D:e.p({type:"primary",shape:"circle"})})}});wx.createPage(t);
