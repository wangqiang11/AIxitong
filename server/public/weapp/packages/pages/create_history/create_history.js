"use strict";const e=require("../../../common/vendor.js"),t=require("../../../common/assets.js"),i=require("../../../api/create.js"),a=require("../../../hooks/useCopy.js"),r=require("../../../stores/app.js"),o=require("../../../api/chat.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),require("../../../api/app.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("z-paging")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+s+(()=>"../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const s=()=>"../../components/creation-history-item/creation-history-item.js",u=e.defineComponent({__name:"create_history",setup(s){const{copy:u}=a.useCopy(),n=r.useAppStore(),l=e.useRouter(),p=e.reactive({id:0,type:2}),c=e.ref({}),d=e.ref(!1),m=e.reactive({title:"",text:""}),v=e.ref([]),h=e.shallowRef(),g=async(t,i)=>{var a;const r=(await o.getChatRecord({other_id:p.id,type:p.type,page_no:t,page_size:i})).lists.map((t=>{let i="";if(e.isArray(t.ask)){const e=(null==t?void 0:t.ask[0])||{};i=`${e.title}：${e.value}`}else i=t.ask;return{...t,title:i}}));null==(a=h.value)||a.complete(r)},q=async()=>{var t;(await e.index.showModal({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).cancel||(await o.cleanChatRecord({type:p.type,other_id:p.id}),null==(t=h.value)||t.reload())},j=async t=>{var i;try{(await e.index.showModal({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).confirm&&await o.deleteChatRecord({id:t}),null==(i=h.value)||i.refresh()}catch(a){}};return e.onLoad((async e=>{var t;p.id=Number(null==e?void 0:e.id),await(async()=>{const e=await i.getCreationDetail({id:p.id});c.value=e})(),null==(t=h.value)||t.reload(!0)})),(i,a)=>e.e({a:i.$theme.navColor,b:i.$theme.navBgColor,c:i.$theme.pageStyle,d:e.p({src:c.value.image,width:"42",height:"42"}),e:e.t(c.value.name),f:v.value.length},v.value.length?{g:e.o(q)}:{},{h:c.value.name,i:e.f(v.value,((t,i,a)=>({a:e.f(t.reply,((i,r,o)=>({a:e.o(j,r),b:e.o(e.unref(u),r),c:e.o((e=>((e,t)=>{m.text=e,m.title=t,d.value=!0})(e,t.title)),r),d:e.o((i=>(async t=>{await l.navigateBack(),e.index.$emit("createRewrite",t.extra)})(t)),r),e:"31eae7d6-2-"+a+"-"+o+",31eae7d6-0",f:e.p({title:t.title,time:t.create_time,content:i,index:r,overflow:!0,"record-id":t.id,"show-rewrite":t.extra,showVoice:e.unref(n).getIsVoiceOpen,"model-name":t.model}),g:r}))),b:t.id}))),j:t._imports_0$2,k:e.sr(h,"31eae7d6-0",{k:"pagingRef"}),l:e.o(g),m:e.o((e=>v.value=e)),n:e.p({auto:!1,"auto-show-back-to-top":!0,modelValue:v.value}),o:e.t(m.title),p:e.o((e=>d.value=e)),q:e.p({mode:"bottom","border-radius":"14",closeable:!0,modelValue:d.value})})}});wx.createPage(u);
