"use strict";const t=require("../../../common/vendor.js"),i=require("../../../api/ai_ppt.js"),e=require("../../../stores/user.js"),s=require("../../../router/index.js"),n=t.defineStore({id:"aiPPT",state:()=>({config:{status:0,price:0,isVipFree:!0},options:{type:1,prompt:"",cover_id:"",title:"",catalogs:[]},isGenning:!1,isGenningOutline:!1,showTemplate:!1,showOutline:!1,outlineLists:[]}),actions:{async getPPTConfig(){this.config=await i.getPPTConfig()},async genPPT(i){e.useUserStore().isLogin||s.router.navigateTo({path:"/pages/login/login"});let n={...this.options};if(t.isObject(i)?n=i:t.isString(i)&&(n.prompt=i),!n.prompt)return t.index.$u.toast("请输入标题");1===n.type?await this.genPPTSubmit(n):2===n.type?this.showTemplate=!0:(this.showOutline=!0,this.outlineLists=[],this.genOutline(n.prompt))},async genPPTSubmit(t){if(this.isGenning)return;this.isGenning=!0;const n=e.useUserStore();try{await i.genPPT(t),await s.router.navigateTo({path:"/packages/pages/ai_ppt/history"}),n.getUser(),this.options.catalogs=[],this.options.cover_id="",this.options.title="",this.options.prompt=""}catch(o){console.error(o)}finally{this.isGenning=!1}},async genOutline(e=""){if(this.isGenningOutline)return;this.isGenningOutline=!0;const s=t.reactive({prompt:e||this.options.prompt,title:"",catalogs:[],status:0});this.outlineLists.push(s);try{const t=await i.getPPTOutline({prompt:s.prompt});s.status=1,s.title=t.title,s.catalogs=t.catalogs}catch(n){s.status=2}finally{this.isGenningOutline=!1}}}});exports.useAiPPTStore=n,exports.useSearchEx=()=>{const e=t.ref([]);return{searchEx:e,getSearchEx:async()=>{e.value=await i.getPPTExample()}}};
