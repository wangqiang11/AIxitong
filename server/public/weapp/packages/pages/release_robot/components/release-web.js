"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../api/robot.js"),s=require("../../../../hooks/useCopy.js"),o=require("../../../../config/index.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/auth.js"),require("../../../../utils/cache.js"),require("../../../../utils/unique-id.js"),require("../../../../router/index.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),!Array){(e.resolveComponent("u-navbar")+e.resolveComponent("u-button")+e.resolveComponent("u-icon")+e.resolveComponent("z-paging")+e.resolveComponent("u-action-sheet"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-navbar/u-navbar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+i+a+(()=>"../../../../uni_modules/vk-uview-ui/components/u-action-sheet/u-action-sheet.js"))();const i=()=>"./create-share.js",a=()=>"./usage-settings.js",u=e.defineComponent({options:{multipleSlots:!0},__name:"release-web",props:{title:null,type:null,robotId:null,showMoreAction:{type:Boolean,default:!1}},setup(i,{expose:a}){const u=i,n=e.ref(!1),r=e.reactive({lists:[{text:"编辑",type:"edit"},{text:"用量设置",type:"setting"},{text:"删除",color:"#FA5151",type:"delete"}],show:!1,item:{},type:"add"}),l=e=>{r.type=e,n.value=!0},p=e=>{switch(r.lists[e].type){case"setting":h(r.item);break;case"edit":l("edit");break;case"delete":y(r.item.id)}},c=e.ref([]),d=e.shallowRef(),m=async(e,s)=>{var o,i;try{const{lists:i}=await t.getReleaseList({page_no:e,page_size:s,type:u.type,robot_id:u.robotId});null==(o=d.value)||o.complete(i)}catch(a){null==(i=d.value)||i.complete(!1)}},y=async s=>{var o;const{cancel:i}=await e.index.showModal({title:"温馨提示",content:"确定要删除？"});i||(await t.delRelease({id:s,type:u.type}),null==(o=d.value)||o.refresh())},v=e.reactive({show:!1,data:{}}),h=e=>{v.show=!0,v.data=e},j=async e=>{var s;await t.postRelease({...e,type:u.type,robot_id:u.robotId}),null==(s=d.value)||s.refresh()},{copy:w}=s.useCopy(),q=async({value:e,type:s})=>{var o;await("add"==s?t.putRelease({...e,type:u.type,robot_id:u.robotId}):t.postReleaseInfo({...e})),null==(o=d.value)||o.reload()};return a({refresh:()=>{var e;null==(e=d.value)||e.refresh()}}),(t,s)=>({a:e.p({"back-text":i.title}),b:e.o((e=>l("add"))),c:e.p({type:"primary",size:"medium"}),d:e.f(c.value,((t,s,a)=>e.e({a:e.t(t.apikey),b:e.t(t.name),c:e.t(t.secret||"-")},1===i.type?{d:e.t(1==t.chat_type?"文本":"形象")}:{},{e:e.t(t.use_time),f:"actions-"+a,g:e.r("actions",{item:t},a)},1==i.type?{h:"0363983c-3-"+a+",0363983c-2",i:e.p({name:"file-text",size:32}),j:e.o((e=>(e=>{const t=`${o.config.baseUrl}chat/${e.apikey} #${e.name} ${e.secret?`密码: ${e.secret}`:""}`;w(t)})(t)),t.id)}:{},{k:"0363983c-4-"+a+",0363983c-2",l:e.o((e=>(e=>{r.item=e,r.show=!0})(t)),t.id),m:t.id}))),e:1===i.type,f:1==i.type,g:e.p({name:"more-dot-fill",size:32}),h:e.sr(d,"0363983c-2",{k:"pagingRef"}),i:e.o(m),j:e.o((e=>c.value=e)),k:e.p({"auto-clean-list-when-reload":!1,fixed:!1,modelValue:c.value}),l:e.o(q),m:e.o((e=>n.value=e)),n:e.p({data:r.item,mode:r.type,type:i.type,show:n.value}),o:e.o(j),p:e.o((e=>v.show=e)),q:e.p({data:v.data,show:v.show}),r:e.o(p),s:e.o((e=>r.show=e)),t:e.p({list:r.lists,modelValue:r.show})})}});wx.createComponent(u);
