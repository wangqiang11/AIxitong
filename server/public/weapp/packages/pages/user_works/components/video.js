"use strict";const e=require("../../../../common/vendor.js"),u=require("../../../../api/video.js"),o=require("../../../../common/assets.js"),s=require("../../../../utils/client.js"),t=require("../../../../hooks/useCopy.js"),i=require("../../../../utils/download.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/auth.js"),require("../../../../utils/cache.js"),require("../../../../utils/unique-id.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../enums/appEnums.js"),!Array){(e.resolveComponent("u-checkbox")+e.resolveComponent("u-tag")+e.resolveComponent("u-button")+e.resolveComponent("z-paging")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-checkbox/u-checkbox.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-tag/u-tag.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const n=e.defineComponent({__name:"video",props:{isBatch:{type:Boolean}},setup(n){const a=n;e.useRouter();const r=e.shallowRef(),{copy:l}=t.useCopy(),c=e.ref([]),d=e.ref([]),p=e.computed({get:()=>d.value.length===c.value.length,set(){d.value.length===c.value.length?d.value=[]:d.value=c.value.map((e=>e.id))}});e.watch((()=>a.isBatch),(()=>{d.value=[]}));const m=async o=>{const{cancel:s}=await e.index.showModal({title:"温馨提示",content:"确定删除？"});s||(await u.deleteVideo({id:o}),d.value=[],j())},v=e.reactive({show:!1,item:{}}),h=async()=>{await l(v.item.video_url),v.show=!1},g=e.shallowRef(),f=async(e,o)=>{try{const{lists:s}=await u.getVideoLists({page_no:e,page_size:o,status:2});r.value.complete(s)}catch(s){r.value.complete(!1)}},j=()=>{var e;null==(e=r.value)||e.refresh()};return e.onUnmounted((()=>{clearTimeout(g.value)})),(u,t)=>e.e({a:e.f(c.value,((u,o,t)=>e.e(n.isBatch?{a:"0dfc6de9-1-"+t+",0dfc6de9-0",b:e.p({"model-value":d.value.includes(u.id),shape:"circle"})}:{},{c:"0dfc6de9-2-"+t+",0dfc6de9-0",d:e.p({text:u.type_desc,size:"mini","border-color":"transparent"}),e:e.o((o=>e.unref(l)(u.prompt)),u.id),f:e.o((e=>(e=>{s.isWeixinClient()?(v.show=!0,v.item=e):i.downloadFile(e.video_url,"视频","video")})(u)),u.id),g:e.o((e=>m(u.id)),u.id),h:u.video_url,i:e.t(u.prompt),j:e.t(u.create_time),k:u.id,l:e.o((e=>(e=>{if(a.isBatch){const u=d.value.findIndex((u=>u===e));u>-1?d.value.splice(u,1):d.value.push(e)}})(u.id)),u.id)}))),b:n.isBatch,c:e.unref(o._imports_1$2),d:e.unref(o.IconDownload),e:e.unref(o.IconDelete),f:n.isBatch},n.isBatch?{g:e.o((u=>e.isRef(p)?p.value=u:null)),h:e.p({shape:"circle",modelValue:e.unref(p)}),i:e.t(d.value.length),j:e.t(c.value.length),k:e.o((e=>m(d.value))),l:e.p({size:"medium",type:"error",disabled:!d.value.length})}:{},{m:e.sr(r,"0dfc6de9-0",{k:"pagingRef"}),n:e.o(f),o:e.o((e=>c.value=e)),p:e.p({"auto-clean-list-when-reload":!1,"safe-area-inset-bottom":!0,fixed:!1,height:"100%",modelValue:c.value}),q:e.o(h),r:e.p({type:"primary",shape:"circle"}),s:e.o((e=>v.show=e)),t:e.p({mode:"center","border-radius":"15",closeable:!0,modelValue:v.show})})}});wx.createComponent(n);
