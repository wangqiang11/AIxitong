"use strict";const e=require("../../../common/vendor.js"),t=require("../../../api/shop.js"),s=require("../../../enums/appEnums.js"),u=require("../../../stores/user.js"),o=require("../../../common/assets.js");if(require("../../../utils/client.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../config/index.js"),require("../../../api/user.js"),require("../../../utils/auth.js"),require("../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-loading")+e.resolveComponent("u-image")+e.resolveComponent("u-button")+e.resolveComponent("page-status"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-loading/u-loading.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+r+(()=>"../../../components/page-status/page-status.js")+n)();const n=()=>"./component/invite-poster.js",r=()=>"../../../uni_modules/vk-uview-ui/components/u-empty/u-empty.js",a=e.defineComponent({__name:"invite_poster",setup(n){const r=u.useUserStore();e.storeToRefs(r);const a=e.shallowRef(),i=e.reactive({status:s.PageStatusEnum.LOADING,status_text:"服务器请求错误，请稍后再试",poster_params:{code:{x:"",y:""},data:{content:"邀请您前来体验",x:"",y:""},default:1,defaultUrl1:"",defaultUrl2:"",poster:1,posterUrl:"",showData:1},rule_desc:{enabled:1,name:"邀请说明",data:""},poster_url:""}),l=async()=>{var u,o;await e.index.showLoading({title:"生成中"});try{const n=await t.getDecorate({id:9}),r=JSON.parse(n.data);i.poster_params=(null==(u=r[0])?void 0:u.content)||{},i.rule_desc=(null==(o=r[1])?void 0:o.content)||{},await e.nextTick$1(),i.status=s.PageStatusEnum.NORMAL,await a.value.initPosterData()}catch(n){e.index.hideLoading(),i.status_text=n,i.status=s.PageStatusEnum.ERROR,console.log("获取邀请海报装修失败",n)}},d=()=>{e.index.saveImageToPhotosAlbum({filePath:i.poster_url,success:()=>{e.index.$u.toast("保存成功")},fail:t=>{e.index.$u.toast("保存失败"),console.log(t)}})};return e.onMounted((async()=>{await l()})),e.onUnmounted((()=>{e.index.hideLoading()})),e.onPullDownRefresh((async()=>{l(),e.index.stopPullDownRefresh()})),(t,s)=>{var u,n,r,l;return e.e({a:t.$theme.navColor,b:t.$theme.navBgColor,c:t.$theme.pageStyle,d:e.p({width:"540",height:"900","border-radius":"20rpx",src:i.poster_url}),e:null==(u=null==i?void 0:i.rule_desc)?void 0:u.enabled},(null==(n=null==i?void 0:i.rule_desc)?void 0:n.enabled)?{f:e.t(null==(r=null==i?void 0:i.rule_desc)?void 0:r.name),g:e.t(null==(l=null==i?void 0:i.rule_desc)?void 0:l.data)}:{},{h:e.o(d),i:e.p({type:"primary",shape:"circle",size:"default",customStyle:{padding:"0 30rpx",height:"82rpx"}}),j:e.p({"font-size":"28","icon-size":"300",text:i.status_text,src:e.unref(o.EmptyErrorImage)}),k:e.p({status:i.status}),l:e.sr(a,"586dcab3-6",{k:"posterRef"}),m:e.o((e=>{i.poster_url=e})),n:e.p({options:i.poster_params})})}}}),i=e._export_sfc(a,[["__scopeId","data-v-586dcab3"]]);wx.createPage(i);
