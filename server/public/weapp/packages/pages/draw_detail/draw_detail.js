"use strict";const e=require("../../../common/vendor.js"),a=require("../../../hooks/useCopy.js"),s=require("../../../stores/user.js"),t=require("../../../api/draw.js"),u=require("../../../api/square.js"),r=require("../../../enums/appEnums.js"),o=require("../../../config/index.js");if(require("../../../api/user.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../router/index.js"),require("../../../utils/cache.js"),require("../../../enums/constantEnums.js"),require("../../../utils/client.js"),require("../../../utils/auth.js"),require("../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-loading")+e.resolveComponent("u-image")+e.resolveComponent("u-icon")+e.resolveComponent("u-button")+e.resolveComponent("page-status"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-loading/u-loading.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+i+(()=>"../../../components/page-status/page-status.js"))();const i=()=>"../../components/draw-poster/draw-poster.js",n=e.defineComponent({__name:"draw_detail",setup(i){const n=o.config.baseUrl,l={1:"文生图",2:"图生图",3:"选中放大",4:"选中变换"},{copy:p}=a.useCopy(),c=e.useRoute(),m=e.useRouter(),d=s.useUserStore(),v=e.ref(r.PageStatusEnum.LOADING),g=e.ref({id:-1,task_id:"",prompt:"",prompt_en:"",prompt_desc:"",prompt_other:"",status:3,image:"",image_base:"",thumbnail:"",model:"",nickname:"",image_url:"",image_id:-1,scale:"",able_actions:null,fail_reason:"",negative_prompt:"",version:"",style:"",engine:"",quality:"",censor_status:-1,create_time:"",loras:[],type:1,complex_params:""}),_=e.reactive({id:""}),q=e.shallowRef(),f=e.ref(!1),j=e.computed((()=>{var e,a,s;return(null==(a=null==(e=g.value)?void 0:e.complex_params)?void 0:a.length)?JSON.parse(null==(s=g.value)?void 0:s.complex_params):{}})),y=async()=>{if(d.isLogin)try{await u.drawSquareCollect({records_id:_.id,status:g.value.is_collect?0:1}),g.value.is_collect=g.value.is_collect?0:1}catch(a){console.error(a),e.index.$u.toast(JSON.stringify(a))}else m.navigateTo("/pages/login/login")};return e.onLoad((async()=>{const e=c.query.id;await(async e=>{try{if(c.query.collectId){const a=await u.getDrawSquareDetail({id:e});a.loras=JSON.parse(a.loras),g.value=a}else{const a=await t.drawRecordDetail({id:e});a.loras=JSON.parse(a.loras),g.value=a}v.value=r.PageStatusEnum.NORMAL}catch(a){v.value=r.PageStatusEnum.ERROR}})(e),_.id=c.query.collectId})),(a,s)=>{var t,u;return e.e({a:a.$theme.navColor,b:a.$theme.navBgColor,c:a.$theme.pageStyle,d:e.p({mode:"circle",color:a.$theme.primaryColor,size:"40"}),e:e.p({src:g.value.image,width:"100%",height:"100%",mode:"widthFix","border-radius":"30"}),f:e.o((a=>e.unref(p)(g.value.prompt_en))),g:e.t(g.value.prompt),h:e.o((a=>e.unref(p)(g.value.negative_prompt))),i:e.t(g.value.negative_prompt||"未填写"),j:e.t(g.value.nickname||(null==(u=null==(t=e.unref(d))?void 0:t.userInfo)?void 0:u.nickname)),k:e.t(g.value.create_time),l:e.t(l[g.value.type]),m:e.t(g.value.engine),n:"sd"==g.value.model},"sd"==g.value.model?{o:e.t(g.value.loras.join("、"))}:{},{p:e.t(g.value.scale),q:"sd"==g.value.model},"sd"==g.value.model?{r:e.t(e.unref(j).step||"-"),s:e.t(e.unref(j).cfg_scale||"-"),t:e.t(e.unref(j).sampler_name||"-"),v:e.t(e.unref(j).seed||"-")}:{},{w:_.id},_.id?{x:`url(${e.unref(n)}resource/image/api/default/praise02.png)`,y:e.n(g.value.is_collect?"praise-entry":"praise-leave"),z:e.o(y),A:e.p({name:"photo",size:"42"}),B:e.o((e=>(async e=>{d.isLogin?(f.value=!0,setTimeout((()=>{q.value.open(e)}),300)):m.navigateTo("/pages/login/login")})(g.value))),C:e.p({type:"primary",size:"default",customStyle:{padding:"0 30rpx",height:"82rpx",width:"300rpx",margin:"0"}})}:{},{D:f.value},f.value?{E:e.sr(q,"1dc5da72-5,1dc5da72-0",{k:"posterRef"}),F:e.o((e=>f.value=!1))}:{},{G:e.p({status:v.value})})}}}),l=e._export_sfc(n,[["__scopeId","data-v-1dc5da72"]]);wx.createPage(l);
