"use strict";const e=require("../../../common/vendor.js"),u=require("../../../api/app.js"),a=require("../../../utils/util.js");if(require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../enums/appEnums.js"),!Array){e.resolveComponent("u-icon")()}Math;const t=e.defineComponent({__name:"uploader",props:{modelValue:{default:[]},uploadViewStyle:{default:{}},maxUpload:{default:1},previewSize:{default:"160"},deletable:{type:Boolean,default:!1},tips:{default:"上传图片"},imageFit:{default:"aspectFill"},maxSize:{default:20}},emits:["update:modelValue","change"],setup(t,{emit:r}){const i=t,s=e.computed$1({get:()=>i.modelValue,set:e=>{r("update:modelValue",e)}}),l=async()=>{try{const{tempFiles:a}=await e.index.chooseImage({count:i.maxUpload,sourceType:["album","camera"]});for(const{path:t,size:l}of a){if(l>=1024*i.maxSize*1024)return e.index.$u.toast("选择的文件超出大小！"),new Error("文件超出大小～");const a=await u.uploadImage(t);s.value.push(a.uri),r("change",s.value)}}catch(a){console.log(a)}};return(u,i)=>e.e({a:t.maxUpload>e.unref(s).length},t.maxUpload>e.unref(s).length?{b:e.p({size:"48",color:"#dcdee0",name:"camera"}),c:e.t(e.unref(s).length>=1?e.unref(s).length+"/"+t.maxUpload:t.tips),d:e.o(l),e:e.s(t.uploadViewStyle)}:{},{f:e.f(e.unref(s),((u,a,i)=>e.e(t.deletable?{a:"e283ca07-1-"+i,b:e.p({name:"close",size:"20",color:"#FFFFFF"}),c:e.o((e=>(e=>{s.value.splice(e,1),r("update:modelValue",s.value),r("change",s.value)})(a)),a)}:{},{d:e.o((u=>((u,a)=>{e.index.previewImage({urls:s.value,current:a})})(0,a)),a),e:u,f:a}))),g:t.deletable,h:t.imageFit,i:e.unref(a.addUnit)(t.previewSize),j:e.unref(a.addUnit)(t.previewSize)})}}),r=e._export_sfc(t,[["__scopeId","data-v-e283ca07"]]);wx.createComponent(r);
