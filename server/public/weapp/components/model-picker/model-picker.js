"use strict";const e=require("../../common/vendor.js"),s=require("../../common/assets.js"),i=require("../../api/app.js"),o=require("../../stores/app.js");if(require("../../utils/request/index.js"),require("../../utils/request/http.js"),require("../../enums/requestEnums.js"),require("../../utils/request/cancel.js"),require("../../stores/user.js"),require("../../api/user.js"),require("../../enums/constantEnums.js"),require("../../utils/auth.js"),require("../../utils/cache.js"),require("../../utils/unique-id.js"),require("../../router/index.js"),require("../../config/index.js"),require("../../utils/client.js"),require("../../enums/appEnums.js"),require("../../api/shop.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("u-icon")+e.resolveComponent("u-collapse-item")+e.resolveComponent("u-collapse")+e.resolveComponent("u-popup"))()}Math||((()=>"../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-collapse-item/u-collapse-item.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-collapse/u-collapse.js")+(()=>"../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const u=e.defineComponent({options:{virtualHost:!0,styleIsolation:"shared"},externalClasses:["class"],__name:"model-picker",props:{id:{type:String,default:""},sub_id:{type:String,default:""},setDefault:{type:Boolean,default:!0},type:{type:String,default:"chatModels"},disabled:{type:Boolean,default:!1},hasHiddenUnit:{type:Boolean,default:!1}},emits:["update:id","update:sub_id","update:modelConfig"],setup(u,{emit:t}){const r=u,n=e.computed({get:()=>r.id,set(e){t("update:id",e)}}),a=e.computed({get:()=>r.sub_id,set(e){t("update:sub_id",e)}}),l=o.useAppStore(),d=e.ref(-1),p=e.reactive({modelList:[],show:!1}),c=e.computed((()=>p.modelList.flatMap((e=>e.models)).find((e=>e.id===a.value))||{})),m=e.computed((()=>{var e,s;const i=(null==(s=null==(e=c.value)?void 0:e.alias)?void 0:s.length)>10;return!!r.hasHiddenUnit&&i})),f=e=>{d.value=e},b=()=>{const e=p.modelList.findIndex((e=>e.is_default))||0,s=p.modelList[e].models[0];s&&(n.value=p.modelList[e].id,a.value=s.id,d.value=e)};e.watch((()=>c.value),(e=>{t("update:modelConfig",e)}));const v=e=>p.modelList[e].models.some((e=>e.id===a.value));return(async()=>{try{const e=await i.getAiModel();p.modelList=e[r.type],r.setDefault&&b()}catch(e){console.log("获取聊天模型数据错误=>",e)}})(),(i,o)=>e.e({a:p.modelList.length},p.modelList.length?e.e({b:e.unref(c).name},e.unref(c).name?e.e({c:e.t(e.unref(c).alias),d:e.unref(m)?1:"",e:e.unref(c).alias&&"0"==e.unref(c).price},e.unref(c).alias&&"0"==e.unref(c).price?{}:e.unref(c).alias?{g:e.t(`消耗${e.unref(c).price}${e.unref(l).getTokenUnit}/1000字符`),h:e.unref(m)?1:""}:{},{f:e.unref(c).alias,i:s._imports_0$10}):{},{j:e.r("d",{item:e.unref(c)}),k:e.o((e=>p.show=!0))}):{},{l:e.f(p.modelList,((i,o,u)=>e.e({a:i.logo},i.logo?{b:i.logo}:{},{c:e.t(i.name),d:i.is_free},(i.is_free,{}),{e:i.remarks},i.remarks?{f:e.t(i.remarks)}:{},{g:e.f(i.models,((o,t,r)=>e.e({a:e.t(o.alias),b:o.alias&&"0"==o.price},o.alias&&"0"==o.price?{}:{c:e.t(`消耗${o.price}${e.unref(l).getTokenUnit}/1000字符`)},{d:e.unref(a)!==o.id},e.unref(a)!==o.id?{e:"2bcbb1a9-3-"+u+"-"+r+",2bcbb1a9-2-"+u,f:e.p({src:e.unref(s.IconUnSelect),width:"32rpx",height:"32rpx"})}:{g:"2bcbb1a9-4-"+u+"-"+r+",2bcbb1a9-2-"+u,h:e.p({name:"checkmark-circle-fill",size:"40rpx"})},{i:o.id,j:e.o((e=>{return s=i.id,u=o.id,n.value=s,a.value=u,void(p.show=!1);var s,u}),o.id)}))),h:o,i:v(o)?1:"",j:"2bcbb1a9-2-"+u+",2bcbb1a9-1",k:e.p({index:o,open:v(o)})}))),m:e.sr("collapseRef","2bcbb1a9-1,2bcbb1a9-0"),n:e.o(f),o:e.p({"event-type":"close",arrow:!0,accordion:!0}),p:e.o((e=>p.show=e)),q:e.p({mode:"bottom","safe-area-inset-bottom":!0,closeable:!0,"border-radius":"16",modelValue:p.show})})}});wx.createComponent(u);
