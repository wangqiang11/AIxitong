"use strict";const e=require("../common/vendor.js");function t(e){const t=e.split(",");return t[t.length-1]}let n=0;exports.base64ToPath=function(o){return new Promise((function(i,r){if("object"==typeof window&&"document"in window){const e=(o=o.split(","))[0].match(/:(.*?);/)[1],t=atob(o[1]);let n=t.length;const r=new Uint8Array(n);for(;n--;)r[n]=t.charCodeAt(n);return i((window.URL||window.webkitURL).createObjectURL(new Blob([r],{type:e})))}let c=o.split(",")[0].match(/data\:\S+\/(\S+);/);c?c=c[1]:r(new Error("base64 error"));const s=Date.now()+String(n++)+"."+c;if("object"!=typeof plus)if("object"==typeof e.wx$1&&e.wx$1.canIUse("getFileSystemManager")){a=e.wx$1.env.USER_DATA_PATH+"/"+s;e.wx$1.getFileSystemManager().writeFile({filePath:a,data:t(o),encoding:"base64",success:function(){i(a)},fail:function(e){r(e)}})}else r(new Error("not support"));else{const e="_doc",n="uniapp_temp";var a=e+"/"+n+"/"+s;if(!function(e,t){const n=e.split("."),o=t.split(".");let i=!1;for(let r=0;r<o.length;r++){const e=n[r]-o[r];if(0!==e){i=e>0;break}}return i}("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL(e,(function(e){e.getDirectory(n,{create:!0,exclusive:!1},(function(e){e.getFile(s,{create:!0,exclusive:!1},(function(e){e.createWriter((function(e){e.onwrite=function(){i(a)},e.onerror=r,e.seek(0),e.writeAsBinary(t(o))}),r)}),r)}),r)}),r);const c=new plus.nativeObj.Bitmap(s);c.loadBase64Data(o,(function(){c.save(a,{},(function(){c.clear(),i(a)}),(function(e){c.clear(),r(e)}))}),(function(e){c.clear(),r(e)}))}}))};
