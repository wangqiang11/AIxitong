"use strict";const e=require("../../../../common/vendor.js"),i=require("../../../../stores/user.js"),a=require("../../../../api/digital.js");if(require("../../../../api/user.js"),require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../router/index.js"),require("../../../../utils/cache.js"),require("../../../../enums/constantEnums.js"),require("../../../../config/index.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),require("../../../../utils/auth.js"),require("../../../../utils/unique-id.js"),!Array){(e.resolveComponent("u-image")+e.resolveComponent("u-avatar")+e.resolveComponent("u-icon")+e.resolveComponent("z-paging"))()}Math||((()=>"../../../../uni_modules/vk-uview-ui/components/u-image/u-image.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-avatar/u-avatar.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../node-modules/z-paging/components/z-paging/z-paging.js")+s+u)();const s=()=>"../add-btn.js",u=()=>"./add-popup.js",n=e.defineComponent({__name:"index",props:{tabIndex:null,currentIndex:null},setup(s,{expose:u}){const n=s,t=i.useUserStore(),r=e.ref([]),o=e.shallowRef(),l=e.ref(!1),c=e.ref(!1),d=e.ref(!1),p=e.useRouter(),m=async()=>{if(!t.isLogin)return p.navigateTo("/pages/login/login");d.value=!0},g=async(e,i)=>{var s,u;try{const{lists:u=[]}=await a.getDigitalList({page_size:i,page_no:e});null==(s=o.value)||s.complete(u)}catch(n){null==(u=o.value)||u.complete(!1)}};return e.watch((()=>n.currentIndex),(i=>{i===n.tabIndex&&(l.value||e.nextTick$1((()=>{setTimeout((()=>{c.value=!0}),100)})))}),{immediate:!0}),u({reload:()=>{e.nextTick$1((()=>{o.value&&o.value.refresh()}))}}),(i,s)=>e.e({a:l.value||c.value},l.value||c.value?{b:e.f(r.value,((i,s,u)=>e.e({a:i.is_disable},(i.is_disable,{}),{b:"6be58cec-1-"+u+",6be58cec-0",c:e.p({src:i.image,width:"100%",height:"256rpx",mode:"aspectFill"}),d:"6be58cec-2-"+u+",6be58cec-0",e:e.p({size:70,src:i.avatar}),f:e.t(i.name),g:"6be58cec-3-"+u+",6be58cec-0",h:"6be58cec-4-"+u+",6be58cec-0",i:e.o((s=>(async i=>{const{cancel:s}=await e.index.showModal({title:"温馨提示",content:"确定删除？"});if(s)return;await a.delDigital({id:i});const u=r.value.findIndex((e=>e.id==i));r.value.splice(u,1)})(i.id)),i.id),j:i.id,k:e.o((e=>(e=>{e.is_disable||p.navigateTo({path:"/packages/pages/digital_setting/digital_setting",query:{id:e.id}})})(i)),i.id)}))),c:e.p({name:"arrow-right",size:20}),d:e.p({name:"trash"}),e:e.sr(o,"6be58cec-0",{k:"pagingRef"}),f:e.o(g),g:e.o((e=>r.value=e)),h:e.p({"auto-clean-list-when-reload":!1,fixed:!1,modelValue:r.value})}:{},{i:e.o(m),j:e.o((i=>e.unref(o).reload())),k:e.o((e=>d.value=e)),l:e.p({modelValue:d.value})})}});wx.createComponent(n);
