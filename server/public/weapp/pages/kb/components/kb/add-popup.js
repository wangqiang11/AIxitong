"use strict";const e=require("../../../../common/vendor.js"),o=require("../../../../api/kb.js"),u=require("../../../../api/app.js"),d=require("../../../../stores/app.js");if(require("../../../../utils/request/index.js"),require("../../../../utils/request/http.js"),require("../../../../enums/requestEnums.js"),require("../../../../utils/request/cancel.js"),require("../../../../stores/user.js"),require("../../../../api/user.js"),require("../../../../enums/constantEnums.js"),require("../../../../utils/auth.js"),require("../../../../utils/cache.js"),require("../../../../utils/unique-id.js"),require("../../../../router/index.js"),require("../../../../config/index.js"),require("../../../../utils/client.js"),require("../../../../enums/appEnums.js"),require("../../../../api/shop.js"),!Array){(e.resolveComponent("app-upload")+e.resolveComponent("u-form-item")+e.resolveComponent("u-input")+e.resolveComponent("app-select")+e.resolveComponent("u-icon")+e.resolveComponent("model-picker")+e.resolveComponent("u-form")+e.resolveComponent("u-button")+e.resolveComponent("u-popup"))()}Math||((()=>"../../../../components/app-upload/app-upload.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-form-item/u-form-item.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../../components/app-select/app-select.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../../components/model-picker/model-picker.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-button/u-button.js")+(()=>"../../../../uni_modules/vk-uview-ui/components/u-popup/u-popup.js"))();const i=e.defineComponent({__name:"add-popup",props:{modelValue:{type:Boolean}},emits:["update:modelValue","close"],setup(i,{emit:a}){const s=i,l=d.useAppStore(),t=e.shallowRef(),r=e.computed({get:()=>s.modelValue,set(e){a("update:modelValue",e)}}),n=e.reactive({chatModels:[],vectorModels:[]});e.reactive({document:"",embedding:""});const m=e.ref({image:"",name:"",intro:"",embedding_model_id:"",documents_model_id:"",documents_model_sub_id:""}),p=e.reactive({image:[{required:!0,message:"请选择知识库图标",trigger:["change"]}],name:[{required:!0,message:"请输入知识库名称",trigger:["change"]}],embedding_model_id:[{required:!0,message:"请选择向量模型"}],documents_model_id:[{required:!0,message:"请选择文件处理模型"}]}),c=e.useRouter(),_=()=>{t.value.validate((async e=>{if(e){const{id:e}=await o.addKB(m.value);c.navigateTo({path:"/packages/pages/kb_info/kb_info",query:{id:e}}),a("close")}}))};return e.watch(r,(e=>{e&&(setTimeout((async()=>{await(async()=>{const{vectorModels:e}=await u.getAiModel({queryKey:"modelLists"});n.vectorModels=e})(),t.value.setRules(p)})),m.value={image:"",name:"",intro:"",documents_model_id:"",documents_model_sub_id:"",embedding_model_id:""})})),(o,u)=>({a:e.o((e=>m.value.image=e)),b:e.p({modelValue:m.value.image}),c:e.p({label:"知识库封面",prop:"image",required:!0}),d:e.o((e=>m.value.name=e)),e:e.p({placeholder:"请输入知识库名称",border:!0,modelValue:m.value.name}),f:e.p({label:"知识库名称",prop:"name",required:!0}),g:e.o((e=>m.value.intro=e)),h:e.p({type:"textarea",height:200,placeholder:"请用一句话描述知识库",border:!0,modelValue:m.value.intro}),i:e.p({label:"知识库简介",prop:"intro"}),j:e.w((({item:o},u,d)=>({a:e.t(o.alias),b:d,c:u})),{name:"label",path:"j",vueId:"3fdd2ca2-9,3fdd2ca2-8"}),k:e.o((e=>m.value.embedding_model_id=e)),l:e.p({popupTitle:"向量模型",dataLists:n.vectorModels,placeholder:"请选择",name:"alias",value:"id",modelValue:m.value.embedding_model_id}),m:e.p({label:"向量模型",prop:"embedding_model_id",required:!0}),n:e.w((({item:o},u,d)=>e.e({a:o.alias},o.alias?{b:e.t(o.alias)}:{},{c:o.alias&&"0"==o.price},o.alias&&"0"==o.price?{}:o.alias?{e:e.t(`消耗${o.price}${e.unref(l).getTokenUnit}/1000字符`)}:{},{d:o.alias},m.value.documents_model_id?{f:"3fdd2ca2-12-"+d+",3fdd2ca2-11",g:e.p({name:"close-circle"}),h:e.o((e=>{m.value.documents_model_id="",m.value.documents_model_sub_id=""}))}:{},{i:"3fdd2ca2-13-"+d+",3fdd2ca2-11",j:d,k:u})),{name:"d",path:"n",vueId:"3fdd2ca2-11,3fdd2ca2-10"}),o:m.value.documents_model_id,p:e.p({name:"arrow-down"}),q:m.value.documents_model_id,r:e.o((e=>m.value.documents_model_id=e)),s:e.o((e=>m.value.documents_model_sub_id=e)),t:e.p({setDefault:!1,id:m.value.documents_model_id,sub_id:m.value.documents_model_sub_id}),v:e.p({label:"文件处理模型",prop:"documents_model_id",required:!0}),w:e.sr(t,"3fdd2ca2-1,3fdd2ca2-0",{k:"uFormRef"}),x:e.p({model:m.value,"label-position":"top","border-bottom":!1}),y:e.o(_),z:e.p({type:"primary"}),A:e.o((o=>e.isRef(r)?r.value=o:null)),B:e.p({closeable:!0,"border-radius":"16",mode:"bottom",modelValue:e.unref(r)})})}}),a=e._export_sfc(i,[["__scopeId","data-v-3fdd2ca2"]]);wx.createComponent(a);
