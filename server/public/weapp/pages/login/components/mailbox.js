"use strict";const e=require("../../../common/vendor.js"),o=require("../../../stores/app.js"),n=require("../../../api/account.js"),r=require("../../../enums/appEnums.js");if(require("../../../api/app.js"),require("../../../utils/request/index.js"),require("../../../utils/request/http.js"),require("../../../enums/requestEnums.js"),require("../../../utils/request/cancel.js"),require("../../../stores/user.js"),require("../../../api/user.js"),require("../../../enums/constantEnums.js"),require("../../../utils/auth.js"),require("../../../utils/cache.js"),require("../../../utils/unique-id.js"),require("../../../router/index.js"),require("../../../config/index.js"),require("../../../utils/client.js"),require("../../../api/shop.js"),!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-input")+e.resolveComponent("u-form-item")+e.resolveComponent("u-verification-code")+e.resolveComponent("router-navigate")+e.resolveComponent("u-form")+e.resolveComponent("agreement")+e.resolveComponent("u-button"))()}Math||((()=>"../../../uni_modules/vk-uview-ui/components/u-icon/u-icon.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-input/u-input.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form-item/u-form-item.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-verification-code/u-verification-code.js")+(()=>"../../../node-modules/uniapp-router-next/components/router-navigate/router-navigate.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-form/u-form.js")+(()=>"../../../components/agreement/agreement.js")+(()=>"../../../uni_modules/vk-uview-ui/components/u-button/u-button.js"))();const s=e.defineComponent({__name:"mailbox",emits:["login"],setup(s,{emit:u}){const i=o.useAppStore(),t=e.shallowRef(),a=e.reactive({scene:2,email:"",captcha:"",code:"",password:""}),c=e.computed((()=>4===a.scene)),m=e.computed((()=>2===a.scene)),p=e.computed((()=>{var e;return null==(e=i.getLoginConfig.register_way)?void 0:e.includes("2")})),l=e.computed((()=>e.index.$u.test.email(a.email))),d=e=>{a.scene=e},v=e.shallowRef(),f=e.ref(""),g=e=>{f.value=e},j=async()=>{var o;return console.log(l.value),a.email?l.value?(await n.sendEmailCode({scene:r.SMSEnum.LOGIN,email:a.email}),e.index.$u.toast("发送成功"),void(null==(o=v.value)||o.start())):(e.index.$u.toast("请输入正确的邮箱地址"),Promise.reject()):(e.index.$u.toast("请输入邮箱"),Promise.reject())},q=()=>{var o;if(null==(o=t.value)?void 0:o.checkAgreement())return a.email?2!=a.scene||a.password?4!=a.scene||a.code?void u("login",{...a}):e.index.$u.toast("请输入验证码"):e.index.$u.toast("请输入密码"):e.index.$u.toast("请输入邮箱号码")};return(o,n)=>e.e({a:e.p({size:36,name:"/static/images/icon/icon_mobile.png"}),b:e.o((e=>a.email=e)),c:e.p({border:!1,placeholder:"请输入邮箱账号",modelValue:a.email}),d:e.unref(c)},e.unref(c)?{e:e.p({size:36,name:"/static/images/icon/icon_code.png"}),f:e.o((e=>a.code=e)),g:e.p({placeholder:"请输入验证码",border:!1,modelValue:a.code}),h:e.sr(v,"58cc38bf-7,58cc38bf-4",{k:"uCodeRef"}),i:e.o(g),j:e.p({seconds:60,"change-text":"x秒"}),k:e.t(f.value),l:e.n(e.unref(l)?"text-primary":"text-muted"),m:e.o(j)}:{},{n:e.unref(m)},e.unref(m)?{o:e.p({size:36,name:"/static/images/icon/icon_password.png"}),p:e.o((e=>a.password=e)),q:e.p({type:"password",placeholder:"请输入密码",border:!1,modelValue:a.password}),r:e.p({to:"/packages/pages/forget_pwd/forget_pwd?type=2"})}:{},{s:e.p({"border-bottom":!0}),t:e.sr(t,"58cc38bf-12",{k:"agreementRef"}),v:e.o(q),w:e.p({type:"primary",shape:"circle","hover-class":"none"}),x:e.unref(c)},e.unref(c)?{y:e.o((e=>d(2)))}:{},{z:e.unref(m)},e.unref(m)?{A:e.o((e=>d(4)))}:{},{B:e.unref(p)},e.unref(p)?{C:e.p({to:"/packages/pages/register/register?type=2"})}:{})}});wx.createComponent(s);
