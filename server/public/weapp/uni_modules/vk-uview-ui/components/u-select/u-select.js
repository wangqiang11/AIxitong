"use strict";const e=require("../../../../common/vendor.js"),t={emits:["update:modelValue","input","confirm"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},list:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},cancelColor:{type:String,default:"#606266"},confirmColor:{type:String,default:"#2979ff"},zIndex:{type:[String,Number],default:0},safeAreaInsetBottom:{type:Boolean,default:!1},maskCloseAble:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[0]},mode:{type:String,default:"single-column"},valueName:{type:String,default:"value"},labelName:{type:String,default:"label"},childName:{type:String,default:"children"},title:{type:String,default:""},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},blur:{type:[Number,String],default:0}},data:()=>({popupValue:!1,defaultSelector:[0],columnData:[],selectValue:[],lastSelectIndex:[],columnNum:0,moving:!1}),watch:{value:{immediate:!0,handler(e){e&&setTimeout((()=>this.init()),10),this.popupValue=e}},modelValue:{immediate:!0,handler(e){e&&setTimeout((()=>this.init()),10),this.popupValue=e}}},computed:{uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.popup}},methods:{pickstart(){this.moving=!0},pickend(){this.moving=!1},init(){this.setColumnNum(),this.setDefaultSelector(),this.setColumnData(),this.setSelectValue()},setDefaultSelector(){this.defaultSelector=this.defaultValue.length==this.columnNum?this.defaultValue:Array(this.columnNum).fill(0),this.lastSelectIndex=this.$u.deepClone(this.defaultSelector)},setColumnNum(){if("single-column"==this.mode)this.columnNum=1;else if("mutil-column"==this.mode)this.columnNum=this.list.length;else if("mutil-column-auto"==this.mode){let e=1,t=this.list;for(;t[0][this.childName];)t=t[0]?t[0][this.childName]:{},e++;this.columnNum=e}},setColumnData(){let e=[];if(this.selectValue=[],"mutil-column-auto"==this.mode){let t=this.list[this.defaultSelector.length?this.defaultSelector[0]:0];for(let l=0;l<this.columnNum;l++)0==l?(e[l]=this.list,t=t[this.childName]):(e[l]=t,t=t[this.defaultSelector[l]][this.childName])}else"single-column"==this.mode?e[0]=this.list:e=this.list;this.columnData=e},setSelectValue(){let e=null;for(let t=0;t<this.columnNum;t++){e=this.columnData[t][this.defaultSelector[t]];let l={value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&e.extra&&(l.extra=e.extra),this.selectValue.push(l)}},columnChange(e){let t=null,l=e.detail.value;if(this.selectValue=[],"mutil-column-auto"==this.mode){this.lastSelectIndex.map(((e,a)=>{e!=l[a]&&(t=a)})),this.defaultSelector=l;for(let e=t+1;e<this.columnNum;e++)this.columnData[e]=this.columnData[e-1][e-1==t?l[t]:0][this.childName],this.defaultSelector[e]=0;l.map(((e,t)=>{let a=this.columnData[t][l[t]],i={value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(i.extra=a.extra),this.selectValue.push(i)})),this.lastSelectIndex=l}else if("single-column"==this.mode){let e=this.columnData[0][l[0]],t={value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&void 0!==e.extra&&(t.extra=e.extra),this.selectValue.push(t)}else"mutil-column"==this.mode&&l.map(((e,t)=>{let a=this.columnData[t][l[t]],i={value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(i.extra=a.extra),this.selectValue.push(i)}))},close(){this.$emit("input",!1),this.$emit("update:modelValue",!1)},getResult(e=null){this.moving||(e&&this.$emit(e,this.selectValue),this.close())},selectHandler(){this.$emit("click")}}};if(!Array){e.resolveComponent("u-popup")()}Math;const l=e._export_sfc(t,[["render",function(t,l,a,i,u,s){return{a:e.t(a.cancelText),b:a.cancelColor,c:e.o((e=>s.getResult("cancel"))),d:e.t(a.title),e:e.t(a.confirmText),f:u.moving?a.cancelColor:a.confirmColor,g:e.o((()=>{})),h:e.o((e=>s.getResult("confirm"))),i:e.o((()=>{})),j:e.f(u.columnData,((t,l,i)=>({a:e.f(t,((t,l,i)=>({a:e.t(t[a.labelName]),b:l}))),b:l}))),k:e.o(((...e)=>s.columnChange&&s.columnChange(...e))),l:u.defaultSelector,m:e.o(((...e)=>s.pickstart&&s.pickstart(...e))),n:e.o(((...e)=>s.pickend&&s.pickend(...e))),o:e.o(s.close),p:e.o((e=>u.popupValue=e)),q:e.p({blur:a.blur,maskCloseAble:a.maskCloseAble,mode:"bottom",popup:!1,length:"auto",safeAreaInsetBottom:a.safeAreaInsetBottom,"z-index":s.uZIndex,modelValue:u.popupValue})}}],["__scopeId","data-v-35eca9fa"]]);wx.createComponent(l);
