"use strict";const e=require("../../../../common/vendor.js"),t={name:"u-sticky",emits:["fixed","unfixed"],props:{offsetTop:{type:[Number,String],default:0},index:{type:[Number,String],default:""},enable:{type:Boolean,default:!0},h5NavHeight:{type:[Number,String],default:44},bgColor:{type:String,default:"#ffffff"},zIndex:{type:[Number,String],default:""}},data(){return{fixed:!1,height:"auto",stickyTop:0,elClass:this.$u.guid(),left:0,width:"auto"}},watch:{offsetTop(e){this.initObserver()},enable(e){0==e?(this.fixed=!1,this.disconnectObserver("contentObserver")):this.initObserver()}},computed:{uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.sticky}},mounted(){this.$nextTick((()=>{this.initObserver()}))},methods:{initObserver(){this.enable&&(this.stickyTop=0!=this.offsetTop?e.index.upx2px(this.offsetTop):0,this.disconnectObserver("contentObserver"),this.$uGetRect("."+this.elClass).then((e=>{this.height=e.height,this.left=e.left,this.width=e.width||"100%",this.$nextTick((()=>{this.observeContent()}))})))},observeContent(){this.disconnectObserver("contentObserver");const t=e.index.createIntersectionObserver(this,{thresholds:[.95,.98,1]});t.relativeToViewport({top:-this.stickyTop}),t.observe("."+this.elClass,(e=>{this.enable&&this.setFixed(e.boundingClientRect.top)})),this.contentObserver=t},setFixed(e){const t=e<this.stickyTop;t?this.$emit("fixed",this.index):this.fixed&&this.$emit("unfixed",this.index),this.fixed=t},disconnectObserver(e){const t=this[e];t&&t.disconnect()}},beforeUnmount(){this.disconnectObserver("contentObserver")}};const i=e._export_sfc(t,[["render",function(t,i,s,n,r,o){return{a:r.fixed?"fixed":"static",b:r.stickyTop+"px",c:r.left+"px",d:"string"==typeof r.width?r.width:r.width+"px",e:o.uZIndex,f:e.n(r.elClass),g:r.fixed?r.height+"px":"auto",h:s.bgColor}}],["__scopeId","data-v-ec7a1dcc"]]);wx.createComponent(i);
