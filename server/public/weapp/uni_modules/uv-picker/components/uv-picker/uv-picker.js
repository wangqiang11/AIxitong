"use strict";const e=require("../../../uv-ui-tools/libs/mixin/mpMixin.js"),n=require("../../../uv-ui-tools/libs/mixin/mixin.js"),i=require("./props.js"),t=require("../../../../common/vendor.js");require("../../../uv-ui-tools/libs/function/index.js"),require("../../../uv-ui-tools/libs/function/test.js"),require("../../../uv-ui-tools/libs/function/digit.js"),require("../../../uv-ui-tools/libs/util/route.js"),require("../../../uv-ui-tools/libs/function/debounce.js"),require("../../../uv-ui-tools/libs/function/throttle.js");const o={name:"uv-picker",emits:["confirm","cancel","close","change"],mixins:[e.mpMixin,n.mixin,i.props],computed:{textStyle(){return(e,n)=>{const i={display:"block"};return this.color&&(i.color=this.color),this.activeColor&&n===this.innerIndex[e]&&(i.color=this.activeColor),i}}},data:()=>({lastIndex:[],innerIndex:[],innerColumns:[],columnIndex:0}),watch:{defaultIndex:{immediate:!0,handler(e){this.setIndexs(e,!0)}},columns:{deep:!0,immediate:!0,handler(e){this.setColumns(e)}}},methods:{open(){this.$refs.pickerPopup.open()},close(){this.$refs.pickerPopup.close()},popupChange(e){e.show||this.$emit("close")},getItemText(e){return this.$uv.test.object(e)?e[this.keyName]:e},cancel(){this.$emit("cancel"),this.close()},confirm(){this.$emit("confirm",this.$uv.deepClone({indexs:this.innerIndex,value:this.innerColumns.map(((e,n)=>e[this.innerIndex[n]])),values:this.innerColumns})),this.closeOnClickConfirm&&this.close()},changeHandler(e){const{value:n}=e.detail;let i=0,t=0;for(let s=0;s<n.length;s++){let e=n[s];if(e!==(this.lastIndex[s]||0)){t=s,i=e;break}}this.columnIndex=t;const o=this.innerColumns;this.setLastIndex(n),this.setIndexs(n),this.$emit("change",{value:this.innerColumns.map(((e,i)=>e[n[i]])),index:i,indexs:n,values:o,columnIndex:t})},setIndexs(e,n){this.innerIndex=this.$uv.deepClone(e),n&&this.setLastIndex(e)},setLastIndex(e){this.lastIndex=this.$uv.deepClone(e)},setColumnValues(e,n){this.innerColumns.splice(e,1,n);let i=this.$uv.deepClone(this.innerIndex);for(let t=0;t<this.innerColumns.length;t++)t>this.columnIndex&&(i[t]=0);this.setIndexs(i)},getColumnValues(e){return(async()=>{await this.$uv.sleep()})(),this.innerColumns[e]},setColumns(e){this.innerColumns=this.$uv.deepClone(e),0===this.innerIndex.length&&(this.innerIndex=new Array(e.length).fill(0))},getIndexs(){return this.innerIndex},getValues(){return(async()=>{await this.$uv.sleep()})(),this.innerColumns.map(((e,n)=>e[this.innerIndex[n]]))}}};if(!Array){(t.resolveComponent("uv-toolbar")+t.resolveComponent("uv-loading-icon")+t.resolveComponent("uv-popup"))()}Math||((()=>"../../../uv-toolbar/components/uv-toolbar/uv-toolbar.js")+(()=>"../../../uv-loading-icon/components/uv-loading-icon/uv-loading-icon.js")+(()=>"../../../uv-popup/components/uv-popup/uv-popup.js"))();const s=t._export_sfc(o,[["render",function(e,n,i,o,s,l){return t.e({a:e.showToolbar},e.showToolbar?{b:t.o(l.cancel),c:t.o(l.confirm),d:t.p({cancelColor:e.cancelColor,confirmColor:e.confirmColor,cancelText:e.cancelText,confirmText:e.confirmText,title:e.title})}:{},{e:t.f(s.innerColumns,((n,i,o)=>t.e({a:e.$uv.test.array(n)},e.$uv.test.array(n)?{b:t.f(n,((n,o,r)=>({a:t.t(l.getItemText(n)),b:o,c:t.s({height:e.$uv.addUnit(e.itemHeight),lineHeight:e.$uv.addUnit(e.itemHeight),fontWeight:o===s.innerIndex[i]?"bold":"normal"}),d:t.s(l.textStyle(i,o))})))}:{},{c:i}))),f:`height: ${e.$uv.addUnit(e.itemHeight)}`,g:s.innerIndex,h:e.immediateChange,i:`${e.$uv.addUnit(e.visibleItemCount*e.itemHeight)}`,j:t.o(((...e)=>l.changeHandler&&l.changeHandler(...e))),k:e.loading},e.loading?{l:t.p({mode:"circle"})}:{},{m:t.sr("pickerPopup","e9c224c2-0"),n:t.o(l.popupChange),o:t.p({mode:"bottom",round:e.round,"close-on-click-overlay":e.closeOnClickOverlay})})}],["__scopeId","data-v-e9c224c2"]]);wx.createComponent(s);
