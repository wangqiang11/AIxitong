"use strict";const e=require("../../../../common/vendor.js"),r=require("./props.js"),t=require("./utils.js"),a=require("./useCanvas.js"),s=require("./watermark.js"),n=require("../../../lime-shared/addUnit/index.js"),o=require("../../../lime-shared/createImage/index.js");require("../../../lime-shared/isNumeric/index.js"),require("../../../lime-shared/isDef/index.js"),require("../../../lime-shared/isBrowser/index.js");const i=e.defineComponent({name:"l-watermark",props:r.WaterMarkProps,options:{virtualHost:!0},externalClasses:["class"],setup(r){const i=e.getCurrentInstance(),d=e.reactive({waterUrl:"",markWidth:0,markLeft:0,markTop:0,canvasShow:!0}),c=a.useCanvas("l-watermark",{context:i}),m=!t.isCanvas2d,u=e.computed((()=>t.getStyleStr({width:n.addUnit(c.width),height:n.addUnit(c.height)}))),l=e.computed((()=>({zIndex:r.zIndex,position:r.fullScreen?"fixed":"absolute",left:d.markLeft,top:d.markTop,right:0,bottom:0,pointerEvents:"none",backgroundRepeat:"repeat",backgroundSize:`${d.markWidth}px`,backgroundImage:`url('${d.waterUrl}')`}))),p=(e,t,a={})=>{d.waterUrl=e;const{gapX:s,offsetLeft:n,gapXCenter:o,gapYCenter:i,offsetTop:c}=a;d.markWidth=(s+t)*r.baseSize,d.markLeft=n-o,d.markTop=c-i};let h=null;const k=()=>{h||(h=new s.s(c,{createImage:o.createImage,appendWatermark:p,pixelRatio:t.getPixelRatio()})),h&&h.render(r)},g=e.watch(r,k);return e.onMounted(k),e.onUnmounted((()=>{g&&g(),d.canvasShow=!1})),{store:d,styles:l,isNotCanvas2d:m,canvasStyle:u}}});const d=e._export_sfc(i,[["render",function(r,t,a,s,n,o){return e.e({a:r.isNotCanvas2d&&r.store.canvasShow},r.isNotCanvas2d&&r.store.canvasShow?{b:e.s(r.canvasStyle)}:{},{c:e.s(r.styles)})}]]);wx.createComponent(d);
