import{k as X,_ as Y,$ as ee,G as te,I as oe,J as le,D as ae,C as se,w as re,v as ue,t as ie,F as ne,c as de,M as ce}from"./element-plus.6d5d7657.js";import{_ as me}from"./index.c3587517.js";import{_ as pe}from"./picker.c6906711.js";import{u as _e,a as fe}from"./vue-router.c4b4a189.js";import{g as ve,e as ge,a as ye,b as Ee}from"./draw_model.3d36de3c.js";import{f as Be}from"./draw_lora.ca5ebd35.js";import{g as he}from"./draw_model_category.640e2894.js";import{g as ke}from"./draw_setting.dc12e26e.js";import{u as Ce}from"./useDictOptions.aef4d901.js";import{d as q,b as N,o as n,c,a as u,Z as Fe,u as a,s as be,r as F,_ as we,i as De,a3 as L,L as Ae,T as e,K as l,S as b,a6 as w,J as M,Q as g,R as $,M as Ve}from"./@vue.7946e41b.js";import"./@element-plus.7d8ec931.js";import"./lodash-es.0dcbbec0.js";import"./dayjs.34e6308d.js";import"./@iktakahiro.37fa5b2b.js";import"./katex.dbdd07a7.js";import"./async-validator.fb49d0f5.js";import"./@ctrl.b082b0c1.js";import"./@popperjs.36402333.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./vue-drag-resize.1871ee6b.js";import"./index.c487cb65.js";import"./index.ec37127a.js";import"./index.vue_vue_type_script_setup_true_lang.9b97e6c6.js";import"./index.410c53ff.js";import"./index.fc6caf68.js";import"./@vueuse.927bd09a.js";import"./lodash.4744e7a5.js";import"./axios.978f8ca9.js";import"./pinia.83a6d4dd.js";import"./vue-demi.b3a9cad9.js";import"./css-color-function.f0ee4d0a.js";import"./color.12f7d1c1.js";import"./clone.65ca8e73.js";import"./color-convert.755d189f.js";import"./color-name.e7a4e1d3.js";import"./color-string.e356f5de.js";import"./balanced-match.d2a36341.js";import"./debug.6eeb6e12.js";import"./ms.a9ae1d6d.js";import"./nprogress.7152acad.js";import"./vue-clipboard3.fa3fc3ae.js";import"./clipboard.f56f94fd.js";import"./echarts.8535e5a6.js";import"./zrender.3eba8991.js";import"./tslib.60310f1a.js";import"./highlight.js.4f6161a5.js";import"./@highlightjs.932a13cd.js";import"./index.vue_vue_type_script_setup_true_lang.266c4e6e.js";import"./index.vue_vue_type_script_setup_true_lang.9933e104.js";import"./usePaging.9ff9bac2.js";import"./preview.vue_vue_type_script_setup_true_lang.6702fed0.js";import"./file.vue_vue_type_style_index_0_scoped_ba7daef9_lang.b66d1428.js";import"./vue3-video-play.e85b6285.js";import"./vuedraggable.0170ba82.js";import"./vue.c48aa7bc.js";import"./sortablejs.65032496.js";const xe={style:{position:"absolute",inset:"0px","user-select":"none"}},Se=["src","alt"],Le=["src"],Me=q({__name:"index",props:{ratio:{type:Array,default:()=>[1,1]},alt:{type:String,default:""},type:{type:String,default:"image"},src:{type:String,default:""}},setup(m){const y=m,h=N(()=>{const[E,_]=y.ratio;return`width: 100%;padding-bottom: ${_/E*100}%;`});return(E,_)=>(n(),c("div",{style:Fe([{position:"relative"},a(h)])},[u("div",xe,[m.type==="image"?(n(),c("img",{key:0,src:m.src,alt:m.alt||m.src,style:{"object-fit":"cover",width:"100%",height:"100%"}},null,8,Se)):(n(),c("video",{key:1,src:m.src,controls:"",style:{"object-fit":"contain",width:"100%",height:"100%"}},null,8,Le))])],4))}}),$e={class:"w-[380px]"},qe={class:"w-[380px]"},Ne={class:"flex items-center gap-2 flex-wrap w-full"},Re={class:"w-[380px]"},Ue={class:"flex items-center"},Ie=u("div",{class:"form-tips"},"\u9ED8\u8BA4\u4E3A0\uFF0C\u6570\u503C\u8D8A\u5927\u8D8A\u6392\u524D\u9762",-1),Oe={class:"flex items-center gap-4 mb-4"},je=u("div",null,"\u5173\u8054\u5FAE\u8C03\u6A21\u578B",-1),Je={class:"flex items-center"},ze={class:"grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 xl:grid-cols-12 gap-2"},Te=["onClick"],Ge={class:"relative rounded-sm overflow-hidden"},He={class:"truncate text-center select-none"},Wt=q({__name:"edit",setup(m){const y=_e(),h=fe(),E=be(),_=F(!1),r=we({model_name:"",title:"",category_id:"",sort:1,status:1,cover:"",loras:[]}),C=F([]),p=F([]),R=N(()=>p.value.every(s=>s.checked)?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"),U={model_name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6A21\u578B\u63CF\u8FF0"}],category_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u6240\u5C5E\u7C7B\u76EE"}],cover:[{required:!0,message:"\u8BF7\u9009\u62E9\u6A21\u578B\u56FE\u6807"}]},{optionsData:I,refresh:D}=Ce({categoryList:{api:he,transformData(s){return s}}}),O=async()=>{let s=await Be({});const t=r.loras.map(d=>d.id);p.value=s.map(d=>({...d,checked:t.includes(d.id)}))},A=s=>{s==="all"?p.value.forEach(t=>{t.checked=!t.checked}):p.value[s].checked=!p.value[s].checked},j=async()=>{var d;const s=p.value.filter(i=>i.checked).map(i=>i.id);await((d=E.value)==null?void 0:d.validate());const t=JSON.parse(JSON.stringify(r));if(!t.title){const i=C.value.find(k=>k.model_name===t.model_name);i&&(t.title=i.title)}t.loras=s,y.query.id?await ge(t):await ye(t),h.push("/ai_application/sd/model")},J=async()=>{_.value=!0;try{const s=await Ee({id:y.query.id});Object.assign(r,s)}finally{_.value=!1}};return De(async()=>{console.log(123);const s=await ke();if(s.length<1||s.proxy_url==="")return X.error({message:"\u8BF7\u5148\u914D\u7F6ESD\u7ED8\u753B\u63A5\u53E3\u5730\u5740",onClose:()=>{h.back()}});console.log(s),y.query.id&&J(),C.value=await ve({}),O()}),(s,t)=>{const d=Y,i=te,k=oe,V=le,f=ae,z=pe,T=se,x=L("router-link"),v=re,S=ee,G=ue,H=ie,K=ne,P=L("SuccessFilled"),Q=de,Z=me,W=ce;return Ae((n(),c("div",null,[e(i,{class:"!border-none",shadow:"never"},{default:l(()=>[e(d,{content:s.$route.query.id?"\u7F16\u8F91\u6A21\u578B":"\u65B0\u589E\u6A21\u578B",onBack:t[0]||(t[0]=o=>s.$router.back())},null,8,["content"])]),_:1}),e(i,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[e(K,{class:"ls-form",ref_key:"formRef",ref:E,rules:U,model:a(r),"label-width":"120px"},{default:l(()=>[e(f,{label:"\u6A21\u578B\u6807\u8BC6",prop:"model_name"},{default:l(()=>[u("div",$e,[e(V,{modelValue:a(r).model_name,"onUpdate:modelValue":t[1]||(t[1]=o=>a(r).model_name=o),placeholder:"\u8BF7\u9009\u62E9\u6A21\u578B\u6807\u8BC6",class:"w-full"},{default:l(()=>[(n(!0),c(b,null,w(a(C),(o,B)=>(n(),M(k,{key:B,label:o.title,value:o.model_name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1}),e(f,{label:"\u6A21\u578B\u5C01\u9762",prop:"cover"},{default:l(()=>[e(z,{modelValue:a(r).cover,"onUpdate:modelValue":t[2]||(t[2]=o=>a(r).cover=o),limit:1},null,8,["modelValue"])]),_:1}),e(f,{label:"\u81EA\u5B9A\u4E49\u540D\u79F0",prop:"title"},{default:l(()=>[u("div",qe,[e(T,{placeholder:"\u4E0D\u586B\u5199\u5219\u663E\u793A\u7CFB\u7EDF\u9ED8\u8BA4\u540D\u79F0",modelValue:a(r).title,"onUpdate:modelValue":t[3]||(t[3]=o=>a(r).title=o)},null,8,["modelValue"])])]),_:1}),e(f,{label:"\u6240\u5C5E\u5206\u7C7B",prop:"category_id"},{default:l(()=>[u("div",Ne,[u("div",Re,[e(V,{modelValue:a(r).category_id,"onUpdate:modelValue":t[4]||(t[4]=o=>a(r).category_id=o),placeholder:"\u8BF7\u9009\u62E9\u6240\u5C5E\u5206\u7C7B"},{default:l(()=>[(n(!0),c(b,null,w(a(I).categoryList,(o,B)=>(n(),M(k,{key:B,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),u("div",Ue,[e(v,{type:"primary",link:""},{default:l(()=>[e(x,{to:"/ai_application/sd/model-category"},{default:l(()=>[g("\u65B0\u5EFA\u5206\u7C7B")]),_:1})]),_:1}),e(S,{direction:"vertical"}),e(v,{type:"primary",link:"",onClick:a(D)},{default:l(()=>[g(" \u5237\u65B0 ")]),_:1},8,["onClick"])])])]),_:1}),e(f,{label:"\u6392\u5E8F",prop:"sort"},{default:l(()=>[u("div",null,[e(G,{modelValue:a(r).sort,"onUpdate:modelValue":t[5]||(t[5]=o=>a(r).sort=o)},null,8,["modelValue"]),Ie])]),_:1}),e(f,{label:"\u72B6\u6001",prop:"status"},{default:l(()=>[e(H,{modelValue:a(r).status,"onUpdate:modelValue":t[6]||(t[6]=o=>a(r).status=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),e(i,{class:"!border-none mt-4",shadow:"never"},{default:l(()=>[u("div",Oe,[je,u("div",Je,[e(v,{type:"primary",link:""},{default:l(()=>[e(x,{to:"/ai_application/sd/lora"},{default:l(()=>[g("\u65B0\u5EFA\u5FAE\u8C03\u6A21\u578B")]),_:1})]),_:1}),e(S,{direction:"vertical"}),e(v,{type:"primary",link:"",onClick:a(D)},{default:l(()=>[g(" \u5237\u65B0 ")]),_:1},8,["onClick"]),e(v,{type:"primary",link:"",onClick:t[7]||(t[7]=o=>A("all"))},{default:l(()=>[g($(a(R)),1)]),_:1})])]),u("div",ze,[(n(!0),c(b,null,w(a(p),(o,B)=>(n(),c("div",{key:o.id,class:"flex flex-col gap-1",onClick:Ke=>A(B)},[u("div",Ge,[e(Me,{src:o.cover,ratio:[1,1]},null,8,["src"]),u("div",{class:Ve(["absolute top-0 left-0 bg-[rgba(0,0,0,0.4)] w-full h-full flex justify-center items-center transition-opacity opacity-0",{"opacity-100":o.checked}])},[e(Q,{size:20},{default:l(()=>[e(P,{color:"#fff"})]),_:1})],2)]),u("div",He,$(o.title),1)],8,Te))),128))])]),_:1}),e(Z,null,{default:l(()=>[e(v,{type:"primary",onClick:j},{default:l(()=>[g("\u4FDD\u5B58")]),_:1})]),_:1})])),[[W,a(_)]])}}});export{Wt as default};
