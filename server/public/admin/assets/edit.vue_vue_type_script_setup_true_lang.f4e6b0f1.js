import{I as G,J as H,D as Q,C as W,t as X,F as Y}from"./element-plus.6d5d7657.js";import{a as Z,e as ee,g as le,b as ae}from"./ai_key.e47c1ec4.js";import{P as ue}from"./index.c487cb65.js";import{f as te}from"./index.fc6caf68.js";import{d as ne,s as U,r as v,b as V,o as n,c as F,T as s,K as o,u as l,J as p,S as D,a6 as R,P as y}from"./@vue.7946e41b.js";const se={class:"edit-popup"},me=ne({__name:"edit",emits:["success"],setup(oe,{expose:M,emit:q}){const L=q,P=U(),b=U(),_=v(""),f=v([]),e=v({id:"",type:"",appid:"",secret:"",channel:"",model_id:"",key:"",remark:"",status:1}),N=V(()=>[1,2,10,11].includes(Number(e.value.type))),J=t=>{const a=f.value.find(r=>r.id===t);a&&(e.value.channel=a.channel)},i=V(()=>{switch(e.value.channel){case"hunyuan":return{key:"SecretKey",secret:"SecretId"};case"minimax":return{key:"\u5BC6\u94A5",secret:"SecretId"};case"kdxf":return[4].includes(e.value.type)?{key:"SecretKey"}:{key:"APIKey",secret:"APISecret"};case"chat_ppt":return{key:"token"};case"tiangong":return{key:"APPKey",secret:"APPSecret"};case"doubao":return[3,4].includes(e.value.type)?{key:"token",appid:"appid"}:[1,2].includes(e.value.type)?{key:"APIKey"}:{key:"Access Key",secret:"Secret Access"};default:return{key:"APIKey",secret:"APISecret"}}}),O=V(()=>{var r;const t={key:[{required:!0,message:"\u8BF7\u8F93\u5165APIKey",trigger:["blur"]}],appid:[{required:!0,message:"\u8BF7\u8F93\u5165APPID"}]},a=(r=e.value.channel)!=null&&r.includes("k_ling")?[]:[{required:!0,message:"\u8BF7\u8F93\u5165APISecret"}];return{...t,secret:a}}),T=async()=>{var t,a;try{await((t=P.value)==null?void 0:t.validate()),e.value.id==""?await Z(e.value):e.value.id!=""&&await ee(e.value),te.msgSuccess("\u64CD\u4F5C\u6210\u529F"),L("success"),(a=b.value)==null||a.close()}catch(r){return r}},$=async(t,a,r)=>{var m;if(a=="add")e.value={id:"",type:t,channel:"",model_id:"",key:"",appid:"",remark:"",status:1},_.value="\u65B0\u589E\u5BC6\u94A5";else if(a=="edit"){const d=await le({id:r.id});Object.keys(d).map(c=>{var k;e.value[c]=(k=d[c])!=null?k:""}),e.value.type=t,_.value="\u7F16\u8F91\u5BC6\u94A5"}(m=b.value)==null||m.open(),j(t)},j=async t=>{try{const a=await ae({type:t});f.value=a}catch(a){console.log(a)}};return M({open:$}),(t,a)=>{const r=G,m=H,d=Q,c=W,k=X,z=Y;return n(),F("div",se,[s(ue,{ref_key:"popupRef",ref:b,title:l(_),async:!0,width:"550px",onConfirm:T},{default:o(()=>[s(z,{class:"ls-form",ref_key:"formRef",ref:P,rules:l(O),model:l(e),"label-width":"98px"},{default:o(()=>{var h,x,g,w,A,B,I,C,K,S;return[s(d,{label:"\u63A5\u53E3\u7C7B\u578B"},{default:o(()=>[l(N)?(n(),p(m,{key:1,class:"w-[330px]",modelValue:l(e).model_id,"onUpdate:modelValue":a[1]||(a[1]=u=>l(e).model_id=u),onChange:J},{default:o(()=>[(n(!0),F(D,null,R(l(f),u=>(n(),p(r,{key:u.id,label:u.name,value:u.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):(n(),p(m,{key:0,class:"w-[330px]",modelValue:l(e).channel,"onUpdate:modelValue":a[0]||(a[0]=u=>l(e).channel=u)},{default:o(()=>[(n(!0),F(D,null,R(l(f),(u,E)=>(n(),p(r,{key:E,label:u,value:E},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1}),((h=l(e).channel)==null?void 0:h.includes("xunfei"))||((x=l(e).channel)==null?void 0:x.includes("kdxf"))||((g=l(e).channel)==null?void 0:g.includes("baidu"))?(n(),p(d,{key:0,label:"APPID",prop:"appid"},{default:o(()=>[s(c,{class:"w-[330px]",modelValue:l(e).appid,"onUpdate:modelValue":a[2]||(a[2]=u=>l(e).appid=u),placeholder:"\u8BF7\u8F93\u5165APPID",clearable:""},null,8,["modelValue"])]),_:1})):y("",!0),((w=l(e).channel)==null?void 0:w.includes("doubao"))&&[3,4].includes(l(e).type)?(n(),p(d,{key:1,label:"appid",prop:"appid"},{default:o(()=>[s(c,{class:"w-[330px]",modelValue:l(e).appid,"onUpdate:modelValue":a[3]||(a[3]=u=>l(e).appid=u),placeholder:"\u8BF7\u8F93\u5165appid",clearable:""},null,8,["modelValue"])]),_:1})):y("",!0),(A=l(e).channel)!=null&&A.includes("minimax")?(n(),p(d,{key:2,label:"groupId",prop:"appid"},{default:o(()=>[s(c,{class:"w-[330px]",modelValue:l(e).appid,"onUpdate:modelValue":a[4]||(a[4]=u=>l(e).appid=u),placeholder:"\u8BF7\u8F93\u5165APPID",clearable:""},null,8,["modelValue"])]),_:1})):y("",!0),l(i).key?(n(),p(d,{key:3,label:l(i).key,prop:"key"},{default:o(()=>[s(c,{class:"w-[330px]",modelValue:l(e).key,"onUpdate:modelValue":a[5]||(a[5]=u=>l(e).key=u),placeholder:`\u8BF7\u8F93\u5165${l(i).key}`,rows:4,type:"textarea",clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):y("",!0),l(i).secret&&(((B=l(e).channel)==null?void 0:B.includes("xunfei"))||((I=l(e).channel)==null?void 0:I.includes("k_ling"))||((C=l(e).channel)==null?void 0:C.includes("kdxf"))||((K=l(e).channel)==null?void 0:K.includes("tiangong"))||((S=l(e).channel)==null?void 0:S.includes("doubao"))&&![1,2].includes(l(e).type))?(n(),p(d,{key:4,label:l(i).secret,prop:"secret"},{default:o(()=>[s(c,{class:"w-[330px]",modelValue:l(e).secret,"onUpdate:modelValue":a[6]||(a[6]=u=>l(e).secret=u),placeholder:`\u8BF7\u8F93\u5165${l(i).secret}`,clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):y("",!0),s(d,{label:"\u5907\u6CE8"},{default:o(()=>[s(c,{class:"w-[330px]",type:"textarea",rows:"4",modelValue:l(e).remark,"onUpdate:modelValue":a[7]||(a[7]=u=>l(e).remark=u),placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8\u5185\u5BB9",clearable:""},null,8,["modelValue"])]),_:1}),s(d,{label:"\u72B6\u6001"},{default:o(()=>[s(k,{modelValue:l(e).status,"onUpdate:modelValue":a[8]||(a[8]=u=>l(e).status=u),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]}),_:1},8,["rules","model"])]),_:1},8,["title"])])}}});export{me as _};
