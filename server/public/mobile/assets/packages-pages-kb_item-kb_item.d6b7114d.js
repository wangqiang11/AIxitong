import{d as e,s as a,o as l,c as t,w as s,b as u,f as o,B as r,j as d,b2 as i,r as n,a as p,D as m,a8 as c,J as f,$ as _,k as v,e as x,F as b,l as y,g,V as k,t as V,U as w}from"./index-d6d2a33a.js";import{_ as j}from"./page-meta.d751427a.js";import{_ as h}from"./u-search.7e682473.js";import{_ as C}from"./u-tag.fd761889.js";import{_ as U}from"./u-icon.992584aa.js";import{_ as z}from"./z-paging.6c8c2edf.js";import{o as q,q as D,r as F,s as P,u as $}from"./kb.9f6bd434.js";import{_ as S}from"./app-upload.vue_vue_type_script_setup_true_lang.13b099e0.js";import{_ as T}from"./u-button.97a3d07f.js";import{_ as B}from"./app-upload-file.vue_vue_type_script_setup_true_lang.1eadfa3b.js";import{_ as E}from"./u-popup.21776ef7.js";import{_ as I}from"./_plugin-vue_export-helper.1b428a4d.js";import"./uv-popup.0236847c.js";import"./mixin.91a2f735.js";import"./isString.6d1f126a.js";import"./uni-file-picker.87d7f36a.js";const M=e({__name:"addPop",emits:["submit","close"],setup(e,{expose:f,emit:_}){const v=a(!1),x=a({kb_id:"",fd_id:"",question:"",answer:"",files:[],images:[],video:[],uuid:""}),b=async()=>{x.value.uuid?await q({...x.value}):await D({...x.value}),_("submit")};return f({open:(e,a,l)=>{v.value=!0,x.value.kb_id=e,x.value.fd_id=a,x.value.uuid=l,""!=l&&(async()=>{const e=await F({uuid:x.value.uuid});Object.keys(x.value).map((a=>{x.value[a]=e[a]}))})()}}),(e,a)=>{const f=d,_=i,y=n(p("app-upload"),S),g=n(p("u-button"),T),k=n(p("app-upload-file"),B),V=m,w=c,j=n(p("u-popup"),E);return l(),t(j,{modelValue:v.value,"onUpdate:modelValue":a[5]||(a[5]=e=>v.value=e),"safe-area-inset-bottom":"",closeable:"","border-radius":"16",mode:"bottom",onClose:a[6]||(a[6]=a=>e.$emit("close"))},{default:s((()=>[u(f,{class:"h-[70vh] flex flex-col mx-[20rpx]"},{default:s((()=>[u(f,{class:"text-xl py-[28rpx] font-bold border-b border-solid border-light border-0"},{default:s((()=>[o(" 录入数据 ")])),_:1}),u(f),u(V,{class:"flex min-h-0 h-full","scroll-y":""},{default:s((()=>[u(f,{class:"p-[20rpx] border border-solid border-[#DCDFE6] rounded"},{default:s((()=>[u(_,{class:"w-full",placeholder:"请输入文档内容，你可以理解为提问的问题（必填）",modelValue:x.value.question,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.question=e)},null,8,["modelValue"])])),_:1}),u(f,{class:"p-[20rpx] border border-solid border-[#DCDFE6] rounded mt-[20rpx]"},{default:s((()=>[u(_,{class:"w-full",placeholder:"请输入补充内容，你可以理解为问题的答案",modelValue:x.value.answer,"onUpdate:modelValue":a[1]||(a[1]=e=>x.value.answer=e)},null,8,["modelValue"])])),_:1}),u(f,{class:"mt-4"},{default:s((()=>[u(y,{maxCount:9,modelValue:x.value.images,"onUpdate:modelValue":a[2]||(a[2]=e=>x.value.images=e),returnType:"object-array"},null,8,["modelValue"]),r("span",{class:"text-info"},"最多支持上传9张图")])),_:1}),u(f,{class:"mt-4"},{default:s((()=>[u(y,{maxCount:1,modelValue:x.value.video,"onUpdate:modelValue":a[3]||(a[3]=e=>x.value.video=e),returnType:"object-array",accept:"video"},null,8,["modelValue"]),r("span",{class:"text-info"},"格式为MP4，大小不能超过20M ")])),_:1}),u(f,{class:"mt-4"},{default:s((()=>[u(k,{modelValue:x.value.files,"onUpdate:modelValue":a[4]||(a[4]=e=>x.value.files=e)},{default:s((()=>[u(f,null,{default:s((()=>[u(g,null,{default:s((()=>[o("上传附件")])),_:1})])),_:1})])),_:1},8,["modelValue"]),r("span",{class:"text-info"}," 支持上传PDF、docx、excle等文件格式 ")])),_:1})])),_:1}),u(f,{class:"mt-2"},{default:s((()=>[u(w,{onClick:b,class:"bg-primary text-white"},{default:s((()=>[o(" 保存 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}}}),R=I(e({__name:"kb_item",setup(e){const r=a(!1),i=f(),m=a(""),c=a(""),q=a(""),D=a(1),F=a([]),S=f(),T=async(e,a)=>{var l,t;try{const{lists:t=[]}=await P({page_size:a,page_no:e,keyword:m.value,fd_id:c.value,kb_id:q.value});null==(l=S.value)||l.complete(t)}catch(s){null==(t=S.value)||t.complete(!1)}},B=async e=>{3!=D.value?(r.value=!0,await k(),setTimeout((()=>{i.value.open(q.value,c.value,e)}),100)):uni.$u.toast("无权限操作！")};return _((e=>{c.value=e.id,q.value=e.kb_id,D.value=e.kb_power})),(e,a)=>{const c=n(p("page-meta"),j),f=d,_=n(p("u-search"),h),k=n(p("u-tag"),C),D=n(p("u-icon"),U),P=n(p("z-paging"),z);return l(),v(b,null,[u(c,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),u(P,{ref_key:"pagingRef",ref:S,modelValue:F.value,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value=e),"safe-area-inset-bottom":!1,"auto-clean-list-when-reload":!1,onQuery:T},{top:s((()=>[u(f,{class:"py-[24rpx] px-[20rpx]"},{default:s((()=>[u(f,{class:"flex justify-between"},{default:s((()=>[u(f,{class:"bg-primary py-[20rpx] px-[30rpx] rounded text-white mr-2",onClick:a[0]||(a[0]=e=>B(""))},{default:s((()=>[o(" 录入数据 ")])),_:1}),u(f,{class:"ml-2 flex-1 min-w-0"},{default:s((()=>[u(_,{modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=e=>m.value=e),onInput:a[2]||(a[2]=e=>{var a;return null==(a=x(S))?void 0:a.reload()}),"bg-color":"#fff",height:"80",shape:"square","border-color":"#e5e5e5",placeholder:"请输入关键词","show-action":!1},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),default:s((()=>[u(f,{class:"pb-[24rpx] px-[20rpx] pt-[10rpx]"},{default:s((()=>[(l(!0),v(b,null,y(F.value,((e,a)=>(l(),t(f,{key:a,class:"mb-[30rpx] shadow rounded-[16rpx]"},{default:s((()=>[u(f,{class:"p-[30rpx]"},{default:s((()=>[u(f,{class:"flex items-center"},{default:s((()=>[0==e.status?(l(),t(k,{key:0,type:"info",text:e.status_msg,size:"mini"},null,8,["text"])):g("v-if",!0),1==e.status?(l(),t(k,{key:1,type:"warning",text:e.status_msg,size:"mini"},null,8,["text"])):g("v-if",!0),2==e.status?(l(),t(k,{key:2,type:"success",text:e.status_msg,size:"mini"},null,8,["text"])):g("v-if",!0),3==e.status?(l(),t(k,{key:3,type:"error",text:e.status_msg,size:"mini",onClick:a=>{return l=e.error,void w({title:"错误信息",content:l});var l}},null,8,["text","onClick"])):g("v-if",!0),u(f,{class:"ml-auto text-sm text-muted"},{default:s((()=>[o(V(e.create_time),1)])),_:2},1024)])),_:2},1024),u(f,{class:"mt-[30rpx] font-bold line-clamp-1"},{default:s((()=>[o(V(e.question),1)])),_:2},1024),u(f,{class:"mt-[25rpx] text-muted line-clamp-3"},{default:s((()=>[o(V(e.answer),1)])),_:2},1024)])),_:2},1024),u(f,{class:"p-[30rpx] flex justify-between items-center"},{default:s((()=>[u(f,{class:"text-muted"},{default:s((()=>[o(" 消耗电力值："+V(e.tokens),1)])),_:2},1024),u(f,{class:"flex items-center"},{default:s((()=>[u(f,{class:"flex items-center",onClick:a=>B(e.uuid)},{default:s((()=>[u(D,{class:"text-muted",name:"edit-pen"}),u(f,{class:"ml-1"},{default:s((()=>[o(" 修正 ")])),_:1})])),_:2},1032,["onClick"]),e.is_default?g("v-if",!0):(l(),t(f,{key:0,class:"flex items-center ml-[20rpx]",onClick:a=>(async e=>{w({title:"提示",content:"请确认是否删除！",success:async function(a){var l;a.confirm?(await $({kb_id:q.value,uuids:[e]}),null==(l=S.value)||l.reload()):a.cancel&&console.log("用户点击取消")}})})(e.uuid)},{default:s((()=>[u(D,{class:"text-muted",name:"trash"}),u(f,{class:"ml-1"},{default:s((()=>[o(" 删除 ")])),_:1})])),_:2},1032,["onClick"]))])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"]),r.value?(l(),t(M,{key:0,ref_key:"addPopRef",ref:i,onSubmit:a[4]||(a[4]=()=>{var e;r.value=!1,null==(e=x(S))||e.reload()}),onClose:a[5]||(a[5]=e=>r.value=!1)},null,512)):g("v-if",!0)],64)}}}),[["__scopeId","data-v-73a912a9"]]);export{R as default};
