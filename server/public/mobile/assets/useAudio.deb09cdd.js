import{J as e,s as a,a_ as l,a$ as u}from"./index-d6d2a33a.js";import{h as o}from"./howler.bdae6f69.js";const v=new Set,r=r=>{const{onstart:n,onstop:s,onerror:t}=r||{},i=e(null),p=a(!1),d=a(0),c=a(0),y=a(0),m=()=>{null==n||n(),k(),p.value=!0},w=()=>{null==s||s(),p.value=!1,clearTimeout(y.value)},T=e=>{console.error(e),null==t||t(),p.value=!1,clearTimeout(y.value)},k=()=>{c.value=i.value.seek(),clearTimeout(y.value),y.value=setTimeout((()=>{k()}),100)},f=e=>{i.value=new o.Howl({src:e,autoplay:!1,preload:!1}),i.value.isPlaying=p,i.value.on("play",m),i.value.on("end",w),i.value.on("loaderror",T),i.value.on("playerror",T),i.value.on("stop",w),i.value.on("pause",w)},g=e=>{var a;null==(a=i.value)||a.unload(),f(e),i.value.src=e},h=()=>{var e;null==(e=i.value)||e.stop()},x=()=>{v.forEach((e=>{e.paused||e.pause()}))};return l((()=>{var e,a;p.value&&h(),i.value&&(null==(a=(e=i.value).destroy)||a.call(e),v.delete(i.value),i.value=null,clearTimeout(y.value))})),{pause:h,pauseAll:x,play:async e=>{x(),e&&(f(e),g(e)),await(async()=>{i.value.off("load"),i.value.load(),i.value.once("load",(()=>{d.value=i.value.duration(),u()?window.WeixinJSBridge.invoke("getNetworkType",{},(()=>{i.value.play()}),!1):i.value.play()}))})()},duration:d,currentTime:c,isPlaying:p,setUrl:g,suspend:()=>{var e;null==(e=i.value)||e.pause()},seek:e=>{var a;null==(a=i.value)||a.seek(e),c.value=i.value.seek()}}};export{r as u};
