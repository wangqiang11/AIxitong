import{d as e,u as t,s as a,cu as s,M as l,K as r,L as o,$ as u,bd as c,be as n,o as i,k as p,b as d,c as f,w as m,e as x,f as _,t as g,F as h,l as y,g as v,r as k,a as b,j as w,h as j,m as C,B as P,a4 as S,a6 as z}from"./index-d6d2a33a.js";import{_ as I}from"./page-meta.d751427a.js";import{p as L,_ as U}from"./payment.c92cd342.js";import{_ as A}from"./router-navigate.18e98059.js";import{_ as F}from"./u-empty.a728d8d9.js";import{_ as R}from"./u-icon.992584aa.js";import{_ as T}from"./u-popup.21776ef7.js";import{_ as O}from"./page-status.451737f8.js";import{_ as V}from"./tabbar.vue_vue_type_script_setup_true_lang.e2e30d1a.js";import{r as D,g as E}from"./recharge.60c94e2c.js";import{u as M}from"./useLockFn.3b1f86f9.js";import{F as N}from"./floating-menu.85d77f2f.js";import{_ as $}from"./_plugin-vue_export-helper.1b428a4d.js";import"./u-radio-group.5e4decfb.js";import"./emitter.1571a5d9.js";import"./u-button.97a3d07f.js";import"./u-loading.d153dd1a.js";import"./u-badge.f9b9ebb9.js";const B=$(e({__name:"recharge",setup(e){const $=t(),B=a(s.LOADING),G=a({lists:[]});l();const H=a({is_open:1,tips:"立即支付"}),K=a(),W=r({orderId:"",from:"recharge",showPay:!1,orderAmount:"",showCheck:!1,showPaySuccess:!1}),{isLock:Z,lockFn:q}=M((async()=>{S({mask:!0,title:"请稍后..."});try{const e=await D({package_id:K.value});W.orderId=e.order_id,W.showPay=!0,W.orderAmount=e.order_amount}catch(e){}finally{z()}})),J=async()=>{W.showPay=!1,W.showPaySuccess=!0},Q=async()=>{var e;G.value=await E({page_type:0}),K.value=(null==(e=G.value.lists.find((e=>e.is_recommend)))?void 0:e.id)||""},X=async()=>{try{await Promise.all([Q()]),B.value=s.NORMAL}catch(e){B.value=s.ERROR}};return o((async()=>{X()})),u((e=>{((null==e?void 0:e.id)||e["amp;id"])&&(e.from||e["amp;from"])&&(W.orderId=(null==e?void 0:e.id)||e["amp;id"],W.from=e.from||e["amp;from"]),(null==e?void 0:e.checkPay)&&(W.showCheck=!0)})),c((async()=>{try{await X()}catch(e){}n()})),(e,t)=>{const a=k(b("page-meta"),I),s=w,l=k(b("price"),U),r=j,o=k(b("router-navigate"),A),u=k(b("u-empty"),F),c=k(b("u-icon"),R),n=k(b("u-popup"),T),S=k(b("page-status"),O),z=k(b("tabbar"),V);return i(),p(h,null,[d(a,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),H.value.is_open?(i(),f(S,{key:0,status:B.value},{error:m((()=>[d(u,{text:"加载出错～"})])),default:m((()=>[x($).getSwitchConfig.recharge_status?(i(),f(s,{key:0,class:"task-center pb-[180rpx]"},{default:m((()=>[d(s,{class:"account-info"},{default:m((()=>[d(s,{class:"text-xl"},{default:m((()=>[_("我的帐号")])),_:1}),d(s,{class:"mt-[30rpx] flex"},{default:m((()=>[d(s,{class:"flex-1 flex flex-col items-center"},{default:m((()=>[d(s,{class:"text-[36rpx]"},{default:m((()=>{var e;return[_(g(null==(e=G.value.extend)?void 0:e.balance),1)]})),_:1}),d(s,{class:"text-muted mt-[10rpx]"},{default:m((()=>[_(g(x($).getTokenUnit)+"数量 ",1)])),_:1})])),_:1}),d(s,{class:"flex-1 flex flex-col items-center"},{default:m((()=>[d(s,{class:"text-[36rpx]"},{default:m((()=>{var e;return[_(g(null==(e=G.value.extend)?void 0:e.robot_num),1)]})),_:1}),d(s,{class:"text-muted mt-[10rpx]"},{default:m((()=>[_(" 智能体 ")])),_:1})])),_:1})])),_:1})])),_:1}),d(s,{class:"mt-[30rpx] text-xl"},{default:m((()=>[_(" 套餐选择 ")])),_:1}),d(s,null,{default:m((()=>[(i(!0),p(h,null,y(G.value.lists,(e=>(i(),f(s,{class:C(["recharge-template flex relative items-center !pl-0",{"recharge-template--active":e.id==K.value}]),key:e.id,onClick:t=>K.value=e.id},{default:m((()=>[e.tags?(i(),f(s,{key:0,style:{background:"#ff7272"},class:"text-white rounded-bl-lg absolute top-0 right-0 px-[12rpx] py-[6rpx] text-xs"},{default:m((()=>[P("span",null,g(e.tags),1)])),_:2},1024)):v("v-if",!0),d(s,{class:"flex flex-col items-center w-[200rpx] px-[20rpx]"},{default:m((()=>[d(s,null,{default:m((()=>[d(l,{content:e.sell_price,color:"#000",fontWeight:"500",mainSize:"42rpx",minorSize:"32rpx"},null,8,["content"])])),_:2},1024),e.line_price>0?(i(),f(s,{key:0},{default:m((()=>[d(l,{color:"#999999",lineThrough:"",content:e.line_price,mainSize:"28rpx",minorSize:"28rpx"},{prefix:m((()=>[d(s,null,{default:m((()=>[_("原价￥")])),_:1})])),_:2},1032,["content"])])),_:2},1024)):v("v-if",!0)])),_:2},1024),d(s,{class:"flex-1 min-w-0"},{default:m((()=>[d(s,{class:"text-xl line-clamp-1 font-medium"},{default:m((()=>[_(g(e.name),1)])),_:2},1024),d(s,{class:"mt-[10rpx] flex"},{default:m((()=>[d(s,{class:"text-sm text-info flex-none"},{default:m((()=>[_(g(x($).getTokenUnit)+"数量： ",1)])),_:1}),d(s,{class:"text-sm flex flex-wrap items-center"},{default:m((()=>[P("span",{class:"mr-[10rpx]"},g(e.chat_balance),1)])),_:2},1024)])),_:2},1024),d(s,{class:"mt-[10rpx] flex"},{default:m((()=>[d(s,{class:"text-sm text-info flex-none"},{default:m((()=>[_(" 智能体个数： ")])),_:1}),d(s,{class:"text-sm flex flex-wrap items-center"},{default:m((()=>[P("span",{class:"mr-[10rpx]"},g(e.robot_number),1)])),_:2},1024)])),_:2},1024),e.is_give?(i(),f(s,{key:0,class:"mt-[10rpx] text-primary text-sm"},{default:m((()=>[_(" 赠: "),e.give_chat_balance?(i(),f(r,{key:0},{default:m((()=>[_(g(e.give_chat_balance)+g(x($).getTokenUnit)+" "+g(e.give_robot_number?"，":""),1)])),_:2},1024)):v("v-if",!0),e.give_robot_number?(i(),f(r,{key:1},{default:m((()=>[_(g(e.give_robot_number)+"智能体 ",1)])),_:2},1024)):v("v-if",!0)])),_:2},1024)):v("v-if",!0)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1}),d(s,{class:"bg-white fixed bottom-0 w-full left-0"},{default:m((()=>[d(s,{class:"p-[20rpx]"},{default:m((()=>[d(s,{class:"w-full rounded-full recharge-btn py-[20rpx] text-center text-white",onClick:x(q)},{default:m((()=>[_(" 立即支付 ")])),_:1},8,["onClick"]),d(o,{class:"text-center text-info text-sm mt-2",to:"/packages/pages/agreement/agreement?type=payment"},{default:m((()=>[_(" 支付即视为您同意《会员支付协议》 ")])),_:1})])),_:1})])),_:1})])),_:1})):(i(),f(s,{key:1,class:"py-[400rpx]"},{default:m((()=>[d(u,{text:"功能未开启"})])),_:1})),d(L,{show:W.showPay,"onUpdate:show":t[0]||(t[0]=e=>W.showPay=e),"order-id":W.orderId,showCheck:W.showCheck,"onUpdate:showCheck":t[1]||(t[1]=e=>W.showCheck=e),from:W.from,redirect:"/mobile/packages/pages/recharge/recharge","order-amount":W.orderAmount,onSuccess:J},null,8,["show","order-id","showCheck","from","order-amount"]),d(n,{modelValue:W.showPaySuccess,"onUpdate:modelValue":t[3]||(t[3]=e=>W.showPaySuccess=e),"safe-area-inset-bottom":!0,"mask-close-able":!1,"border-radius":"14","z-index":899,round:"",mode:"center",width:"600"},{default:m((()=>[d(s,{class:"pt-[20rpx]"},{default:m((()=>[d(s,{class:"px-[30rpx] py-[40rpx]"},{default:m((()=>[d(s,{class:"text-success text-center"},{default:m((()=>[d(c,{name:"checkmark-circle-fill",size:"100"})])),_:1}),d(s,{class:"text-xl font-medium mt-[20rpx] text-center"},{default:m((()=>[_(" 支付成功 ")])),_:1}),d(s,{class:"flex mt-[60rpx]"},{default:m((()=>[d(s,{class:"flex-1"},{default:m((()=>[d(s,{class:"h-[72rpx] leading-[72rpx] rounded-full bg-page text-center",onClick:t[2]||(t[2]=e=>W.showPaySuccess=!1)},{default:m((()=>[d(r,null,{default:m((()=>[_("继续充值")])),_:1})])),_:1})])),_:1}),d(s,{class:"flex-1 ml-[20rpx]"},{default:m((()=>[d(o,{class:"h-[72rpx] leading-[72rpx] rounded-full bg-primary text-center text-btn-text",to:"/pages/index/index","nav-type":"reLaunch"},{default:m((()=>[d(r,null,{default:m((()=>[_("返回首页")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["status"])):v("v-if",!0),v("    悬浮菜单    "),d(N),d(z)],64)}}}),[["__scopeId","data-v-5fba48e9"]]);export{B as default};
