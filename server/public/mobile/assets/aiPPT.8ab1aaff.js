import{aK as t,aW as i,A as s,Q as n,b0 as a,K as e,s as o}from"./index-d6d2a33a.js";import{i as p}from"./isString.6d1f126a.js";function r(i){return t.get({url:"/ppt/lists",data:i})}function u(i){return t.get({url:"/ppt/detail",data:i})}function l(i){return t.post({url:"/ppt/cover",data:i})}function c(i){return t.post({url:"/ppt/del",data:i})}function g(i){return t.post({url:"/ppt/download",data:i})}const h=i({id:"aiPPT",state:()=>({config:{status:0,price:0,isVipFree:!0},options:{type:1,prompt:"",cover_id:"",title:"",catalogs:[]},isGenning:!1,isGenningOutline:!1,showTemplate:!1,showOutline:!1,outlineLists:[]}),actions:{async getPPTConfig(){this.config=await t.get({url:"/ppt/config"})},async genPPT(t){s().isLogin||n.navigateTo({path:"/pages/login/login"});let i={...this.options};if(a(t)?i=t:p(t)&&(i.prompt=t),!i.prompt)return uni.$u.toast("请输入标题");1===i.type?await this.genPPTSubmit(i):2===i.type?this.showTemplate=!0:(this.showOutline=!0,this.outlineLists=[],this.genOutline(i.prompt))},async genPPTSubmit(i){if(this.isGenning)return;this.isGenning=!0;const a=s();try{await(e=i,t.post({url:"/ppt/submit",data:e})),await n.navigateTo({path:"/packages/pages/ai_ppt/history"}),a.getUser(),this.options.catalogs=[],this.options.cover_id="",this.options.title="",this.options.prompt=""}catch(o){console.error(o)}finally{this.isGenning=!1}var e},async genOutline(i=""){if(this.isGenningOutline)return;this.isGenningOutline=!0;const s=e({prompt:i||this.options.prompt,title:"",catalogs:[],status:0});this.outlineLists.push(s);try{const i=await function(i){return t.post({url:"/ppt/structure",data:i})}({prompt:s.prompt});s.status=1,s.title=i.title,s.catalogs=i.catalogs}catch(n){s.status=2}finally{this.isGenningOutline=!1}}}}),m=()=>{const i=o([]);return{searchEx:i,getSearchEx:async()=>{i.value=await t.get({url:"/ppt/example"})}}};export{m as a,r as b,c,g as d,u as e,l as g,h as u};
