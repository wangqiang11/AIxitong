import{d as e,K as a,o as t,c as l,w as s,b as o,k as i,l as u,F as r,j as m,D as n,r as d,a as p,m as c,e as f,n as _,f as x,t as g,s as h,x as v,g as w,a7 as y,J as b,u as V,A as j,$ as k,bo as U,z as O,ae as z,ag as C,h as L,b3 as A}from"./index-d6d2a33a.js";import{_ as D}from"./page-meta.d751427a.js";import{_ as T}from"./u-empty.a728d8d9.js";import{_ as B}from"./tabbar.vue_vue_type_script_setup_true_lang.e2e30d1a.js";import{_ as E}from"./u-icon.992584aa.js";import{_ as q}from"./router-navigate.18e98059.js";import{_ as F}from"./u-navbar.d70905ec.js";import{_ as I}from"./u-form.f207500c.js";import{_ as $}from"./u-button.97a3d07f.js";import{u as G}from"./useLockFn.3b1f86f9.js";import{b as J,c as H}from"./draw.cfe8756a.js";import{_ as K,D as M,a as P,P as R}from"./item-title.vue_vue_type_script_setup_true_lang.c5dbcb83.js";import{U as S}from"./uploader-picture.d97f4fdc.js";import{_ as X}from"./u-form-item.36bcbf1f.js";import{a as N}from"./index.3dd6f2ef.js";import{_ as Z}from"./_plugin-vue_export-helper.1b428a4d.js";import{_ as Q}from"./u-image.9574760c.js";import{_ as W}from"./app-slider.f52d5aca.js";import{_ as Y,a as ee}from"./u-collapse.5c69f838.js";import"./u-badge.f9b9ebb9.js";import"./l-textarea.9d4b6972.js";import"./u-loading.d153dd1a.js";import"./u-popup.21776ef7.js";import"./uni-file-picker.87d7f36a.js";import"./image-uploader.b31ee9fb.js";import"./emitter.1571a5d9.js";import"./index.22b2ad12.js";const ae=Z(e({__name:"doubao-size",props:{modelValue:{default:"512x512"}},emits:["update:modelValue"],setup(e,{emit:h}){const v=e,{modelValue:w}=N(v,h),y=a({lists:[{name:"头像",scaleLabel:"1:1",scaleValue:"512x512",width:40,height:40},{name:"小红书",scaleLabel:"2:3",scaleValue:"341x512",width:25,height:40},{name:"文章",scaleLabel:"4:3",scaleValue:"512x384",width:40,height:30},{name:"媒体",scaleLabel:"3:4",scaleValue:"384x512",width:30,height:40},{name:"宣传海报",scaleLabel:"9:16",scaleValue:"288x512",width:24,height:40},{name:"电脑壁纸",scaleLabel:"16:9",scaleValue:"512x288",width:40,height:24},{name:"横版名片",scaleLabel:"3:2",scaleValue:"512x341",width:40,height:30}]});return w.value="512x512",(e,a)=>{const h=m,v=n,b=d(p("u-form-item"),X);return t(),l(h,{class:"mt-4"},{default:s((()=>[o(K,{title:"图片尺寸",tips:"指定生成图像的宽高比",required:""}),o(b,{prop:"size"},{default:s((()=>[o(h,{class:"flex-1 bg-white rounded-lg py-[20rpx] pr-[20rpx] overflow-hidden"},{default:s((()=>[o(v,{class:"flex-1 min-w-0 whitespace-nowrap","scroll-x":""},{default:s((()=>[(t(!0),i(r,null,u(y.lists,((e,a)=>(t(),l(h,{key:a,class:"inline-block w-[140rpx] ml-[20rpx]"},{default:s((()=>[o(h,{class:c(["picture-size text-center hover:text-primary",{"picture-size-active":f(w)==(null==e?void 0:e.scaleValue)}]),onClick:a=>w.value=e.scaleValue},{default:s((()=>[o(h,{class:"flex justify-center items-center h-[40rpx]"},{default:s((()=>[o(h,{class:"rect",style:_({width:`${e.width}rpx`,height:`${e.height}rpx`})},null,8,["style"])])),_:2},1024),o(h,{class:"text-[#101010] font-medium mt-[8rpx] size-scale"},{default:s((()=>[x(g(e.scaleLabel),1)])),_:2},1024),o(h,{class:"text-[#808D9C] mt-[8rpx] text-xs size-scale"},{default:s((()=>[x(g(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-8609e4a9"]]),te=e({__name:"doubao-model",props:{modelValue:{default:""},engine:{default:{anime:{},general:{}}},draw_type:{default:"txt2txt"}},emits:["update:modelValue","changeCate"],setup(e,{emit:a}){const n=e,{modelValue:c}=N(n,a),_=h("general");return v((()=>n.draw_type),(()=>{var e,a;c.value=null==(a=null==(e=null==n?void 0:n.engine)?void 0:e[_.value])?void 0:a[n.draw_type]}),{immediate:!1}),(a,h)=>{const v=d(p("u-image"),Q),y=m,b=d(p("u-icon"),E),V=d(p("u-form-item"),X);return t(),l(y,{class:"mt-4"},{default:s((()=>[o(K,{title:"模型选择",tips:"让AI根据此模型的风格绘制图片，修改合适的描述词和参数可以让生成效果更加精美",required:""}),o(V,{label:""},{default:s((()=>[o(y,{class:"flex-1 min-w-0 pt-[20rpx] px-[20rpx] bg-white rounded-lg overflow-hidden"},{default:s((()=>[o(y,{class:"flex flex-wrap"},{default:s((()=>[(t(!0),i(r,null,u(e.engine||[],((a,i)=>(t(),l(y,{key:a.icon,class:"w-[50%] px-[10rpx]"},{default:s((()=>[o(y,{class:"h-full",onClick:e=>((e,a)=>{c.value=e[n.draw_type],_.value=a})(a,i)},{default:s((()=>[o(y,{class:"pt-[60%] relative h-0 rounded-[10rpx] overflow-hidden"},{default:s((()=>[o(y,{class:"absolute inset-0 left-0 top-0"},{default:s((()=>[o(v,{src:a.icon,class:"h-full w-full",width:"100%",height:"188",mode:"widthFix"},null,8,["src"])])),_:2},1024),a[e.draw_type]===f(c)?(t(),l(y,{key:0,class:"absolute bg-[rgba(0,0,0,0.5)] inset-0 left-0 top-0 flex items-center justify-center text-white"},{default:s((()=>[o(b,{name:"checkmark-circle-fill",size:40})])),_:1})):w("v-if",!0)])),_:2},1024),o(y,{class:"text-center text-xs line-clamp-1"},{default:s((()=>[x(g(a.title),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})])),_:1})}}}),le=Z(e({__name:"doubao-options",props:{modelValue:{default:()=>{}}},emits:["update:modelValue"],setup(e,{emit:a}){const i=e,u=h(!0),{modelValue:r}=N(i,a),n=e=>{const a=parseFloat(e.target.value);r.value.ddim_steps=a>=50?50:a<1?1:a};return(e,a)=>{const i=d(p("app-slider"),W),c=m,_=y,x=d(p("u-collapse-item"),Y),g=d(p("u-collapse"),ee);return t(),l(g,null,{default:s((()=>[(t(),l(x,{title:"高级参数",key:"index",open:u.value},{default:s((()=>[o(c,{class:"flex-1 min-w-0 p-[20rpx] bg-white rounded-lg"},{default:s((()=>[w(" 参考图权重 "),o(c,{class:"text-base text-main"},{default:s((()=>[o(K,{title:"绘画质量",tips:"越低：细节简练；越高：细节丰, 默认值20","font-weight":"400"}),o(c,{class:"flex items-center justify-between mt-[10rpx]"},{default:s((()=>[o(c,{class:"w-[480rpx]"},{default:s((()=>[o(i,{step:1,min:1,max:50,showValue:!1,activeColor:e.$theme.primaryColor,modelValue:f(r).ddim_steps,"onUpdate:modelValue":a[0]||(a[0]=e=>f(r).ddim_steps=e)},null,8,["activeColor","modelValue"])])),_:1}),o(_,{class:"options-input",type:"number",step:1,min:1,max:50,style:{width:"80rpx"},modelValue:f(r).ddim_steps,"onUpdate:modelValue":a[1]||(a[1]=e=>f(r).ddim_steps=e),onBlur:n},null,8,["modelValue"])])),_:1})])),_:1}),w(" 随机种子 "),o(c,{class:"text-base text-main mt-2"},{default:s((()=>[o(K,{title:"随机种子",tips:"种子用于指定生成效果，可以用于生成套图，保障生成的一系列图片保持同一种风格","font-weight":"400"}),o(c,{class:"flex-1 mt-[10rpx]"},{default:s((()=>[o(_,{class:"options-input",type:"number",modelValue:f(r).seed,"onUpdate:modelValue":a[2]||(a[2]=e=>f(r).seed=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1},8,["open"]))])),_:1})}}}),[["__scopeId","data-v-2270c7ec"]]),se=Z(e({__name:"doubao",setup(e){const _=O(),v=z(),y=b(),K=V(),X=j(),N=h([{mode:M.TEXT,name:"文生图"},{mode:M.IMAGE,name:"图生图"}]),Z=h({draw_api:P.DOUBAO,draw_type:M.TEXT,draw_model:P.DOUBAO,size:"512x512",engine:"high_aes_general_v20_L",prompt:"",negative_prompt:"",action:"generate",image_mask:"",image_id:"",complex_params:{seed:"",ddim_steps:20}}),Q=a({config:{engine:{anime:{},general:{}},is_member:!1,power:""}}),W=C((async()=>{Q.config=await H({draw_api:P.DOUBAO}),A({title:Q.config.diy_name})})),{lockFn:Y,isLock:ee}=G((async e=>{try{if(e&&(Z.value.action=e),""===Z.value.prompt)return uni.$u.toast("请输入提示词");await J({...Z.value}),Z.value.prompt="",_.navigateTo({path:"/packages/pages/draw_list/draw_list",query:{model:P.DOUBAO}})}catch(a){}}));return W(),k((()=>{U("drawRegenerate",(e=>{Object.assign(Z.value,e),"generate"!==e.action&&Y(e.action)}));const e=v.query;try{const a=JSON.parse(e.data);Object.assign(Z.value,a),"generate"!==a.action&&Y(a.action)}catch(a){}})),(e,a)=>{const _=d(p("page-meta"),D),h=d(p("u-empty"),T),v=d(p("tabbar"),B),b=m,V=d(p("u-icon"),E),j=d(p("router-navigate"),q),k=d(p("u-navbar"),F),U=d(p("u-form"),I),O=n,z=L,C=d(p("u-button"),$);return t(),i(r,null,[o(_,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),o(b,{class:"h-full flex flex-col bg-[#f5f8fd]"},{default:s((()=>[f(K).config.switch.doubao_status?(t(),i(r,{key:1},[o(k,{"back-text":"绘画工作台"},{right:s((()=>[o(j,{to:{path:"/packages/pages/draw_list/draw_list",query:{model:f(P).DOUBAO}}},{default:s((()=>[o(b,{class:"flex items-center mr-[20rpx]"},{default:s((()=>[o(b,{class:"text-primary flex"},{default:s((()=>[o(V,{name:"clock",size:32})])),_:1}),o(b,{class:"text-muted ml-[10rpx]"},{default:s((()=>[x("历史记录")])),_:1})])),_:1})])),_:1},8,["to"])])),_:1}),o(b,{class:"p-[20rpx]"},{default:s((()=>[o(b,{class:"flex p-[14rpx] bg-white rounded-full"},{default:s((()=>[(t(!0),i(r,null,u(N.value,(e=>(t(),l(b,{key:e.mode,class:c(["flex items-center px-[10rpx] py-[5rpx] flex-1 justify-center text-primary rounded-full",{"!bg-primary !text-white":Z.value.draw_type===e.mode}]),onClick:a=>Z.value.draw_type=e.mode},{default:s((()=>[o(b,{class:"leading-[30px]"},{default:s((()=>[x(g(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),o(b,{class:"flex-1 min-h-0"},{default:s((()=>[o(O,{class:"h-full","scroll-y":""},{default:s((()=>[o(b,{class:"px-[20rpx] pb-[30rpx] pt-[6rpx]"},{default:s((()=>[o(U,{ref_key:"uFormRef",ref:y,model:Z.value,"label-position":"top","border-bottom":!1},{default:s((()=>[w("    关键词    "),o(R,{modelValue:Z.value.prompt,"onUpdate:modelValue":a[0]||(a[0]=e=>Z.value.prompt=e),negative:Z.value.negative_prompt,"onUpdate:negative":a[1]||(a[1]=e=>Z.value.negative_prompt=e),"is-negative":!1,model:f(P).DOUBAO,example:Q.example,typeEnum:f(M),showTranslate:!!Q.config.translate_switch},null,8,["modelValue","negative","model","example","typeEnum","showTranslate"]),w("    图片上传    "),Z.value.draw_type===f(M).IMAGE?(t(),l(S,{key:0,modelValue:Z.value.image_mask,"onUpdate:modelValue":a[2]||(a[2]=e=>Z.value.image_mask=e)},null,8,["modelValue"])):w("v-if",!0),w("    图片尺寸    "),o(ae,{modelValue:Z.value.size,"onUpdate:modelValue":a[3]||(a[3]=e=>Z.value.size=e)},null,8,["modelValue"]),w(" 绘画模型 "),o(te,{modelValue:Z.value.engine,"onUpdate:modelValue":a[4]||(a[4]=e=>Z.value.engine=e),engine:Q.config.engine,draw_type:Z.value.draw_type},null,8,["modelValue","engine","draw_type"]),w(" 高级参数 "),o(le,{modelValue:Z.value.complex_params,"onUpdate:modelValue":a[5]||(a[5]=e=>Z.value.complex_params=e)},null,8,["modelValue"])])),_:1},8,["model"])])),_:1})])),_:1})])),_:1}),o(b,{class:"p-[20rpx] bg-white safe-area-inset-bottom"},{default:s((()=>[o(C,{type:"primary",loading:f(ee),onClick:a[6]||(a[6]=e=>f(Y)("generate"))},{default:s((()=>[o(b,null,{default:s((()=>[o(z,{class:"text-xl font-bold"},{default:s((()=>[x("立即生成")])),_:1}),Q.config.is_member?(t(),l(z,{key:0,class:"text-sm ml-[4px]"},{default:s((()=>[x(" 会员免费 ")])),_:1})):w("v-if",!0),0!=Q.config.power&&!Q.config.is_member&&f(X).isLogin?(t(),l(z,{key:1,class:"text-sm ml-[4px]"},{default:s((()=>[x(" 消耗"+g(Q.config.power||"--")+g(f(K).getTokenUnit),1)])),_:1})):w("v-if",!0)])),_:1})])),_:1},8,["loading"])])),_:1})],64)):(t(),l(b,{key:0,class:"w-full h-full bg-white rounded-[6px] flex items-center justify-center"},{default:s((()=>[o(h,{text:"绘画功能未开启",mode:"favor"}),o(v)])),_:1})),o(v)])),_:1})],64)}}}),[["__scopeId","data-v-6158d434"]]);export{se as default};
