import{d as e,u as a,K as t,s as l,J as s,$ as o,o as r,k as i,b as m,w as p,aH as n,aI as u,f as c,t as d,c as f,g as x,F as _,l as y,z as j,aU as w,U as g,r as v,a as h,j as k,i as b,D as V,e as C,aw as z}from"./index-d6d2a33a.js";import{_ as R}from"./page-meta.d751427a.js";import{_ as U}from"./u-image.9574760c.js";import{_ as $}from"./z-paging.6c8c2edf.js";import{_ as I}from"./u-popup.21776ef7.js";import{_ as D}from"./create_record.3474bfb9.js";import{b as F}from"./create.07ec191c.js";import{u as H}from"./useCopy.4954d67d.js";import{C as O}from"./creation-history-item.2073a254.js";import{F as T}from"./floating-menu.85d77f2f.js";import{e as B,f as J,k as K}from"./chat.d9a8f946.js";import"./_plugin-vue_export-helper.1b428a4d.js";import"./u-icon.992584aa.js";import"./u-tag.fd761889.js";import"./u-read-more.48be6c35.js";import"./u-loading.d153dd1a.js";import"./text-item.bd4ac6fd.js";import"./ua-markdown.e9ea1a15.js";import"./_commonjsHelpers.157f59fb.js";import"./katex.37f36714.js";import"./mp-html.318bb55d.js";import"./index.ccff8ee2.js";import"./icon_copy.36709540.js";import"./howler.bdae6f69.js";import"./index.3dd6f2ef.js";import"./index.22b2ad12.js";const N=e({__name:"create_history",setup(e){const{copy:N}=H(),P=a(),Q=j(),S=t({id:0,type:2}),W=l({}),q=l(!1),A=t({title:"",text:""}),E=l([]),G=s(),L=async(e,a)=>{var t;const l=(await B({other_id:S.id,type:S.type,page_no:e,page_size:a})).lists.map((e=>{let a="";if(w(e.ask)){const t=(null==e?void 0:e.ask[0])||{};a=`${t.title}：${t.value}`}else a=e.ask;return{...e,title:a}}));null==(t=G.value)||t.complete(l)},M=async()=>{var e;(await g({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).cancel||(await J({type:S.type,other_id:S.id}),null==(e=G.value)||e.reload())},X=async e=>{var a;try{(await g({title:"温馨提示",content:"删除的记录无法恢复，确定？"})).confirm&&await K({id:e}),null==(a=G.value)||a.refresh()}catch(t){}};return o((async e=>{var a;S.id=Number(null==e?void 0:e.id),await(async()=>{const e=await F({id:S.id});W.value=e})(),null==(a=G.value)||a.reload(!0)})),(e,a)=>{const t=v(h("page-meta"),R),l=v(h("u-image"),U),s=k,o=b,j=v(h("z-paging"),$),w=V,g=v(h("u-popup"),I);return r(),i(_,null,[m(t,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),m(j,{ref_key:"pagingRef",ref:G,auto:!1,modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=e=>E.value=e),"auto-show-back-to-top":"",onQuery:L},{top:p((()=>[n(m(s,{class:"flex items-center p-[20rpx]"},{default:p((()=>[m(l,{src:W.value.image,width:"42",height:"42"},null,8,["src"]),m(s,{class:"flex-1 min-w-0 text-xl font-medium line-clamp-1 mx-[20rpx]"},{default:p((()=>[c(d(W.value.name),1)])),_:1}),E.value.length?(r(),f(s,{key:0,class:"text-sm",onClick:M},{default:p((()=>[c(" 清空记录 ")])),_:1})):x("v-if",!0)])),_:1},512),[[u,W.value.name]])])),empty:p((()=>[m(s,{class:"flex flex-col justify-center items-center pb-[300rpx]"},{default:p((()=>[m(o,{class:"w-[300rpx] h-[300rpx]",src:D,alt:""}),m(s,{class:"my-[32rpx] text-muted"},{default:p((()=>[c(" 暂无数据～ ")])),_:1})])),_:1})])),default:p((()=>[m(s,{class:"px-[20rpx]"},{default:p((()=>[(r(!0),i(_,null,y(E.value,(e=>(r(),f(s,{key:e.id},{default:p((()=>[(r(!0),i(_,null,y(e.reply,((a,t)=>(r(),f(s,{class:"mt-[20rpx]",key:t},{default:p((()=>[m(O,{title:e.title,time:e.create_time,content:a,index:t,overflow:!0,"record-id":e.id,"show-rewrite":e.extra,showVoice:C(P).getIsVoiceOpen,"model-name":e.model,onDelete:X,onCopy:C(N),onClickTitle:a=>((e,a)=>{A.text=e,A.title=a,q.value=!0})(a,e.title),onRewrite:a=>(async e=>{await Q.navigateBack(),z("createRewrite",e.extra)})(e)},null,8,["title","time","content","index","record-id","show-rewrite","showVoice","model-name","onCopy","onClickTitle","onRewrite"])])),_:2},1024)))),128))])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue"]),m(g,{modelValue:q.value,"onUpdate:modelValue":a[1]||(a[1]=e=>q.value=e),mode:"bottom","border-radius":"14",closeable:""},{default:p((()=>[m(s,{class:"h-[85vh] flex flex-col"},{default:p((()=>[m(s,{class:"p-[30rpx] pr-[60rpx] text-xl font-medium border-0 border-b border-light border-solid"},{default:p((()=>[m(s,{class:"line-clamp-1"},{default:p((()=>[c(" 标题详情 ")])),_:1})])),_:1}),m(s,{class:"flex-1 min-h-0"},{default:p((()=>[m(w,{class:"h-full","scroll-y":""},{default:p((()=>[m(s,{class:"p-[30rpx]"},{default:p((()=>[m(s,{class:"flex-1 min-w-0 text-lg whitespace-pre-wrap"},{default:p((()=>[c(d(A.title),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),x("    悬浮菜单    "),m(T)],64)}}});export{N as default};
