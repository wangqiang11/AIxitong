import{d as e,J as t,s as a,o as l,c as s,w as r,b as i,e as u,p as o,B as f,f as c,t as d,g as m,i as n,r as p,a as x,j as _,h as g,b7 as h}from"./index-d6d2a33a.js";import{_ as y}from"./u-icon.992584aa.js";import{_ as j}from"./u-loading.d153dd1a.js";import{_ as b}from"./uni-file-picker.87d7f36a.js";import{_ as v}from"./u-form-item.36bcbf1f.js";import{_ as k}from"./image-uploader.b31ee9fb.js";import{a as w}from"./index.3dd6f2ef.js";import{u as F}from"./useLockFn.3b1f86f9.js";import{_ as P}from"./_plugin-vue_export-helper.1b428a4d.js";const z=P(e({__name:"uploader-picture",props:{modelValue:{default:""},type:{default:"image"}},emits:["update:modelValue"],setup(e,{emit:P}){const z=e,{modelValue:B}=w(z,P),G=t(),J=a({}),{lockFn:M,isLock:V}=F((async e=>{var t;null==(t=G.value)||t.clearFiles();const[a]=e.tempFiles;if(!a)return uni.$u.toast("文件不存在");if(a.size>10485760)uni.$u.toast("文件大小不能超过10MB");else try{const e=await h(z.type,{filePath:a.url,name:"file"});B.value=e.uri,J.value=a}catch(l){uni.$u.toast(l)}}));return(e,t)=>{const a=n,h=p(x("u-icon"),y),w=_,F=g,P=p(x("u-loading"),j),z=p(x("uni-file-picker"),b),$=p(x("u-form-item"),v);return l(),s($,{prop:"image",label:"上传参考图",required:""},{default:r((()=>[i(w,{class:"flex-1 leading-snug"},{default:r((()=>[i(z,{ref_key:"filePickerRef",ref:G,limit:"1",fileMediatype:"image",onSelect:u(M),mode:"list","list-styles":{display:"none"},"auto-upload":!1},{default:r((()=>[i(w,{class:"bg-white rounded-[7rpx] h-[300rpx] border-light border border-dashed relative overflow-hidden"},{default:r((()=>[u(B)?(l(),s(w,{key:0,class:"flex justify-center items-center relative h-full"},{default:r((()=>[i(a,{class:"w-full h-[100%]",src:J.value.url||u(B),mode:"aspectFit"},null,8,["src"]),i(w,{class:"!absolute right-0 top-0 z-10 text-muted",onClick:t[0]||(t[0]=o((e=>B.value=""),["stop"]))},{default:r((()=>[i(h,{name:"close-circle-fill",size:50})])),_:1})])),_:1})):(l(),s(w,{key:1,class:"uploader-container flex justify-center items-center flex-col h-full"},{default:r((()=>[f("img",{src:k,alt:"文件上传",class:"w-[80rpx] h-[80rpx] mx-auto mb-2"}),i(w,{class:"text-[#798696] !text-[13px]"},{default:r((()=>[i(F,{class:"text-primary"},{default:r((()=>[c("点击上传")])),_:1})])),_:1}),i(w,{class:"text-[#798696] !text-[13px] mt-[10rpx]"},{default:r((()=>[c(d("支持图片格式：JPG/JPEG/PNG，低于10MB"),1)])),_:1})])),_:1})),u(V)?(l(),s(w,{key:2,class:"absolute top-0 left-0 w-full h-full bg-[rgba(0,0,0,0.5)] flex flex-col items-center justify-center"},{default:r((()=>[i(w,null,{default:r((()=>[i(P,{size:"40",mode:"circle"})])),_:1}),i(F,{class:"text-white mt-[10rpx]"},{default:r((()=>[c(" 上传中... ")])),_:1})])),_:1})):m("v-if",!0)])),_:1})])),_:1},8,["onSelect"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-4c87dd36"]]);export{z as U};
