var e,t,l,a,o,s,i,n;import{o as r,c as u,w as c,b as d,n as m,f as p,t as f,g as h,m as y,p as v,h as _,j as g,r as x,a as b,k,F as C,l as S,bE as w,bF as $,O as I,a8 as T,d as V,A as z,C as j,s as N,e as B,P as L,z as P,q as M,S as R,J as O,B as H,i as U,b7 as F,cB as G,aY as q,aZ as W,u as A,K,$ as E,bo as J,ae as D,D as Z}from"./index-d6d2a33a.js";import{_ as X}from"./page-meta.d751427a.js";import{_ as Y}from"./u-icon.992584aa.js";import{_ as Q}from"./router-navigate.18e98059.js";import{_ as ee}from"./u-navbar.d70905ec.js";import{m as te,a as le,t as ae}from"./mixin.91a2f735.js";import{_ as oe}from"./_plugin-vue_export-helper.1b428a4d.js";import{b as se,_ as ie,a as ne}from"./uv-popup.0236847c.js";import{_ as re}from"./u-form.f207500c.js";import{_ as ue}from"./u-button.97a3d07f.js";import{_ as ce}from"./u-empty.a728d8d9.js";import{_ as de}from"./tabbar.vue_vue_type_script_setup_true_lang.e2e30d1a.js";import{t as me,g as pe,p as fe}from"./video.0bbf10d1.js";import{u as he}from"./useLockFn.3b1f86f9.js";import{_ as ye}from"./u-loading.d153dd1a.js";import{_ as ve}from"./l-textarea.9d4b6972.js";import{_ as _e}from"./u-form-item.36bcbf1f.js";import{a as ge}from"./index.3dd6f2ef.js";import{_ as xe}from"./u-image.9574760c.js";import{_ as be}from"./uni-file-picker.87d7f36a.js";import{_ as ke}from"./image-uploader.b31ee9fb.js";import"./u-badge.f9b9ebb9.js";import"./emitter.1571a5d9.js";import"./index.22b2ad12.js";const Ce=oe({name:"uv-toolbar",emits:["confirm","cancel"],mixins:[te,le,{props:{show:{type:Boolean,default:!0},showBorder:{type:Boolean,default:!1},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},title:{type:String,default:""},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.toolbar}}],methods:{cancel(){this.$emit("cancel")},confirm(){this.$emit("confirm")}}},[["render",function(e,t,l,a,o,s){const i=_,n=g;return e.show?(r(),u(n,{key:0,class:y(["uv-toolbar",{"uv-border-bottom":e.showBorder}]),onTouchmove:v(e.noop,["stop","prevent"])},{default:c((()=>[d(n,{class:"uv-toolbar__cancel__wrapper","hover-class":"uv-hover-class"},{default:c((()=>[d(i,{class:"uv-toolbar__wrapper__cancel",onClick:s.cancel,style:m({color:e.cancelColor})},{default:c((()=>[p(f(e.cancelText),1)])),_:1},8,["onClick","style"])])),_:1}),e.title?(r(),u(i,{key:0,class:"uv-toolbar__title uv-line-1"},{default:c((()=>[p(f(e.title),1)])),_:1})):h("v-if",!0),d(n,{class:"uv-toolbar__confirm__wrapper","hover-class":"uv-hover-class"},{default:c((()=>[d(i,{class:"uv-toolbar__wrapper__confirm",onClick:s.confirm,style:m({color:e.confirmColor})},{default:c((()=>[p(f(e.confirmText),1)])),_:1},8,["onClick","style"])])),_:1})])),_:1},8,["class","onTouchmove"])):h("v-if",!0)}],["__scopeId","data-v-420ab05f"]]);const Se=oe({name:"uv-picker",emits:["confirm","cancel","close","change"],mixins:[te,le,{props:{showToolbar:{type:Boolean,default:!0},title:{type:String,default:""},round:{type:[String,Number],default:0},columns:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},itemHeight:{type:[String,Number],default:44},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确定"},cancelColor:{type:String,default:"#909193"},confirmColor:{type:String,default:"#3c9cff"},color:{type:String,default:""},activeColor:{type:String,default:""},visibleItemCount:{type:[String,Number],default:5},keyName:{type:String,default:"text"},closeOnClickOverlay:{type:Boolean,default:!0},closeOnClickConfirm:{type:Boolean,default:!0},defaultIndex:{type:Array,default:()=>[]},immediateChange:{type:Boolean,default:!0},...null==(a=null==(l=uni.$uv)?void 0:l.props)?void 0:a.picker}}],computed:{textStyle(){return(e,t)=>{const l={display:"block"};return this.color&&(l.color=this.color),this.activeColor&&t===this.innerIndex[e]&&(l.color=this.activeColor),l}}},data:()=>({lastIndex:[],innerIndex:[],innerColumns:[],columnIndex:0}),watch:{defaultIndex:{immediate:!0,handler(e){this.setIndexs(e,!0)}},columns:{deep:!0,immediate:!0,handler(e){this.setColumns(e)}}},methods:{open(){this.$refs.pickerPopup.open()},close(){this.$refs.pickerPopup.close()},popupChange(e){e.show||this.$emit("close")},getItemText(e){return this.$uv.test.object(e)?e[this.keyName]:e},cancel(){this.$emit("cancel"),this.close()},confirm(){this.$emit("confirm",this.$uv.deepClone({indexs:this.innerIndex,value:this.innerColumns.map(((e,t)=>e[this.innerIndex[t]])),values:this.innerColumns})),this.closeOnClickConfirm&&this.close()},changeHandler(e){const{value:t}=e.detail;let l=0,a=0;for(let s=0;s<t.length;s++){let e=t[s];if(e!==(this.lastIndex[s]||0)){a=s,l=e;break}}this.columnIndex=a;const o=this.innerColumns;this.setLastIndex(t),this.setIndexs(t),this.$emit("change",{value:this.innerColumns.map(((e,l)=>e[t[l]])),index:l,indexs:t,values:o,columnIndex:a})},setIndexs(e,t){this.innerIndex=this.$uv.deepClone(e),t&&this.setLastIndex(e)},setLastIndex(e){this.lastIndex=this.$uv.deepClone(e)},setColumnValues(e,t){this.innerColumns.splice(e,1,t);let l=this.$uv.deepClone(this.innerIndex);for(let a=0;a<this.innerColumns.length;a++)a>this.columnIndex&&(l[a]=0);this.setIndexs(l)},getColumnValues(e){return(async()=>{await this.$uv.sleep()})(),this.innerColumns[e]},setColumns(e){this.innerColumns=this.$uv.deepClone(e),0===this.innerIndex.length&&(this.innerIndex=new Array(e.length).fill(0))},getIndexs(){return this.innerIndex},getValues(){return(async()=>{await this.$uv.sleep()})(),this.innerColumns.map(((e,t)=>e[this.innerIndex[t]]))}}},[["render",function(e,t,l,a,o,s){const i=x(b("uv-toolbar"),Ce),n=_,y=w,v=$,I=x(b("uv-loading-icon"),se),T=g,V=x(b("uv-popup"),ie);return r(),u(V,{ref:"pickerPopup",mode:"bottom",round:e.round,"close-on-click-overlay":e.closeOnClickOverlay,onChange:s.popupChange},{default:c((()=>[d(T,{class:"uv-picker"},{default:c((()=>[e.showToolbar?(r(),u(i,{key:0,cancelColor:e.cancelColor,confirmColor:e.confirmColor,cancelText:e.cancelText,confirmText:e.confirmText,title:e.title,onCancel:s.cancel,onConfirm:s.confirm},null,8,["cancelColor","confirmColor","cancelText","confirmText","title","onCancel","onConfirm"])):h("v-if",!0),d(v,{class:"uv-picker__view",indicatorStyle:`height: ${e.$uv.addUnit(e.itemHeight)}`,value:o.innerIndex,immediateChange:e.immediateChange,style:m({height:`${e.$uv.addUnit(e.visibleItemCount*e.itemHeight)}`}),onChange:s.changeHandler},{default:c((()=>[h(" @pickend在这里为了解决抖音等滚到底不触发change兼容性问题 "),(r(!0),k(C,null,S(o.innerColumns,((t,l)=>(r(),u(y,{key:l,class:"uv-picker__view__column"},{default:c((()=>[e.$uv.test.array(t)?(r(!0),k(C,{key:0},S(t,((t,a)=>(r(),u(n,{class:"uv-picker__view__column__item uv-line-1",key:a,style:m([{height:e.$uv.addUnit(e.itemHeight),lineHeight:e.$uv.addUnit(e.itemHeight),fontWeight:a===o.innerIndex[l]?"bold":"normal"},s.textStyle(l,a)])},{default:c((()=>[p(f(s.getItemText(t)),1)])),_:2},1032,["style"])))),128)):h("v-if",!0)])),_:2},1024)))),128))])),_:1},8,["indicatorStyle","value","immediateChange","style","onChange"]),e.loading?(r(),u(T,{key:1,class:"uv-picker--loading"},{default:c((()=>[d(I,{mode:"circle"})])),_:1})):h("v-if",!0)])),_:1})])),_:1},8,["round","close-on-click-overlay","onChange"])}],["__scopeId","data-v-e9c224c2"]]);const we=oe({name:"uv-button",mixins:[te,le,{props:{hairline:{type:Boolean,default:!0},type:{type:String,default:"info"},size:{type:String,default:"normal"},shape:{type:String,default:"square"},plain:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingText:{type:[String,Number],default:""},loadingMode:{type:String,default:"spinner"},loadingSize:{type:[String,Number],default:14},openType:{type:String,default:""},formType:{type:String,default:""},appParameter:{type:String,default:""},hoverStopPropagation:{type:Boolean,default:!0},lang:{type:String,default:"en"},sessionFrom:{type:String,default:""},sendMessageTitle:{type:String,default:""},sendMessagePath:{type:String,default:""},sendMessageImg:{type:String,default:""},showMessageCard:{type:Boolean,default:!0},dataName:{type:String,default:""},throttleTime:{type:[String,Number],default:0},hoverStartTime:{type:[String,Number],default:0},hoverStayTime:{type:[String,Number],default:200},text:{type:[String,Number],default:""},icon:{type:String,default:""},iconSize:{type:[String,Number],default:""},iconColor:{type:String,default:"#000000"},color:{type:String,default:""},customTextStyle:{type:[Object,String],default:""},...null==(s=null==(o=uni.$uv)?void 0:o.props)?void 0:s.button}}],emits:["click"],data:()=>({}),computed:{bemClass(){return this.color?this.bem("button",["shape","size"],["disabled","plain","hairline"]):this.bem("button",["type","shape","size"],["disabled","plain","hairline"])},loadingColor(){return this.plain?this.color?this.color:"#3c9cff":"info"===this.type?"#c9c9c9":"rgb(200, 200, 200)"},iconColorCom(){return this.iconColor?this.iconColor:this.plain?this.color?this.color:this.type:"info"===this.type?"#000000":"#ffffff"},baseColor(){let e={};return this.color&&(e.color=this.plain?this.color:"white",this.plain||(e["background-color"]=this.color),-1!==this.color.indexOf("gradient")?(e.borderTopWidth=0,e.borderRightWidth=0,e.borderBottomWidth=0,e.borderLeftWidth=0,this.plain||(e.backgroundImage=this.color)):(e.borderColor=this.color,e.borderWidth="1px",e.borderStyle="solid")),e},nvueTextStyle(){let e={};return"info"===this.type&&(e.color="#323233"),this.color&&(e.color=this.plain?this.color:"white"),e.fontSize=this.textSize+"px",e},textSize(){let e=14,{size:t}=this;return"large"===t&&(e=16),"normal"===t&&(e=14),"small"===t&&(e=12),"mini"===t&&(e=10),e},getIconSize(){const e=this.iconSize?this.iconSize:1.35*this.textSize;return this.$uv.addUnit(e)},btnWrapperStyle(){const e={},t=this.$uv.addStyle(this.customStyle);return t.width&&(e.width=t.width),e}},methods:{clickHandler(){this.disabled||this.loading||ae((()=>{this.$emit("click")}),this.throttleTime)}}},[["render",function(e,t,l,a,o,s){const i=x(b("uv-loading-icon"),se),n=_,v=x(b("uv-icon"),ne),S=T,w=g;return r(),u(w,{class:"uv-button-wrapper",style:m([s.btnWrapperStyle])},{default:c((()=>[d(S,{"hover-start-time":Number(e.hoverStartTime),"hover-stay-time":Number(e.hoverStayTime),"form-type":e.formType,"open-type":e.openType,"app-parameter":e.appParameter,"hover-stop-propagation":e.hoverStopPropagation,"send-message-title":e.sendMessageTitle,"send-message-path":e.sendMessagePath,lang:e.lang,"data-name":e.dataName,"session-from":e.sessionFrom,"send-message-img":e.sendMessageImg,"show-message-card":e.showMessageCard,"hover-class":e.disabled||e.loading?"":"uv-button--active",class:y(["uv-button uv-reset-button",s.bemClass]),style:m([s.baseColor,e.$uv.addStyle(e.customStyle)]),onClick:s.clickHandler},{default:c((()=>[e.loading?(r(),k(C,{key:0},[d(i,{mode:e.loadingMode,size:1.15*e.loadingSize,color:s.loadingColor},null,8,["mode","size","color"]),d(n,{class:"uv-button__loading-text",style:m([{fontSize:s.textSize+"px"},e.$uv.addStyle(e.customTextStyle)])},{default:c((()=>[p(f(e.loadingText||e.text),1)])),_:1},8,["style"])],64)):(r(),k(C,{key:1},[e.icon?(r(),u(v,{key:0,name:e.icon,color:s.iconColorCom,size:s.getIconSize,customStyle:{marginRight:"2px"}},null,8,["name","color","size"])):h("v-if",!0),I(e.$slots,"default",{},(()=>[d(n,{class:"uv-button__text",style:m([{fontSize:s.textSize+"px"},e.$uv.addStyle(e.customTextStyle)])},{default:c((()=>[p(f(e.text),1)])),_:1},8,["style"])]),!0),I(e.$slots,"suffix",{},void 0,!0)],64))])),_:3},8,["hover-start-time","hover-stay-time","form-type","open-type","app-parameter","hover-stop-propagation","send-message-title","send-message-path","lang","data-name","session-from","send-message-img","show-message-card","hover-class","style","onClick","class"])])),_:3},8,["style"])}],["__scopeId","data-v-9f3ef67a"]]);const $e=oe({name:"uv-subsection",mixins:[te,le,{props:{list:{type:Array,default:()=>[]},current:{type:[String,Number],default:0},activeColor:{type:String,default:"#3c9cff"},inactiveColor:{type:String,default:"#303133"},mode:{type:String,default:"button"},fontSize:{type:[String,Number],default:12},bold:{type:Boolean,default:!0},bgColor:{type:String,default:"#eeeeef"},keyName:{type:String,default:"name"},customItemStyle:{type:[String,Object],default:""},...null==(n=null==(i=uni.$uv)?void 0:i.props)?void 0:n.subsection}}],data:()=>({itemRect:{width:0,height:0}}),watch:{list:{deep:!0,handler(){this.init()}},current:{immediate:!0,handler(e){}}},computed:{wrapperStyle(){const e={};return"button"===this.mode&&(e.backgroundColor=this.bgColor),e},barStyle(){const e={};return e.width=`${this.itemRect.width}px`,e.height=`${this.itemRect.height}px`,e.transform=`translateX(${this.current*this.itemRect.width}px)`,"subsection"===this.mode&&(e.backgroundColor=this.activeColor),this.$uv.deepMerge(e,this.$uv.addStyle(this.customItemStyle))},itemStyle(e){return e=>{const t={};return"subsection"===this.mode&&(t.borderColor=this.activeColor,t.borderWidth="1px",t.borderStyle="solid"),t}},textStyle(e){return e=>{const t={};return t.fontWeight=this.bold&&this.current===e?"bold":"normal",t.fontSize=this.$uv.addUnit(this.fontSize),"subsection"===this.mode?t.color=this.current===e?"#fff":this.inactiveColor:t.color=this.current===e?this.activeColor:this.inactiveColor,t}}},mounted(){this.init()},methods:{init(){this.$uv.sleep().then((()=>this.getRect()))},getText(e){return"object"==typeof e?e[this.keyName]:e},getRect(){this.$uvGetRect(".uv-subsection__item--0").then((e=>{this.itemRect=e}))},clickHandler(e){this.$emit("change",e)}}},[["render",function(e,t,l,a,o,s){const i=g,n=_;return r(),u(i,{class:y(["uv-subsection",[`uv-subsection--${e.mode}`]]),ref:"uv-subsection",style:m([e.$uv.addStyle(e.customStyle),s.wrapperStyle])},{default:c((()=>[d(i,{class:y(["uv-subsection__bar",["button"===e.mode&&"uv-subsection--button__bar",0===e.current&&"subsection"===e.mode&&"uv-subsection__bar--first",e.current>0&&e.current<e.list.length-1&&"subsection"===e.mode&&"uv-subsection__bar--center",e.current===e.list.length-1&&"subsection"===e.mode&&"uv-subsection__bar--last"]]),ref:"uv-subsection__bar",style:m([s.barStyle])},null,8,["style","class"]),(r(!0),k(C,null,S(e.list,((t,l)=>(r(),u(i,{class:y(["uv-subsection__item",[`uv-subsection__item--${l}`,l<e.list.length-1&&"uv-subsection__item--no-border-right",0===l&&"uv-subsection__item--first",l===e.list.length-1&&"uv-subsection__item--last"]]),ref_for:!0,ref:`uv-subsection__item--${l}`,style:m([s.itemStyle(l)]),onClick:e=>s.clickHandler(l),key:l},{default:c((()=>[d(n,{class:"uv-subsection__item__text",style:m([s.textStyle(l)])},{default:c((()=>[p(f(s.getText(t)),1)])),_:2},1032,["style"])])),_:2},1032,["class","style","onClick"])))),128))])),_:1},8,["class","style"])}],["__scopeId","data-v-96ea80eb"]]),Ie=oe(V({__name:"prompt",props:{modelValue:{default:""},config:{default:()=>({})},showTranslate:{type:Boolean,default:!1},type:{default:1},label:null,placeholder:null},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,a=P(),o=z(),{modelValue:s}=ge(l,t),i=j((()=>1===l.type)),n={1:{label:"视频场景",placeholder:"在此描述你的视频场景，包含内容主体+动作/场景"},2:{label:"描述词",placeholder:"描述视频中需要变化的内容即可～"}},m=j((()=>n[l.type]||{})),f=N(-1),y=()=>{o.isLogin||a.navigateTo("/pages/login/login")},k=()=>{var e;const t=null==(e=l.config.data)?void 0:e.length;if(t){let e=Math.round(Math.random()*(t-1));f.value===e&&(e<t-1?e++:e--),e<0&&(e=0),f.value=e;const a=l.config.data[e];a&&(s.value=a)}},{lockFn:C,isLock:S}=he((async()=>{if(!s.value)return uni.$u.toast("请输入描述词");const e=await me({prompt:s.value});s.value=e.result}));return(t,a)=>{const o=x(b("u-icon"),Y),n=_,f=g,w=x(b("u-loading"),ye),$=x(b("l-textarea"),ve),I=x(b("u-form-item"),_e);return r(),u(I,{label:l.label??B(m).label,prop:"title",required:""},{default:c((()=>[d(f,{class:"flex-1 min-w-0"},{default:c((()=>[d($,{modelValue:B(s),"onUpdate:modelValue":a[1]||(a[1]=e=>L(s)?s.value=e:null),rows:4,"custom-class":{background:"#fff",paddingBottom:"70rpx",fontSize:"28rpx"},placeholder:l.placeholder??B(m).placeholder,onClick:y},{"length-suffix":c((()=>[d(f,{class:"flex length-suffix"},{default:c((()=>[d(f,{class:"flex-1 flex items-center"},{default:c((()=>[B(i)?(r(),u(f,{key:0,class:"inline-flex items-center text-primary mr-[10rpx]",onClick:v(k,["stop"])},{default:c((()=>[d(o,{name:"bookmark",size:"24"}),d(n,{class:"ml-[8rpx]"},{default:c((()=>[d(n,null,{default:c((()=>[p(" 试试示例 ")])),_:1})])),_:1})])),_:1},8,["onClick"])):h("v-if",!0),e.showTranslate?(r(),u(f,{key:1,class:"inline-flex items-center text-primary",onClick:v(B(C),["stop"])},{default:c((()=>[B(S)?(r(),u(w,{key:0,mode:"flower",size:"24"})):(r(),u(o,{key:1,name:"reload",size:"24"})),d(n,{class:"ml-[8rpx]"},{default:c((()=>[d(n,null,{default:c((()=>[p(" 翻译成英文 ")])),_:1})])),_:1})])),_:1},8,["onClick"])):h("v-if",!0)])),_:1}),d(f,{class:"flex items-center text-content text-xs ml-auto",onClick:a[0]||(a[0]=v((e=>s.value=""),["stop"]))},{default:c((()=>[d(o,{name:"trash"}),d(f,{class:"ml-[8rpx]"},{default:c((()=>[p(" 清空 ")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","placeholder"])])),_:1})])),_:1},8,["label"])}}}),[["__scopeId","data-v-db68860f"]]),Te=oe(V({__name:"video-size",props:{modelValue:{default:"1:1"},filters:{default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,{modelValue:a}=ge(l,t),o=j((()=>[{scaleValue:"1:1",width:40,height:40},{scaleValue:"3:4",width:30,height:40},{scaleValue:"4:3",width:40,height:30},{scaleValue:"9:16",width:24,height:40},{scaleValue:"16:9",width:40,height:24}].filter((e=>l.filters.includes(e.scaleValue)))));return(e,t)=>{const l=g,s=x(b("u-form-item"),_e);return r(),u(s,{prop:"scale",label:"生成尺寸",required:""},{default:c((()=>[d(l,{class:"flex-1 min-w-0 overflow-hidden"},{default:c((()=>[d(l,{class:"flex flex-wrap mx-[-12rpx]"},{default:c((()=>[(r(!0),k(C,null,S(B(o),((e,t)=>(r(),u(l,{key:t,class:"w-[33.3%] px-[12rpx]"},{default:c((()=>[d(l,{class:y(["picture-size cursor-pointer text-center hover:text-primary",{"picture-size-active":B(a)==(null==e?void 0:e.scaleValue),"picture-size-disable":!(null==e?void 0:e.scaleValue)}]),onClick:t=>a.value=e.scaleValue},{default:c((()=>[d(l,{class:"flex justify-center items-center h-[40rpx]"},{default:c((()=>[d(l,{class:"rect",style:m({width:`${e.width}rpx`,height:`${e.height}rpx`})},null,8,["style"])])),_:2},1024),d(l,{class:"text-[#101010] dark:text-white mt-[8rpx] size-scale"},{default:c((()=>[p(f(e.scaleValue),1)])),_:2},1024)])),_:2},1032,["class","onClick"])])),_:2},1024)))),128))])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-59b935ee"]]),Ve=V({__name:"video-style",props:{modelValue:{default:()=>[]},styleList:null},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,{modelValue:a}=ge(l,t),o=N(8),s=e=>l.styleList.slice(o.value*e,o.value*(e+1)),i=j((()=>Math.ceil(l.styleList.length/o.value)));return(e,t)=>{const l=x(b("u-image"),xe),o=g,n=x(b("u-icon"),Y),m=R,y=M,v=x(b("u-form-item"),_e);return r(),u(v,{label:"选择风格"},{default:c((()=>[d(o,{class:"flex-1 min-w-0 bg-white rounded-[16rpx]"},{default:c((()=>[d(y,{class:"h-[520rpx]",circular:"","indicator-dots":B(i)>1,"indicator-active-color":e.$theme.primaryColor},{default:c((()=>[(r(!0),k(C,null,S(B(i),((e,t)=>(r(),u(m,{key:t},{default:c((()=>[d(o,{class:"flex flex-wrap px-[20rpx] pt-[20rpx] mx-[-10rpx]"},{default:c((()=>[(r(!0),k(C,null,S(s(t),(e=>(r(),u(o,{class:"w-[25%] px-[10rpx] mb-[10rpx]",key:e.id},{default:c((()=>[d(o,{class:"h-full cursor-pointer",onClick:t=>(e=>{const t=a.value.findIndex((t=>t===e));-1!==t?a.value.splice(t,1):a.value.push(e)})(e.id)},{default:c((()=>[d(o,{class:"pt-[100%] relative h-0 rounded-[10rpx] overflow-hidden"},{default:c((()=>[d(o,{class:"absolute inset-0 left-0 top-0"},{default:c((()=>[d(l,{src:e.image,class:"h-full w-full",width:"100%",height:"100%"},null,8,["src"])])),_:2},1024),B(a).includes(e.id)||B(a).includes(String(e.id))?(r(),u(o,{key:0,class:"absolute bg-[rgba(0,0,0,0.5)] inset-0 left-0 top-0 flex items-center justify-center text-white"},{default:c((()=>[d(n,{name:"checkmark-circle-fill",size:40})])),_:1})):h("v-if",!0)])),_:2},1024),d(o,{class:"text-center text-xs"},{default:c((()=>[p(f(e.name),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["indicator-dots","indicator-active-color"])])),_:1})])),_:1})}}}),ze=oe(V({__name:"uploader-picture",props:{modelValue:{default:""},type:{default:"image"}},emits:["update:modelValue"],setup(e,{emit:t}){const l=e,{modelValue:a}=ge(l,t),o=O(),s=N({}),{lockFn:i,isLock:n}=he((async e=>{var t;null==(t=o.value)||t.clearFiles();const[i]=e.tempFiles;if(!i)return uni.$u.toast("文件不存在");if(i.size>10485760)uni.$u.toast("文件大小不能超过10MB");else try{const e=await F(l.type,{filePath:i.url,name:"file"});a.value=e.uri,s.value=i}catch(n){uni.$u.toast(n)}}));return(e,t)=>{const l=U,m=x(b("u-icon"),Y),y=g,k=_,C=x(b("u-loading"),ye),S=x(b("uni-file-picker"),be),w=x(b("u-form-item"),_e);return r(),u(w,{prop:"image",label:"上传参考图",required:""},{default:c((()=>[d(y,{class:"flex-1 leading-snug"},{default:c((()=>[d(S,{ref_key:"filePickerRef",ref:o,limit:"1",fileMediatype:"image",onSelect:B(i),mode:"list","list-styles":{display:"none"},"auto-upload":!1},{default:c((()=>[d(y,{class:"bg-white rounded-[7rpx] h-[300rpx] border-light border border-dashed relative overflow-hidden"},{default:c((()=>[B(a)?(r(),u(y,{key:0,class:"flex justify-center items-center relative h-full"},{default:c((()=>[d(l,{class:"w-full h-[100%]",src:s.value.url||B(a),mode:"aspectFit"},null,8,["src"]),d(y,{class:"!absolute right-0 top-0 z-10 text-muted",onClick:t[0]||(t[0]=v((e=>a.value=""),["stop"]))},{default:c((()=>[d(m,{name:"close-circle-fill",size:50})])),_:1})])),_:1})):(r(),u(y,{key:1,class:"uploader-container flex justify-center items-center flex-col h-full"},{default:c((()=>[H("img",{src:ke,alt:"文件上传",class:"w-[80rpx] h-[80rpx] mx-auto mb-2"}),d(y,{class:"text-[#798696] !text-[13px]"},{default:c((()=>[d(k,{class:"text-primary"},{default:c((()=>[p("点击上传")])),_:1})])),_:1}),d(y,{class:"text-[#798696] !text-[13px] mt-[10rpx]"},{default:c((()=>[p(f("支持图片格式：JPG/JPEG/PNG，低于10MB"),1)])),_:1})])),_:1})),B(n)?(r(),u(y,{key:2,class:"absolute top-0 left-0 w-full h-full bg-[rgba(0,0,0,0.5)] flex flex-col items-center justify-center"},{default:c((()=>[d(y,null,{default:c((()=>[d(C,{size:"40",mode:"circle"})])),_:1}),d(k,{class:"text-white mt-[10rpx]"},{default:c((()=>[p(" 上传中... ")])),_:1})])),_:1})):h("v-if",!0)])),_:1})])),_:1},8,["onSelect"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-f9462d2b"]]),je=V({__name:"form-item-wrap",setup(e){const t=G();return(e,l)=>{const a=x(b("u-form-item"),_e);return r(),u(a,q(W(B(t))),{default:c((()=>[H("div",{class:"flex-1 min-w-0 overflow-hidden"},[I(e.$slots,"default")])])),_:3},16)}}}),Ne=[{label:"简单运镜",value:"simple"},{label:"下移拉远",value:"down_back"},{label:"推进上移",value:"forward_up"},{label:"右旋推进",value:"right_turn_forward"},{label:"左旋推进",value:"left_turn_forward"}],Be=[{label:"5秒",value:5},{label:"10秒",value:10}],Le=[{label:"高性能",value:"std"},{label:"高表现",value:"pro"}];var Pe=(e=>(e.OPEN_AI="openai_hk",e.GO_API="go_api",e.K_LING="k_ling",e))(Pe||{});const Me=Le[0].value,Re=Ne[0].value,Oe=Be[0].value,He=oe(V({__name:"video",setup(e){const t=P(),l=D(),a=O(),o=O(),s=O(),i=O(),n=A(),m=N([{mode:1,name:"文生视频"},{mode:2,name:"图生视频"}]),v=K({type:1,prompt:"",scale:"1:1",image:"",style_id:[],channel:"",model_name:"",negative_prompt:"",duration:Oe,camera_control:{type:Re},mode:Me}),w=N({model:{},style:[],example:{}}),$=j((()=>{var e;const t=(null==(e=w.value.model[v.channel])?void 0:e.models)||[v.channel];return v.model_name=t[0],t})),I=j((()=>w.value.model[v.channel]||{})),{lockFn:T,isLock:V}=he((async()=>{try{if(!v.prompt)return uni.$u.toast("请输入"+(1===v.type?"视频场景":"描述词"));if(2===v.type&&!v.image)return uni.$u.toast("请上传参考图");await fe({...v}),v.prompt="",v.style_id=[],v.image="",t.navigateTo("/packages/pages/video_list/video_list")}catch(e){}}));return(async()=>{w.value=await pe(),v.channel=w.value.channel})(),E((()=>{J("videoRegenerate",(e=>{Object.assign(v,e)}));const e=l.query;try{const t=JSON.parse(e.data);Object.assign(v,t)}catch(t){}})),(e,t)=>{const l=x(b("page-meta"),X),z=x(b("u-icon"),Y),j=g,N=x(b("router-navigate"),Q),L=x(b("u-navbar"),ee),P=x(b("uv-picker"),Se),M=x(b("uv-button"),we),R=x(b("uv-subsection"),$e),O=x(b("u-form"),re),H=Z,U=_,F=x(b("u-button"),ue),G=x(b("u-empty"),ce),q=x(b("tabbar"),de);return r(),k(C,null,[d(l,{"page-style":e.$theme.pageStyle},null,8,["page-style"]),d(j,{class:"h-full flex flex-col"},{default:c((()=>{var e;return[(null==(e=B(n).config.switch)?void 0:e.video_status)>0?(r(),k(C,{key:0},[d(L,{"back-text":"视频"},{right:c((()=>[d(N,{to:"/packages/pages/video_list/video_list"},{default:c((()=>[d(j,{class:"flex items-center mr-[20rpx]"},{default:c((()=>[d(j,{class:"text-primary flex"},{default:c((()=>[d(z,{name:"clock",size:32})])),_:1}),d(j,{class:"text-muted ml-[10rpx]"},{default:c((()=>[p("历史记录")])),_:1})])),_:1})])),_:1})])),_:1}),d(j,{class:"p-[20rpx]"},{default:c((()=>[d(j,{class:"flex p-[14rpx] bg-white rounded-full"},{default:c((()=>[(r(!0),k(C,null,S(m.value,(e=>(r(),u(j,{key:e.mode,class:y(["flex items-center px-[10rpx] py-[5rpx] flex-1 justify-center text-primary rounded-full",{"!bg-primary !text-white":Number(v.type)===e.mode}]),onClick:t=>v.type=e.mode},{default:c((()=>[d(j,{class:"leading-[30px]"},{default:c((()=>[p(f(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),d(j,{class:"flex-1 min-h-0"},{default:c((()=>[d(H,{class:"h-full","scroll-y":""},{default:c((()=>[d(j,{class:"px-[20rpx]"},{default:c((()=>[d(O,{ref_key:"uFormRef",ref:a,model:v,"label-position":"top","border-bottom":!1},{default:c((()=>[B(Pe).K_LING===v.channel?(r(),u(je,{key:0,label:"模型",required:""},{default:c((()=>[d(P,{ref_key:"modelRef",ref:o,columns:[B($)],onConfirm:t[0]||(t[0]=e=>v.model_name=e.value[0])},null,8,["columns"]),d(M,{onClick:t[1]||(t[1]=()=>B(o).open())},{default:c((()=>[p(f(v.model_name),1)])),_:1})])),_:1})):h("v-if",!0),B(Pe).K_LING===v.channel?(r(),u(je,{key:1,label:"模式",required:""},{default:c((()=>[d(R,{list:B(Le),"key-name":"label",mode:"button",current:B(Le).findIndex((e=>v.mode===e.value)),onChange:t[2]||(t[2]=e=>v.mode=B(Le)[e].value)},null,8,["list","current"])])),_:1})):h("v-if",!0),2===v.type?(r(),u(ze,{key:2,modelValue:v.image,"onUpdate:modelValue":t[3]||(t[3]=e=>v.image=e)},null,8,["modelValue"])):h("v-if",!0),d(Ie,{type:v.type,modelValue:v.prompt,"onUpdate:modelValue":t[4]||(t[4]=e=>v.prompt=e),config:w.value.example,showTranslate:!!w.value.translate_switch},null,8,["type","modelValue","config","showTranslate"]),B(Pe).K_LING===v.channel?(r(),u(Ie,{key:3,type:2,label:"负面描述",placeholder:"当需要表达负面情绪时，我们可以使用一些负面提示词用来描述低质量的绘画、畸形的形象等",modelValue:v.negative_prompt,"onUpdate:modelValue":t[5]||(t[5]=e=>v.negative_prompt=e),showTranslate:!!w.value.translate_switch},null,8,["type","modelValue","showTranslate"])):h("v-if",!0),d(Te,{modelValue:v.scale,"onUpdate:modelValue":t[6]||(t[6]=e=>v.scale=e),filters:B(Pe).K_LING===v.channel?["1:1","9:16","16:9"]:["1:1","3:4","4:3","9:16","16:9"]},null,8,["modelValue","filters"]),w.value.style.length?(r(),u(Ve,{key:4,"style-list":w.value.style,modelValue:v.style_id,"onUpdate:modelValue":t[7]||(t[7]=e=>v.style_id=e)},null,8,["style-list","modelValue"])):h("v-if",!0),B(Pe).K_LING===v.channel?(r(),u(je,{key:5,label:"镜头",required:""},{default:c((()=>[d(P,{ref_key:"cameraRef",ref:s,columns:[B(Ne)],"key-name":"label",onConfirm:t[8]||(t[8]=({value:[e]})=>v.camera_control.type=e.value)},null,8,["columns"]),d(M,{onClick:t[9]||(t[9]=()=>B(s).open())},{default:c((()=>{var e;return[p(f(null==(e=B(Ne).find((({value:e})=>e===v.camera_control.type)))?void 0:e.label),1)]})),_:1})])),_:1})):h("v-if",!0),B(Pe).K_LING===v.channel?(r(),u(je,{key:6,label:"时长",required:""},{default:c((()=>[d(P,{ref_key:"durationRef",ref:i,columns:[B(Be)],"key-name":"label",onConfirm:t[10]||(t[10]=({value:[e]})=>v.duration=e.value)},null,8,["columns"]),d(M,{onClick:t[11]||(t[11]=()=>B(i).open())},{default:c((()=>{var e;return[p(f(null==(e=B(Be).find((({value:e})=>e===v.duration)))?void 0:e.label),1)]})),_:1})])),_:1})):h("v-if",!0)])),_:1},8,["model"])])),_:1})])),_:1})])),_:1}),d(j,{class:"p-[20rpx] bg-white"},{default:c((()=>[d(F,{type:"primary",loading:B(V),onClick:B(T)},{default:c((()=>[d(j,null,{default:c((()=>[d(U,{class:"text-xl font-bold"},{default:c((()=>[p("立即生成")])),_:1}),w.value.is_member?(r(),u(U,{key:0,class:"text-sm ml-[4px]"},{default:c((()=>[p(" 会员免费 ")])),_:1})):B(I).price>0?(r(),u(U,{key:1,class:"text-sm ml-[4px]"},{default:c((()=>[p(" 消耗 "+f(B(I).price)+" "+f(B(n).getTokenUnit),1)])),_:1})):h("v-if",!0)])),_:1})])),_:1},8,["loading","onClick"])])),_:1})],64)):(r(),u(j,{key:1,class:"h-full flex-1 flex p-4 justify-center items-center"},{default:c((()=>[d(G,{text:"功能未开启",mode:"list"})])),_:1})),d(q)]})),_:1})],64)}}}),[["__scopeId","data-v-5fb96ca6"]]);export{He as default};
