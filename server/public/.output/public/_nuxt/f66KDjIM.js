import{_ as T}from"./eFgaMLiC.js";import{E as j}from"./Zz2DnF66.js";import{e as B,E as R,c_ as $,f as D}from"./CmRxzTqw.js";import"./l0sNRNKZ.js";/* empty css        */import{useImageEditor as F}from"./TR-GuQrR.js";import{E as N}from"./ArzC3z2d.js";import{l as U,b as u,M as L,N as O,a3 as l,a1 as r,u as e,y as b,n as A,O as s,$ as _}from"./CUZG7cWw.js";import{_ as J}from"./DlAUqK2U.js";import"./DCTLXrZ8.js";import"./BWdDF8rn.js";import"./CDwN27aR.js";import"./C3XldtMC.js";const q={class:"locality-draw-popup"},G={class:"flex justify-center"},H={class:"w-[940px] h-[500px]"},K={class:"dialog-footer flex items-center mt-6 mb-4 px-10 cursor-pointer"},P={class:"flex flex-1 items-center"},Q={class:"flex h-full items-end flex-1 rounded-sm overflow-hidden"},W={class:"flex items-center w-full min-h-full px-[6px] bg-page rounded-full"},X=U({__name:"image-editor",props:{drawFunc:{type:Function}},emits:["success"],setup(h,{expose:k,emit:C}){const E=h,{initCanvas:M,changeTool:f,currentTool:x,onMouseDown:v,onMouseMove:g,onMouseUp:d,captureCombinedSelections:V,undo:y,clearState:z}=F({async onData(n){try{console.log("result",n),await E.drawFunc({...w.value,image_mask:n,prompt:i.value},"inpaint"),I("success"),a.value=!1}finally{p.value=!1}}}),I=C,a=u(!1),i=u(""),p=u(!1),w=u(),S=()=>{if(i.value.trim()===""){D.msgError("请输入重绘描述");return}p.value=!0,V()};return k({open:async n=>{a.value=!0,w.value=n,await A(),M("locality-canvas",n.image)}}),(n,o)=>{const m=T,c=j;return L(),O("div",q,[l(e(N),{modelValue:e(a),"onUpdate:modelValue":o[8]||(o[8]=t=>b(a)?a.value=t:null),width:"980px",class:"!rounded-[12px]",center:!0,draggable:!0,"destroy-on-close":!0,"close-on-click-modal":!1,onClose:e(z)},{header:r(()=>o[9]||(o[9]=[s("div",{class:"w-full text-left"},[s("div",{class:"text-base font-medium"},"MJ 局部重绘 设置"),s("div",{class:"text-xs text-tx-secondary"},"局部重绘")],-1)])),default:r(()=>[s("div",G,[s("div",H,[s("canvas",{id:"locality-canvas",width:"940",height:"500",onMousedown:o[0]||(o[0]=(...t)=>e(v)&&e(v)(...t)),onMousemove:o[1]||(o[1]=(...t)=>e(g)&&e(g)(...t)),onMouseup:o[2]||(o[2]=(...t)=>e(d)&&e(d)(...t)),onMouseleave:o[3]||(o[3]=(...t)=>e(d)&&e(d)(...t))},null,32)])]),s("div",K,[l(c,{effect:"dark",content:"矩形工具",placement:"top"},{default:r(()=>[s("div",{class:_(["flex justify-center items-center w-[43px] h-[43px] bg-page rounded-full mr-2 hover:bg-primary hover:text-white",[e(x)==="rect"?"bg-primary text-white":""]]),onClick:o[4]||(o[4]=t=>e(f)("RECT"))},[l(m,{name:"local-icon-rect",size:"24"})],2)]),_:1}),l(c,{effect:"dark",content:"套索工具",placement:"top"},{default:r(()=>[s("div",{class:_(["flex justify-center items-center w-[43px] h-[43px] bg-page rounded-full mr-2 hover:bg-primary hover:text-white",[e(x)==="lasso"?"bg-primary text-white":""]]),onClick:o[5]||(o[5]=t=>e(f)("LASSO"))},[l(m,{name:"local-icon-lasso",size:"24"})],2)]),_:1}),l(c,{effect:"dark",content:"返回上一步",placement:"top"},{default:r(()=>[s("div",{class:"flex justify-center items-center w-[43px] h-[43px] bg-page rounded-full mr-2 hover:bg-primary hover:text-white",onClick:o[6]||(o[6]=(...t)=>e(y)&&e(y)(...t))},[l(m,{name:"local-icon-back",size:"24"})])]),_:1}),s("div",P,[s("div",Q,[s("div",W,[l(e(B),{modelValue:e(i),"onUpdate:modelValue":o[7]||(o[7]=t=>b(i)?i.value=t:null),"input-style":{"border-radius":"50px",backgroundColor:"var(--el-bg-color-page)"},class:"min-h-full py-[6px]",placeholder:"请输入重绘描述 [推荐英文]",type:"textarea",autosize:{maxRows:3},resize:"none"},null,8,["modelValue"]),l(e(R),{loading:e(p),type:"primary",icon:e($),circle:!0,onClick:S},null,8,["loading","icon"])])])])])]),_:1},8,["modelValue","onClose"])])}}}),me=J(X,[["__scopeId","data-v-2043d927"]]);export{me as default};
