import{l as Y,r as I,b as Z,ak as L,j as K,M as r,N as c,Z as i,a0 as _,O as a,aa as V,u as n,_ as j,aq as z,a7 as v,ab as Q,aG as W,a3 as ee,X as $,a5 as b,a9 as q,a4 as te,aH as oe}from"./D5LW44Rr.js";import{_ as se}from"./BkahHhpk.js";import{E as ae}from"./TbZ2p1CK.js";import{E as re}from"./DU1sy8XN.js";import{_ as ie}from"./BUR_EBmg.js";import{l as ne,j as le,cu as ce,cO as de,J as pe,E as _e,cg as ue,f as me}from"./C3C96yZa.js";import{E as fe}from"./CgvUZmt4.js";import{E as ge}from"./DXLUFY5i.js";/* empty css        */import"./l0sNRNKZ.js";/* empty css        *//* empty css        */import{u as D}from"./BZbHcrLm.js";import{b as xe}from"./WTCUdrt7.js";import{c as ve,v as ye}from"./CJgd20ip.js";import{a as he}from"./DjwCd26w.js";import{e as we}from"./BW5Tj-N9.js";import{_ as be}from"./DlAUqK2U.js";import"./Ibp_VyKw.js";import"./-zT6HmgG.js";import"./Cpg3PDWZ.js";import"./DCTLXrZ8.js";import"./v3hwjf8i.js";import"./BYIy1x1Y.js";import"./B3O-Pehw.js";const ke={class:"flex-1 min-h-0 mx-[16px] relative"},Ce=["onClick"],Ee={class:"flex-1 min-h-[70vh] overflow-hidden mx-auto"},Se=["infinite-scroll-disabled"],Be={key:0,class:"grid grid-cols-4 xl:grid-cols-4 2xl:grid-cols-5 4xl:grid-cols-6 8xl:grid-cols-7 gap-4"},Ie={class:"relative flex-1"},Le={class:"bg-[var(--el-bg-color-page)] rounded-t-[12px] overflow-hidden"},Ve={class:"w-full h-full p-[15px] box-border"},je={class:"line-clamp-2"},ze={class:"flex justify-between px-[15px] pb-[20px]"},$e={key:0,class:"flex items-center"},qe={class:"text-[#BBBBBB] ml-[6px] w-[100px] truncate"},De={class:"flex items-center"},Re=["onClick"],Te=["onClick"],Ne={key:1,class:"flex justify-center items-center mt-[50px]"},Oe={class:"flex flex-col justify-center items-center w-full h-[60vh]"},Pe=Y({__name:"video",props:{keyword:{}},async setup(R){let d,f;const T=R;ne();const g=le(),p=I({page_no:0,page_size:20,keyword:"",category_id:""}),o=I({more:!0,count:0,loading:!1,lists:[]}),k=Z(0),{data:C}=([d,f]=L(()=>D(()=>he({type:de.VIDEO}),{default(){return[]},transform(e){return[{id:"",name:"全部"}].concat(e)},lazy:!0},"$F7shVYj0fG")),d=await d,f(),d);[d,f]=L(()=>D(()=>y(),{lazy:!0},"$Cw5rrd3Tss")),await d,f();const y=async()=>{if(!o.loading){if(o.more)p.page_no+=1;else return;o.loading=!0;try{const e=await ve(p),{lists:s,page_no:l,page_size:u,count:m}=e;l*u>m&&(o.more=!1),l==1?o.lists=s:o.lists=[...o.lists,...s]}finally{setTimeout(()=>o.loading=!1,200)}}},x=()=>{p.page_no=0,o.more=!0,y()},N=async e=>{if(!g.isLogin){g.toggleShowLogin(!0);return}await ye({records_id:e.id,status:e.is_collect?0:1}),p.category_id===0?x():e.is_collect=e.is_collect?0:1},O=async(e,s)=>{if(!g.isLogin){g.toggleShowLogin(!0);return}try{const l=await $request.get({url:e,responseType:"blob",baseURL:""},{isReturnDefaultResponse:!0,apiPrefix:""});console.log(l);const u=new Blob([l._data],{type:l.headers.get("Content-Type")}),m=window.URL.createObjectURL(u);xe(m,s)}catch{me.msgError("文件下载失败")}},P=K(),A=e=>{P.value=e,console.log(e)},E=e=>{var s;k.value=e,p.category_id=(s=C.value[e])==null?void 0:s.id,x()};return E(0),ce(()=>T.keyword,e=>{p.keyword=e,x()},{debounce:500}),(e,s)=>{const l=oe,u=W,m=se,U=ae,S=re,F=ie,G=pe,M=fe,H=_e,J=ge;return r(),c("div",ke,[i(u,{slidesPerView:"auto",spaceBetween:16,class:"category-lists",style:{padding:"10px 0"},onSwiper:A},{default:_(()=>[(r(!0),c(j,null,z(n(C),(t,h)=>(r(),ee(l,{key:t.id,style:{width:"auto","margin-right":"12px"}},{default:_(()=>[Object.keys(t).includes("name")?(r(),c("div",{key:0,class:$(["category-item bg-white",{"is-active":n(k)===h}]),onClick:w=>E(h)},b(t.name),11,Ce)):v("",!0)]),_:2},1024))),128))]),_:1}),a("div",Ee,[V((r(),c("div",{class:"model-lists mb-[10px] mx-[0px]","infinite-scroll-distance":"50","infinite-scroll-delay":200,"infinite-scroll-disabled":!n(o).more},[n(o).lists.length?(r(),c("div",Be,[(r(!0),c(j,null,z(n(o).lists,(t,h)=>{var w,B;return r(),c("div",{key:t.id,class:"flex flex-col min-h-0 bg-body rounded-[12px] cursor-pointer"},[a("div",Ie,[a("div",Le,[i(m,{src:t.video_url,type:"video",ratio:[4,3]},null,8,["src"])])]),a("div",Ve,[a("div",je,b(t.prompt),1)]),a("div",ze,[(w=t==null?void 0:t.user_info)!=null&&w.image?(r(),c("div",$e,[i(U,{size:28,src:(B=t==null?void 0:t.user_info)==null?void 0:B.image},null,8,["src"]),a("p",qe,b(t.user_info.name),1)])):v("",!0),a("div",De,[i(S,{effect:"dark",content:"收藏 / 取消收藏",placement:"bottom"},{default:_(()=>[a("div",{class:"image-praise relative dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",onClick:q(X=>N(t),["stop"])},[a("div",{class:$(["praise-animate",t.is_collect?"praise-entry":"praise-leave"])},null,2)],8,Re)]),_:2},1024),i(S,{effect:"dark",content:"下载视频",placement:"bottom"},{default:_(()=>[a("div",{onClick:q(X=>O(t.video_url,"视频"),["stop"])},[i(F,{class:"cursor-pointer dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",name:"el-icon-Download",size:"24",color:"#556477"})],8,Te)]),_:2},1024)])])])}),128))])):v("",!0),n(o).loading?(r(),c("div",Ne,[i(G,{size:"25",class:"is-loading"},{default:_(()=>[i(n(ue))]),_:1}),s[0]||(s[0]=a("span",{class:"mt-[4px] ml-[10px] text-[#999999]"},"加载中...",-1))])):v("",!0),V(a("div",Oe,[i(M,{class:"w-[200px] h-[200px]",src:n(we)},null,8,["src"]),s[2]||(s[2]=a("div",{class:"text-tx-regular mb-4"},"当前选择暂无视频～",-1)),i(H,{type:"primary",onClick:x},{default:_(()=>s[1]||(s[1]=[te(" 点击刷新 ")])),_:1})],512),[[Q,!n(o).lists.length&&!n(o).loading]])],8,Se)),[[J,y]])])])}}}),_t=be(Pe,[["__scopeId","data-v-26cc000b"]]);export{_t as default};
