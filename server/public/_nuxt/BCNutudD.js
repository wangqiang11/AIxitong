import{l as D,b as I,j as z,bA as L,cZ as A,c_ as T,f as Z,E as w,e as $,o as M}from"./C3C96yZa.js";import{E as O}from"./DZCnEkJy.js";/* empty css        */import"./DP2rzg_V.js";import{u as R}from"./CfIJWwds.js";import{l as P,b as f,M as c,N as y,u as t,Z as s,a0 as o,y as g,a7 as v,_ as Q,O as l,a5 as p,a4 as i,a3 as G}from"./D5LW44Rr.js";import{_ as H}from"./DlAUqK2U.js";import"./B-LKCL5c.js";import"./DCTLXrZ8.js";const J={key:0,class:"redeem-code-query-pop"},K={key:0,class:"flex justify-between pt-4 text-base"},W={class:"flex pt-[40px]"},X={class:"flex-1"},Y={class:"flex justify-end w-[110px]"},ee={key:1,class:"redeem-code-check-pop"},te={class:"h-full"},oe={class:"flex-1 flex justify-center items-center bg-white pt-[20px]"},se=P({__name:"redeem-code-pop",emits:["close"],setup(le,{emit:E}){const x=E,U=D(),k=I(),B=z(),a=f(""),m=f(!0),d=f(!1),r=f({content:"",failure_time:"",id:"",sn:"",type:"",type_desc:"",valid_time:""}),{isLock:S,lockFn:h}=R(async()=>{try{const u=await A({sn:a.value});d.value=!0,r.value=u}catch(u){a.value="",console.log("查询卡密失败=>",u)}}),{isLock:F,lockFn:N}=R(async()=>{try{await T({sn:a.value}),Z.msgSuccess("兑换成功"),d.value=!1,m.value=!1,a.value="",await B.getUser(),await U.push({path:"/user/record",query:{time:new Date().getTime()}}),x("close")}catch(u){console.log("兑换卡密失败=>",u)}});return(u,e)=>{const j=w,q=$,b=w,C=O,_=M;return c(),y(Q,null,[t(m)?(c(),y("div",J,[s(C,{modelValue:t(m),"onUpdate:modelValue":e[2]||(e[2]=n=>g(m)?m.value=n:null),title:"卡密兑换",width:"600",onClose:e[3]||(e[3]=n=>x("close"))},{default:o(()=>{var n;return[(n=t(k).getRedeemCode)!=null&&n.is_show?(c(),y("div",K,[l("div",null,[e[5]||(e[5]=l("span",{class:"mr-2"},"购买链接:",-1)),l("span",null,p(t(k).getRedeemCode.buy_site),1)]),s(j,{type:"primary",link:!0,onClick:e[0]||(e[0]=V=>t(L)(t(k).getRedeemCode.buy_site))},{default:o(()=>e[6]||(e[6]=[i("复制")])),_:1})])):v("",!0),l("div",W,[l("div",X,[s(q,{modelValue:t(a),"onUpdate:modelValue":e[1]||(e[1]=V=>g(a)?a.value=V:null),placeholder:"请输入卡密编号",size:"large"},null,8,["modelValue"])]),l("div",Y,[s(b,{type:"primary",size:"large",loading:t(S),onClick:t(h)},{default:o(()=>e[7]||(e[7]=[i(" 查询 ")])),_:1},8,["loading","onClick"])])])]}),_:1},8,["modelValue"])])):v("",!0),t(d)?(c(),y("div",ee,[s(C,{modelValue:t(d),"onUpdate:modelValue":e[4]||(e[4]=n=>g(d)?d.value=n:null),width:"400"},{header:o(()=>e[8]||(e[8]=[l("div",{class:"text-lg text-center font-medium"},"查询结果",-1)])),default:o(()=>[l("div",te,[s(_,{label:"卡密类型："},{default:o(()=>[i(p(t(r).type_desc),1)]),_:1}),s(_,{label:"卡密面额："},{default:o(()=>[i(p(t(r).content),1)]),_:1}),s(_,{label:"兑换时间："},{default:o(()=>[i(p(t(r).failure_time),1)]),_:1}),t(r).valid_time?(c(),G(_,{key:0,label:"有效期至："},{default:o(()=>[i(p(t(r).valid_time),1)]),_:1})):v("",!0)]),l("div",oe,[s(b,{class:"w-full",type:"primary",size:"large",loading:t(F),onClick:t(N)},{default:o(()=>e[9]||(e[9]=[i(" 立即兑换 ")])),_:1},8,["loading","onClick"])])]),_:1},8,["modelValue"])])):v("",!0)],64)}}}),_e=H(se,[["__scopeId","data-v-c4e52e63"]]);export{_e as default};
