import{_ as J}from"./BUR_EBmg.js";import{E as G}from"./CgvUZmt4.js";import{E as K}from"./DU1sy8XN.js";import{E as Q}from"./TbZ2p1CK.js";import{E as W}from"./B8A6LEAg.js";import{u as Y,_ as ee}from"./DLAfhkv-.js";import{a as te,l as se,j as oe,v as ae,f as ie}from"./C3C96yZa.js";/* empty css        */import"./l0sNRNKZ.js";/* empty css        *//* empty css        *//* empty css        */import{l as le,b as re,ak as P,F as ne,M as n,N as c,O as e,Z as a,aa as ce,u as t,a3 as F,a7 as _,a5 as d,a0 as x,a9 as B,X as z,_ as de,aq as ue}from"./D5LW44Rr.js";import{u as U}from"./BZbHcrLm.js";import{b as pe}from"./WTCUdrt7.js";import{c as me}from"./Bu_nKEGp.js";import{g as _e,m as fe}from"./CJgd20ip.js";import{_ as xe}from"./DlAUqK2U.js";import"./v3hwjf8i.js";import"./BYIy1x1Y.js";import"./B3O-Pehw.js";import"./DCTLXrZ8.js";import"./DnGxh7JL.js";import"./C9K-Xzau.js";import"./CvgUe-Qn.js";const ve={class:"music-player-container h-full p-[16px]"},he={class:"music-player flex flex-col min-h-0 h-full bg-body rounded-xl"},ge={class:"flex flex-1 min-h-0 h-full"},ye={class:"flex flex-col flex-1 h-full min-h-0 p-[16px]"},be={class:"flex w-[30px] bg-body p-[5px] text-bold rounded-[50%] text-primary shadow-light"},ke={class:"flex flex-col flex-1 h-full min-h-0","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0)"},we={class:"flex items-center",style:{"margin-top":"30px"}},Ce={key:1,class:"text-tx-secondary"},Be={key:2,class:"absolute inset-0 flex items-center justify-center text-white"},ze={key:3,class:"absolute inset-0 flex items-center justify-center text-white"},Me={class:"ml-[15px] py-[8px]"},qe={class:"text-xl font-medium"},Ee={class:"mt-[20px] text-base text-tx-placeholder"},Le={class:"flex items-center",style:{"margin-top":"30px"}},Re={class:"flex items-center w-[150px]"},$e={class:"ml-1 text-tx-primary"},De={class:"mt-[20px]"},je={key:0,class:"flex items-center"},Ie={class:"text-[#BBBBBB] ml-[6px] w-[200px] truncate"},Se={class:"whitespace-pre"},Pe={class:"flex flex-col h-full min-h-0 w-[600px] p-[16px]"},Fe=["id","onClick"],Ue={class:"w-[100px] h-[100px] flex items-center justify-center flex-none relative"},Ae={key:1,class:"text-tx-secondary"},Ne={key:2,class:"absolute inset-0 flex items-center justify-center text-white"},Te={key:3,class:"absolute inset-0 flex items-center justify-center text-white"},Ze={class:"flex-1 ml-[20px]"},Ve={key:0,class:"mt-[12px] text-tx-secondary"},Oe={class:"flex justify-between mt-[12px]"},Xe={key:0,class:"flex items-center"},He={class:"text-[#BBBBBB] ml-[6px] w-[100px] truncate"},Je={class:"mt-[4px] text-tx-secondary"},Ge={class:"flex items-center"},Ke=["onClick"],Qe=["onClick"],We={class:"px-[16px] pb-[16px]"},Ye=le({__name:"player",async setup(et){let u,v;const b=te(),A=se(),h=oe(),k=re(0),{playing:g,currentId:p,setCurrentId:N,togglePlay:T,setMusic:w}=Y(),{data:i,pending:Z,refresh:M}=([u,v]=P(()=>U(()=>_e({id:k.value||b.query.id}),{default(){return{audio_url:"",create_time:"",duration:"",image_large_url:"",image_url:"",is_collect:0,id:-1,lyric:"",prompt:"",style_desc:"",tags:"",title:"",video_url:""}},transform:o=>o,lazy:!0,immediate:!1},"$xU1RrCMzZJ")),u=await u,v(),u),{data:m,refresh:q}=([u,v]=P(()=>U(()=>me(),{default(){return[]},lazy:!0,immediate:!1},"$MZz6IZCXHw")),u=await u,v(),u),V=async o=>{if(o.square_id===p.value)return;k.value=o.square_id,await M(),await q();const r=m.value.filter(l=>l.square_id===k.value);w(m.value),C(r[0]),console.log(i.value),A.replace({path:"",query:{id:i.value.id}})},C=o=>{if(o.square_id==p.value){T(),console.log("播放");return}N(o.id)},E=async o=>{if(!h.isLogin){h.toggleShowLogin(!0);return}await fe({records_id:(o==null?void 0:o.square_id)||b.query.id,status:o.is_collect?0:1}),o.is_collect=o.is_collect?0:1},O=async(o,r)=>{if(!h.isLogin){h.toggleShowLogin(!0);return}try{const l=await $request.get({url:o,responseType:"blob",baseURL:""},{isReturnDefaultResponse:!0,apiPrefix:""});console.log("下载音乐",l);const y=new Blob([l._data],{type:l.headers.get("Content-Type")}),f=window.URL.createObjectURL(y);pe(f,r)}catch{ie.msgError("文件下载失败")}};return ne(async()=>{await M(),await q(),m.value.filter(r=>r.square_id===b.query.id).length===0&&m.value.unshift(i.value),w(m.value),C(i.value)}),(o,r)=>{var $,D,j,I;const l=J,y=G,f=K,L=Q,R=W,X=ee,H=ae;return n(),c("div",ve,[e("div",he,[e("div",ge,[e("div",ye,[e("div",{class:"flex items-center cursor-pointer",onClick:r[0]||(r[0]=s=>o.$router.back())},[e("div",be,[a(l,{name:"el-icon-Back",size:18})]),r[3]||(r[3]=e("div",{class:"text-xl flex-1 min-w-0 ml-[10px]"}," 音乐广场 ",-1))]),ce((n(),c("div",ke,[e("div",we,[e("div",{class:"w-[200px] h-[200px] flex items-center justify-center flex-none relative",onClick:r[1]||(r[1]=s=>C(t(i)))},[($=t(i))!=null&&$.image_url?(n(),F(y,{key:0,src:(D=t(i))==null?void 0:D.image_url,class:"w-full h-full rounded-[15px]"},null,8,["src"])):(n(),c("div",Ce,[a(l,{name:"local-icon-music1",size:45})])),t(p)==t(i).id&&t(g)?(n(),c("div",Be,[a(l,{name:"local-icon-pause1",size:20})])):_("",!0),t(p)==t(i).id&&!t(g)?(n(),c("div",ze,[a(l,{name:"local-icon-play",size:20})])):_("",!0)]),e("div",Me,[e("div",qe,d(t(i).title),1),e("div",Ee,d(t(i).style_desc),1),e("div",Le,[e("div",Re,[a(l,{class:"cursor-pointer p-1",name:"el-icon-Timer",size:"30",color:"#556477"}),e("span",$e,d(t(i).duration),1)]),a(f,{effect:"dark",content:"收藏 / 取消收藏",placement:"bottom"},{default:x(()=>[e("div",{class:"image-praise relative dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",onClick:r[2]||(r[2]=B(s=>E(t(i)),["stop"]))},[e("div",{class:z(["praise-animate",t(i).is_collect?"praise-entry":"praise-leave"])},null,2)])]),_:1}),a(f,{effect:"dark",content:"下载音乐",placement:"bottom"},{default:x(()=>[e("div",null,[a(l,{class:"cursor-pointer dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",name:"el-icon-Download",size:"24",color:"#556477"})])]),_:1})]),e("div",De,[(j=t(i))!=null&&j.avatar?(n(),c("div",je,[a(L,{size:40,src:(I=t(i))==null?void 0:I.avatar},null,8,["src"]),e("p",Ie,d(t(i).nickname),1)])):_("",!0)])])]),a(R,{style:{"margin-top":"30px"}},{default:x(()=>[e("div",Se,d(t(i).lyric),1)]),_:1})])),[[H,t(Z)]])]),e("div",Pe,[r[4]||(r[4]=e("div",{class:"text-xl font-medium"},"热门推荐",-1)),a(R,{style:{"margin-top":"20px"}},{default:x(()=>[(n(!0),c(de,null,ue(t(m),s=>(n(),c("div",{class:"flex bg-page rounded-[15px] cursor-pointer hover:bg-[#EEF2FF] mb-[20px] p-[20px]",id:`music-item-${s.id}`,onClick:S=>V(s)},[e("div",Ue,[s.image_url?(n(),F(y,{key:0,src:s.image_url,class:"w-full h-full rounded-[15px]"},null,8,["src"])):(n(),c("div",Ae,[a(l,{name:"local-icon-music1",size:45})])),t(p)==s.id&&t(g)?(n(),c("div",Ne,[a(l,{name:"local-icon-pause1",size:20})])):_("",!0),t(p)==s.id&&!t(g)?(n(),c("div",Te,[a(l,{name:"local-icon-play",size:20})])):_("",!0)]),e("div",Ze,[e("div",{class:z(["text-[16px] font-bold",{"!text-primary":t(p)===s.id}])},d(s.title),3),s.tags?(n(),c("div",Ve,d(s.tags),1)):_("",!0),e("div",Oe,[s.nickname?(n(),c("div",Xe,[a(L,{size:28,src:s==null?void 0:s.avatar},null,8,["src"]),e("p",He,d(s.nickname),1)])):_("",!0),e("div",Je,d(s.duration),1),e("div",Ge,[a(f,{effect:"dark",content:"收藏 / 取消收藏",placement:"bottom"},{default:x(()=>[e("div",{class:"image-praise relative dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",onClick:B(S=>E(s),["stop"])},[e("div",{class:z(["praise-animate",s.is_collect?"praise-entry":"praise-leave"])},null,2)],8,Ke)]),_:2},1024),a(f,{effect:"dark",content:"下载音乐",placement:"bottom"},{default:x(()=>[e("div",{onClick:B(S=>O(s.audio_url,s.title),["stop"])},[a(l,{class:"cursor-pointer dark:hover:bg-[rgba(255,255,255,0.05)] hover:bg-[rgba(0,0,0,0.05)] rounded-md p-1 box-content",name:"el-icon-Download",size:"24",color:"#556477"})],8,Qe)]),_:2},1024)])])])],8,Fe))),256))]),_:1})])]),e("div",We,[a(X,{ref:"musicPlayerRef",class:"bg-page rounded-lg"},null,512)])])])}}}),zt=xe(Ye,[["__scopeId","data-v-2b59b763"]]);export{zt as default};
